{"ast":null,"code":"import { ref, onMounted } from \"vue\";\nimport axios from \"axios\";\nimport GudangSidebar from \"../components/GudangSidebar.vue\";\nconst API_BASE = \"http://localhost:8081/api/v1\";\nexport default {\n  __name: 'GoodsReceipt',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const token = localStorage.getItem(\"token\");\n    const saleReturns = ref([]);\n    const loading = ref(false);\n    const totalItems = ref(0);\n    const currentStatus = ref(\"APPROVED\");\n    const selectedReturn = ref(null);\n    const isModalOpen = ref(false);\n    const page = ref(1);\n    const size = ref(10);\n\n    // Helpers\n    const formatDate = d => {\n      if (!d) return \"-\";\n      const date = new Date(d);\n      return date.toLocaleDateString(\"id-ID\");\n    };\n    const getStatusClass = status => {\n      switch (status) {\n        case \"APPROVED\":\n          return \"bg-yellow-200 text-yellow-800 py-1 px-3 rounded-full text-xs font-medium\";\n        case \"RECEIVED\":\n          return \"bg-green-200 text-green-800 py-1 px-3 rounded-full text-xs font-medium\";\n        default:\n          return \"bg-gray-200 text-gray-800 py-1 px-3 rounded-full text-xs font-medium\";\n      }\n    };\n\n    // API: Ambil daftar retur\n    const loadSaleReturns = async () => {\n      loading.value = true;\n      saleReturns.value = [];\n      try {\n        const res = await axios.get(`${API_BASE}/gudang/sale-returns`, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          },\n          params: {\n            page: page.value,\n            size: size.value\n          }\n        });\n        saleReturns.value = res.data.data || [];\n        totalItems.value = res.data.total || 0;\n      } catch (err) {\n        console.error(\"Error load sale returns:\", err.response?.data || err.message);\n        alert(\"Gagal memuat daftar retur penjualan.\");\n      } finally {\n        loading.value = false;\n      }\n    };\n\n    // API: Ambil detail retur\n    const showDetail = async id => {\n      try {\n        const res = await axios.get(`${API_BASE}/gudang/sale-returns/${id}`, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        selectedReturn.value = res.data.data;\n        isModalOpen.value = true;\n      } catch (err) {\n        console.error(\"Error load detail:\", err.response?.data || err.message);\n        alert(\"Gagal memuat detail retur.\");\n      }\n    };\n    const closeModal = () => {\n      isModalOpen.value = false;\n      selectedReturn.value = null;\n    };\n\n    // API: Terima retur (update status RECEIVED)\n    const receiveReturn = async id => {\n      if (!confirm(`Terima retur penjualan #${id}?`)) return;\n      try {\n        await axios.post(`${API_BASE}/gudang/sale-returns/${id}/receive`, {}, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        alert(`Retur #${id} berhasil diterima.`);\n        loadSaleReturns();\n      } catch (err) {\n        console.error(\"Error menerima retur:\", err.response?.data || err.message);\n        alert(\"Gagal menerima retur.\");\n      }\n    };\n    onMounted(() => {\n      loadSaleReturns();\n    });\n    const __returned__ = {\n      API_BASE,\n      token,\n      saleReturns,\n      loading,\n      totalItems,\n      currentStatus,\n      selectedReturn,\n      isModalOpen,\n      page,\n      size,\n      formatDate,\n      getStatusClass,\n      loadSaleReturns,\n      showDetail,\n      closeModal,\n      receiveReturn,\n      ref,\n      onMounted,\n      get axios() {\n        return axios;\n      },\n      GudangSidebar\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","axios","GudangSidebar","API_BASE","token","localStorage","getItem","saleReturns","loading","totalItems","currentStatus","selectedReturn","isModalOpen","page","size","formatDate","d","date","Date","toLocaleDateString","getStatusClass","status","loadSaleReturns","value","res","get","headers","Authorization","params","data","total","err","console","error","response","message","alert","showDetail","id","closeModal","receiveReturn","confirm","post"],"sources":["C:/Users/SPC STYLE 5/Documents/app-penjualan/aplikasi/aplikasi/src/views/GoodsReceipt.vue"],"sourcesContent":["<template>\n  <div class=\"flex\">\n    <GudangSidebar />\n\n    <main class=\"flex-1 ml-64 p-6\">\n      <h1 class=\"text-2xl font-bold mb-6\">Penerimaan Retur dari Kasir</h1>\n\n      <div class=\"flex justify-between items-center mb-4\">\n        <div class=\"flex gap-2\">\n          <label class=\"text-sm font-medium pt-2\">Filter Status:</label>\n          <select\n            v-model=\"currentStatus\"\n            @change=\"loadSaleReturns\"\n            class=\"border rounded p-2 text-sm\"\n          >\n            <option value=\"APPROVED\">Siap Diterima (APPROVED)</option>\n            <option value=\"RECEIVED\">Sudah Diterima (RECEIVED)</option>\n            <option value=\"\">Semua</option>\n          </select>\n        </div>\n      </div>\n\n      <div class=\"bg-white shadow-md rounded-lg overflow-hidden\">\n        <table class=\"min-w-full leading-normal\">\n          <thead>\n            <tr\n              class=\"bg-gray-100 text-gray-600 uppercase text-sm leading-normal\"\n            >\n              <th class=\"py-3 px-6 text-left\">ID</th>\n              <th class=\"py-3 px-6 text-left\">Tanggal</th>\n              <th class=\"py-3 px-6 text-left\">Kasir</th>\n              <th class=\"py-3 px-6 text-center\">Status</th>\n              <th class=\"py-3 px-6 text-center\">Aksi</th>\n            </tr>\n          </thead>\n          <tbody class=\"text-gray-600 text-sm font-light\">\n            <tr\n              v-for=\"sr in saleReturns\"\n              :key=\"sr.ID\"\n              class=\"border-b border-gray-200 hover:bg-gray-50\"\n            >\n              <td class=\"py-3 px-6 text-left whitespace-nowrap\">{{ sr.ID }}</td>\n              <td class=\"py-3 px-6 text-left\">{{ formatDate(sr.Date) }}</td>\n              <td class=\"py-3 px-6 text-left\">{{ sr.User?.name || \"N/A\" }}</td>\n              <td class=\"py-3 px-6 text-center\">\n                <span :class=\"getStatusClass(sr.Status)\">\n                  {{ sr.Status }}\n                </span>\n              </td>\n              <td\n                class=\"py-3 px-6 text-center flex justify-center items-center\"\n              >\n                <button\n                  v-if=\"sr.Status === 'APPROVED'\"\n                  @click=\"receiveReturn(sr.ID)\"\n                  class=\"bg-green-500 hover:bg-green-600 text-white text-xs font-bold py-1 px-3 rounded disabled:opacity-50\"\n                >\n                  Terima Retur\n                </button>\n                <span\n                  v-else-if=\"sr.Status === 'RECEIVED'\"\n                  class=\"text-green-500 font-bold text-xs\"\n                >\n                  âœ… Diterima\n                </span>\n                <button\n                  @click=\"showDetail(sr.ID)\"\n                  class=\"ml-2 text-blue-500 hover:text-blue-700 text-xs\"\n                >\n                  Detail\n                </button>\n              </td>\n            </tr>\n            <tr v-if=\"!saleReturns.length && !loading\">\n              <td colspan=\"5\" class=\"py-4 text-center text-gray-500\">\n                Tidak ada retur penjualan yang ditemukan.\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n\n      <div class=\"flex justify-between items-center mt-4\">\n        <p class=\"text-sm text-gray-600\">Total: {{ totalItems }}</p>\n        <div v-if=\"loading\" class=\"text-blue-500\">Memuat...</div>\n      </div>\n    </main>\n\n    <!-- Modal Detail -->\n    <div\n      v-if=\"isModalOpen\"\n      class=\"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 flex justify-center items-center\"\n      @click=\"closeModal\"\n    >\n      <div\n        class=\"bg-white p-6 rounded-lg shadow-xl max-w-4xl w-full mx-4\"\n        @click.stop\n      >\n        <div class=\"flex justify-between items-center border-b pb-3 mb-4\">\n          <h3 class=\"text-xl font-bold\">\n            Detail Retur Penjualan #{{ selectedReturn?.ID }}\n          </h3>\n          <button\n            @click=\"closeModal\"\n            class=\"text-gray-500 hover:text-gray-800 text-2xl leading-none\"\n          >\n            &times;\n          </button>\n        </div>\n\n        <div v-if=\"selectedReturn\">\n          <h4 class=\"text-lg font-semibold mb-2\">Item Retur</h4>\n          <div class=\"overflow-x-auto border rounded\">\n            <table class=\"min-w-full text-sm\">\n              <thead>\n                <tr class=\"bg-gray-50\">\n                  <th class=\"py-2 px-4 text-left\">Produk</th>\n                  <th class=\"py-2 px-4 text-center\">Qty Retur</th>\n                  <th class=\"py-2 px-4 text-left\">Catatan</th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr\n                  v-for=\"item in selectedReturn.Items\"\n                  :key=\"item.ID\"\n                  class=\"border-t\"\n                >\n                  <td class=\"py-2 px-4\">\n                    {{ item.Product?.name || \"Produk Hilang\" }}\n                  </td>\n                  <td class=\"py-2 px-4 text-center\">{{ item.Qty }}</td>\n                  <td class=\"py-2 px-4\">{{ item.Note || \"-\" }}</td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n\n        <div class=\"mt-4 flex justify-end\">\n          <button\n            @click=\"closeModal\"\n            class=\"bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded\"\n          >\n            Tutup\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, onMounted } from \"vue\";\nimport axios from \"axios\";\nimport GudangSidebar from \"../components/GudangSidebar.vue\";\n\nconst API_BASE = \"http://localhost:8081/api/v1\";\nconst token = localStorage.getItem(\"token\");\n\nconst saleReturns = ref([]);\nconst loading = ref(false);\nconst totalItems = ref(0);\nconst currentStatus = ref(\"APPROVED\");\n\nconst selectedReturn = ref(null);\nconst isModalOpen = ref(false);\n\nconst page = ref(1);\nconst size = ref(10);\n\n// Helpers\nconst formatDate = (d) => {\n  if (!d) return \"-\";\n  const date = new Date(d);\n  return date.toLocaleDateString(\"id-ID\");\n};\n\nconst getStatusClass = (status) => {\n  switch (status) {\n    case \"APPROVED\":\n      return \"bg-yellow-200 text-yellow-800 py-1 px-3 rounded-full text-xs font-medium\";\n    case \"RECEIVED\":\n      return \"bg-green-200 text-green-800 py-1 px-3 rounded-full text-xs font-medium\";\n    default:\n      return \"bg-gray-200 text-gray-800 py-1 px-3 rounded-full text-xs font-medium\";\n  }\n};\n\n// API: Ambil daftar retur\nconst loadSaleReturns = async () => {\n  loading.value = true;\n  saleReturns.value = [];\n  try {\n    const res = await axios.get(`${API_BASE}/gudang/sale-returns`, {\n      headers: { Authorization: `Bearer ${token}` },\n      params: { page: page.value, size: size.value },\n    });\n    saleReturns.value = res.data.data || [];\n    totalItems.value = res.data.total || 0;\n  } catch (err) {\n    console.error(\n      \"Error load sale returns:\",\n      err.response?.data || err.message\n    );\n    alert(\"Gagal memuat daftar retur penjualan.\");\n  } finally {\n    loading.value = false;\n  }\n};\n\n// API: Ambil detail retur\nconst showDetail = async (id) => {\n  try {\n    const res = await axios.get(`${API_BASE}/gudang/sale-returns/${id}`, {\n      headers: { Authorization: `Bearer ${token}` },\n    });\n    selectedReturn.value = res.data.data;\n    isModalOpen.value = true;\n  } catch (err) {\n    console.error(\"Error load detail:\", err.response?.data || err.message);\n    alert(\"Gagal memuat detail retur.\");\n  }\n};\n\nconst closeModal = () => {\n  isModalOpen.value = false;\n  selectedReturn.value = null;\n};\n\n// API: Terima retur (update status RECEIVED)\nconst receiveReturn = async (id) => {\n  if (!confirm(`Terima retur penjualan #${id}?`)) return;\n  try {\n    await axios.post(\n      `${API_BASE}/gudang/sale-returns/${id}/receive`,\n      {},\n      {\n        headers: { Authorization: `Bearer ${token}` },\n      }\n    );\n    alert(`Retur #${id} berhasil diterima.`);\n    loadSaleReturns();\n  } catch (err) {\n    console.error(\"Error menerima retur:\", err.response?.data || err.message);\n    alert(\"Gagal menerima retur.\");\n  }\n};\n\nonMounted(() => {\n  loadSaleReturns();\n});\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}