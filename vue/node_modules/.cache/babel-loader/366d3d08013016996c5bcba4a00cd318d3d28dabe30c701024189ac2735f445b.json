{"ast":null,"code":"import { ref, onMounted } from \"vue\";\nimport axios from \"axios\";\nimport KepalaGudangSidebar from \"@/components/KepalaGudangSidebar.vue\";\n\n// State\n\nexport default {\n  __name: 'SalesReturnKepalaGudang',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const returns = ref([]);\n\n    // Ambil role dari localStorage\n    const role = localStorage.getItem(\"role\") || \"kepalagudang\"; // default kepalagudang\n\n    // Mapping role ke path backend\n    const endpointMap = {\n      kepalagudang: \"kepala-gudang\",\n      owner: \"owner\",\n      admin: \"admin\"\n    };\n\n    // Helper buat dapetin base URL sesuai role\n    const getBaseUrl = () => {\n      const path = endpointMap[role] || \"kepala-gudang\";\n      return `http://localhost:8081/api/v1/${path}`;\n    };\n\n    // Fetch data dari backend sesuai role\n    const fetchReturns = async () => {\n      try {\n        const token = localStorage.getItem(\"token\");\n        const url = `${getBaseUrl()}/sale-returns`;\n        const res = await axios.get(url, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        console.log(\"Respon backend:\", res.data);\n\n        // Parsing fleksibel\n        if (Array.isArray(res.data)) {\n          returns.value = res.data;\n        } else if (Array.isArray(res.data.data)) {\n          returns.value = res.data.data;\n        } else {\n          returns.value = [];\n        }\n        console.log(\"Returns loaded:\", returns.value);\n      } catch (err) {\n        console.error(\"Gagal ambil data:\", err.response?.data || err);\n      }\n    };\n\n    // Approve\n    const approve = async id => {\n      try {\n        const token = localStorage.getItem(\"token\");\n        const url = `${getBaseUrl()}/sale-returns/${id}/approve`;\n        await axios.post(url, {}, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        fetchReturns();\n      } catch (err) {\n        console.error(\"Gagal approve:\", err.response?.data || err);\n      }\n    };\n\n    // Reject\n    const reject = async id => {\n      try {\n        const token = localStorage.getItem(\"token\");\n        const url = `${getBaseUrl()}/sale-returns/${id}/reject`;\n        await axios.post(url, {}, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        fetchReturns();\n      } catch (err) {\n        console.error(\"Gagal reject:\", err.response?.data || err);\n      }\n    };\n    onMounted(() => {\n      fetchReturns();\n    });\n    const __returned__ = {\n      returns,\n      role,\n      endpointMap,\n      getBaseUrl,\n      fetchReturns,\n      approve,\n      reject,\n      ref,\n      onMounted,\n      get axios() {\n        return axios;\n      },\n      KepalaGudangSidebar\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","axios","KepalaGudangSidebar","returns","role","localStorage","getItem","endpointMap","kepalagudang","owner","admin","getBaseUrl","path","fetchReturns","token","url","res","get","headers","Authorization","console","log","data","Array","isArray","value","err","error","response","approve","id","post","reject"],"sources":["C:/Users/Personal/Documents/PKL/aplikasi/aplikasi/src/views/SalesReturnKepalaGudang.vue"],"sourcesContent":["<template>\n  <div\n    class=\"flex size-full min-h-screen flex-col bg-white font-manrope lg:flex-row\"\n  >\n    <!-- Sidebar tetap ada -->\n    <KepalaGudangSidebar />\n\n    <div class=\"flex flex-1 flex-col\">\n      <main class=\"flex-1 p-8\">\n        <div class=\"layout-content-container flex flex-col flex-1\">\n          <div class=\"mb-6\">\n            <p\n              class=\"text-[#111418] tracking-light text-[32px] font-bold leading-tight\"\n            >\n              Sales Return Requests\n            </p>\n            <p class=\"text-[#60758a] text-sm font-normal leading-normal\">\n              Review and approve or reject sales return requests from customers.\n            </p>\n          </div>\n\n          <!-- Tabel Data -->\n          <div class=\"px-4 py-3 @container\">\n            <div\n              class=\"flex overflow-hidden rounded-lg border border-[#dbe0e6] bg-white\"\n            >\n              <table class=\"flex-1\">\n                <thead>\n                  <tr class=\"bg-white\">\n                    <th\n                      class=\"px-4 py-3 text-left w-[200px] text-sm font-medium\"\n                    >\n                      Return Number\n                    </th>\n                    <th\n                      class=\"px-4 py-3 text-left w-[200px] text-sm font-medium\"\n                    >\n                      Customer\n                    </th>\n                    <th\n                      class=\"px-4 py-3 text-left w-[200px] text-sm font-medium\"\n                    >\n                      Product\n                    </th>\n                    <th\n                      class=\"px-4 py-3 text-left w-[200px] text-sm font-medium\"\n                    >\n                      Reason\n                    </th>\n                    <th\n                      class=\"px-4 py-3 text-left w-[120px] text-sm font-medium\"\n                    >\n                      Status\n                    </th>\n                    <th\n                      class=\"px-4 py-3 text-left w-[120px] text-sm font-medium\"\n                    >\n                      Actions\n                    </th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <tr\n                    v-for=\"item in returns\"\n                    :key=\"item.id\"\n                    class=\"border-t border-t-[#dbe0e6]\"\n                  >\n                    <td class=\"px-4 py-2 text-sm\">{{ item.return_number }}</td>\n                    <td class=\"px-4 py-2 text-sm\">{{ item.customer_name }}</td>\n                    <td class=\"px-4 py-2 text-sm\">{{ item.product_name }}</td>\n                    <td class=\"px-4 py-2 text-sm\">{{ item.reason }}</td>\n                    <td class=\"px-4 py-2 text-sm\">\n                      <span\n                        class=\"px-3 py-1 rounded-lg\"\n                        :class=\"{\n                          'bg-yellow-200 text-yellow-800':\n                            item.status === 'PENDING',\n                          'bg-green-200 text-green-800':\n                            item.status === 'APPROVED',\n                          'bg-red-200 text-red-800': item.status === 'REJECTED',\n                        }\"\n                      >\n                        {{ item.status }}\n                      </span>\n                    </td>\n                    <td class=\"px-4 py-2 text-sm font-bold\">\n                      <button\n                        class=\"mr-2 text-green-600 hover:underline\"\n                        @click=\"approve(item.id)\"\n                      >\n                        Approve\n                      </button>\n                      <button\n                        class=\"text-red-600 hover:underline\"\n                        @click=\"reject(item.id)\"\n                      >\n                        Reject\n                      </button>\n                    </td>\n                  </tr>\n                  <tr v-if=\"returns.length === 0\">\n                    <td\n                      colspan=\"6\"\n                      class=\"px-4 py-4 text-center text-sm text-gray-500\"\n                    >\n                      Tidak ada data\n                    </td>\n                  </tr>\n                </tbody>\n              </table>\n            </div>\n          </div>\n        </div>\n      </main>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, onMounted } from \"vue\";\nimport axios from \"axios\";\nimport KepalaGudangSidebar from \"@/components/KepalaGudangSidebar.vue\";\n\n// State\nconst returns = ref([]);\n\n// Ambil role dari localStorage\nconst role = localStorage.getItem(\"role\") || \"kepalagudang\"; // default kepalagudang\n\n// Mapping role ke path backend\nconst endpointMap = {\n  kepalagudang: \"kepala-gudang\",\n  owner: \"owner\",\n  admin: \"admin\",\n};\n\n// Helper buat dapetin base URL sesuai role\nconst getBaseUrl = () => {\n  const path = endpointMap[role] || \"kepala-gudang\";\n  return `http://localhost:8081/api/v1/${path}`;\n};\n\n// Fetch data dari backend sesuai role\nconst fetchReturns = async () => {\n  try {\n    const token = localStorage.getItem(\"token\");\n    const url = `${getBaseUrl()}/sale-returns`;\n\n    const res = await axios.get(url, {\n      headers: { Authorization: `Bearer ${token}` },\n    });\n\n    console.log(\"Respon backend:\", res.data);\n\n    // Parsing fleksibel\n    if (Array.isArray(res.data)) {\n      returns.value = res.data;\n    } else if (Array.isArray(res.data.data)) {\n      returns.value = res.data.data;\n    } else {\n      returns.value = [];\n    }\n\n    console.log(\"Returns loaded:\", returns.value);\n  } catch (err) {\n    console.error(\"Gagal ambil data:\", err.response?.data || err);\n  }\n};\n\n// Approve\nconst approve = async (id) => {\n  try {\n    const token = localStorage.getItem(\"token\");\n    const url = `${getBaseUrl()}/sale-returns/${id}/approve`;\n\n    await axios.post(\n      url,\n      {},\n      { headers: { Authorization: `Bearer ${token}` } }\n    );\n    fetchReturns();\n  } catch (err) {\n    console.error(\"Gagal approve:\", err.response?.data || err);\n  }\n};\n\n// Reject\nconst reject = async (id) => {\n  try {\n    const token = localStorage.getItem(\"token\");\n    const url = `${getBaseUrl()}/sale-returns/${id}/reject`;\n\n    await axios.post(\n      url,\n      {},\n      { headers: { Authorization: `Bearer ${token}` } }\n    );\n    fetchReturns();\n  } catch (err) {\n    console.error(\"Gagal reject:\", err.response?.data || err);\n  }\n};\n\nonMounted(() => {\n  fetchReturns();\n});\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}