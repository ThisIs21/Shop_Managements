{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport { ref, onMounted } from \"vue\";\nimport OwnerLayouts from \"../components/OwnerLayouts.vue\";\nimport { useRouter } from \"vue-router\";\n// Asumsi api.js mengarah ke instance axios yang dikonfigurasi\nimport api from \"/src/services/api.js\";\nexport default {\n  __name: 'AddProductOwner',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n\n    // Bagian script tidak diubah karena logikanya sudah benar, hanya menyesuaikan beberapa hal minor.\n    const router = useRouter();\n    const product = ref({\n      name: \"\",\n      cost_price: null,\n      sell_price: null,\n      stock: 0,\n      category_id: null,\n      unit_id: null,\n      supplier_id: null\n    });\n    const categories = ref([]);\n    const units = ref([]);\n    const suppliers = ref([]);\n    const fetchData = async () => {\n      try {\n        // Menggunakan Promise.all untuk efisiensi\n        const [catRes, unitRes, supRes] = await Promise.all([api.get(\"/owner/categories\"), api.get(\"/owner/units\"), api.get(\"/owner/suppliers\")]);\n        categories.value = catRes.data.data.map(c => ({\n          id: c.id,\n          name: c.name\n        }));\n        units.value = unitRes.data.data.map(u => ({\n          id: u.id,\n          name: u.name\n        }));\n        suppliers.value = supRes.data.data.map(s => ({\n          id: s.id,\n          name: s.name\n        }));\n      } catch (err) {\n        console.error(\"Failed to fetch dropdown data:\", err);\n        alert(\"Gagal memuat data kategori, satuan, atau supplier.\");\n      }\n    };\n    const createProduct = async () => {\n      try {\n        // Validasi sederhana\n        if (product.value.cost_price <= 0 || product.value.sell_price <= 0) {\n          alert(\"Harga modal dan harga jual harus lebih dari 0.\");\n          return;\n        }\n\n        // Mengubah nilai numerik menjadi Number jika masih berupa string (untuk keamanan)\n        const payload = {\n          ...product.value,\n          cost_price: Number(product.value.cost_price),\n          sell_price: Number(product.value.sell_price),\n          stock: Number(product.value.stock),\n          category_id: Number(product.value.category_id),\n          unit_id: Number(product.value.unit_id),\n          supplier_id: Number(product.value.supplier_id)\n        };\n        await api.post(\"/owner/products\", payload);\n        alert(\"Produk berhasil ditambahkan!\");\n        router.push(\"/management-product\");\n      } catch (err) {\n        console.error(\"Failed to add product:\", err.response?.data || err.message);\n        alert(`Gagal menambahkan produk: ${err.response?.data?.message || err.message}`);\n      }\n    };\n    onMounted(() => fetchData());\n    const __returned__ = {\n      router,\n      product,\n      categories,\n      units,\n      suppliers,\n      fetchData,\n      createProduct,\n      ref,\n      onMounted,\n      OwnerLayouts,\n      get useRouter() {\n        return useRouter;\n      },\n      get api() {\n        return api;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","OwnerLayouts","useRouter","api","router","product","name","cost_price","sell_price","stock","category_id","unit_id","supplier_id","categories","units","suppliers","fetchData","catRes","unitRes","supRes","Promise","all","get","value","data","map","c","id","u","s","err","console","error","alert","createProduct","payload","Number","post","push","response","message"],"sources":["C:/Users/Personal/Documents/PKL/aplikasi/aplikasi/src/views/AddProductOwner.vue"],"sourcesContent":["<template>\n  <OwnerLayouts>\n    <div class=\"flex flex-1 flex-col py-8 px-6 sm:px-8\">\n      <div class=\"layout-content-container flex flex-col max-w-3xl w-full mx-auto flex-1 bg-white p-8 rounded-xl shadow-lg border border-gray-200\">\n        \n        <div class=\"pb-6 border-b border-gray-200 mb-6\">\n          <p\n            class=\"text-[#111418] text-3xl font-bold leading-tight\"\n          >\n            Tambah Produk Baru\n          </p>\n          <p class=\"text-gray-500 text-sm mt-1\">Isi detail produk untuk menambahkan ke inventaris.</p>\n        </div>\n\n        <form @submit.prevent=\"createProduct\" class=\"flex flex-col flex-1\">\n          <div class=\"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6\">\n            \n            <div class=\"space-y-6\">\n              <div>\n                <label for=\"name\" class=\"block text-sm font-medium text-gray-700 mb-1\">Nama Produk</label>\n                <input\n                  id=\"name\"\n                  type=\"text\"\n                  v-model=\"product.name\"\n                  class=\"w-full border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 p-2.5 rounded-lg text-sm transition-shadow\"\n                  required\n                />\n              </div>\n\n              <div>\n                <label for=\"category\" class=\"block text-sm font-medium text-gray-700 mb-1\">Kategori</label>\n                <select\n                  id=\"category\"\n                  v-model.number=\"product.category_id\"\n                  class=\"w-full border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 p-2.5 rounded-lg text-sm bg-white\"\n                  required\n                >\n                  <option :value=\"null\" disabled>Pilih kategori</option>\n                  <option v-for=\"cat in categories\" :key=\"cat.id\" :value=\"cat.id\">\n                    {{ cat.name }}\n                  </option>\n                </select>\n              </div>\n\n              <div>\n                <label for=\"unit\" class=\"block text-sm font-medium text-gray-700 mb-1\">Satuan</label>\n                <select\n                  id=\"unit\"\n                  v-model.number=\"product.unit_id\"\n                  class=\"w-full border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 p-2.5 rounded-lg text-sm bg-white\"\n                  required\n                >\n                  <option :value=\"null\" disabled>Pilih satuan</option>\n                  <option v-for=\"unit in units\" :key=\"unit.id\" :value=\"unit.id\">\n                    {{ unit.name }}\n                  </option>\n                </select>\n              </div>\n\n              <div>\n                <label for=\"supplier\" class=\"block text-sm font-medium text-gray-700 mb-1\">Supplier</label>\n                <select\n                  id=\"supplier\"\n                  v-model.number=\"product.supplier_id\"\n                  class=\"w-full border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 p-2.5 rounded-lg text-sm bg-white\"\n                  required\n                >\n                  <option :value=\"null\" disabled>Pilih supplier</option>\n                  <option v-for=\"sup in suppliers\" :key=\"sup.id\" :value=\"sup.id\">\n                    {{ sup.name }}\n                  </option>\n                </select>\n              </div>\n            </div>\n\n            <div class=\"space-y-6\">\n              <div>\n                <label for=\"cost_price\" class=\"block text-sm font-medium text-gray-700 mb-1\">Harga Modal (Rp)</label>\n                <input\n                  id=\"cost_price\"\n                  type=\"number\"\n                  v-model.number=\"product.cost_price\"\n                  class=\"w-full border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 p-2.5 rounded-lg text-sm text-right font-mono\"\n                  required\n                />\n              </div>\n\n              <div>\n                <label for=\"sell_price\" class=\"block text-sm font-medium text-gray-700 mb-1\">Harga Jual (Rp)</label>\n                <input\n                  id=\"sell_price\"\n                  type=\"number\"\n                  v-model.number=\"product.sell_price\"\n                  class=\"w-full border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 p-2.5 rounded-lg text-sm text-right font-mono\"\n                  required\n                />\n              </div>\n\n              <div>\n                <label for=\"stock\" class=\"block text-sm font-medium text-gray-700 mb-1\">Stok Awal</label>\n                <input\n                  id=\"stock\"\n                  type=\"number\"\n                  v-model.number=\"product.stock\"\n                  class=\"w-full border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 p-2.5 rounded-lg text-sm text-right\"\n                  placeholder=\"0\"\n                />\n              </div>\n            </div>\n            \n          </div>\n\n          <div class=\"flex justify-end pt-6 mt-8 border-t border-gray-200 gap-3\">\n            <router-link to=\"/management-product\">\n              <button type=\"button\" class=\"bg-gray-200 hover:bg-gray-300 text-gray-700 px-5 py-2.5 rounded-lg text-sm font-medium transition-colors\">\n                Batal\n              </button>\n            </router-link>\n            <button\n              type=\"submit\"\n              class=\"bg-blue-600 hover:bg-blue-700 text-white px-5 py-2.5 rounded-lg text-sm font-medium transition-colors shadow-md\"\n            >\n              Simpan Produk\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  </OwnerLayouts>\n</template>\n\n<script setup>\n// Bagian script tidak diubah karena logikanya sudah benar, hanya menyesuaikan beberapa hal minor.\nimport { ref, onMounted } from \"vue\";\nimport OwnerLayouts from \"../components/OwnerLayouts.vue\";\nimport { useRouter } from \"vue-router\";\n// Asumsi api.js mengarah ke instance axios yang dikonfigurasi\nimport api from \"/src/services/api.js\"; \n\nconst router = useRouter();\n\nconst product = ref({\n  name: \"\",\n  cost_price: null,\n  sell_price: null,\n  stock: 0,\n  category_id: null,\n  unit_id: null,\n  supplier_id: null,\n});\n\nconst categories = ref([]);\nconst units = ref([]);\nconst suppliers = ref([]);\n\nconst fetchData = async () => {\n  try {\n    // Menggunakan Promise.all untuk efisiensi\n    const [catRes, unitRes, supRes] = await Promise.all([\n      api.get(\"/owner/categories\"),\n      api.get(\"/owner/units\"),\n      api.get(\"/owner/suppliers\"),\n    ]);\n\n    categories.value = catRes.data.data.map((c) => ({\n      id: c.id,\n      name: c.name,\n    }));\n    units.value = unitRes.data.data.map((u) => ({\n      id: u.id,\n      name: u.name,\n    }));\n    suppliers.value = supRes.data.data.map((s) => ({\n      id: s.id,\n      name: s.name,\n    }));\n  } catch (err) {\n    console.error(\"Failed to fetch dropdown data:\", err);\n    alert(\"Gagal memuat data kategori, satuan, atau supplier.\");\n  }\n};\n\nconst createProduct = async () => {\n  try {\n    // Validasi sederhana\n    if (product.value.cost_price <= 0 || product.value.sell_price <= 0) {\n        alert(\"Harga modal dan harga jual harus lebih dari 0.\");\n        return;\n    }\n\n    // Mengubah nilai numerik menjadi Number jika masih berupa string (untuk keamanan)\n    const payload = {\n        ...product.value,\n        cost_price: Number(product.value.cost_price),\n        sell_price: Number(product.value.sell_price),\n        stock: Number(product.value.stock),\n        category_id: Number(product.value.category_id),\n        unit_id: Number(product.value.unit_id),\n        supplier_id: Number(product.value.supplier_id),\n    };\n\n    await api.post(\"/owner/products\", payload);\n    alert(\"Produk berhasil ditambahkan!\");\n    router.push(\"/management-product\");\n  } catch (err) {\n    console.error(\"Failed to add product:\", err.response?.data || err.message);\n    alert(`Gagal menambahkan produk: ${err.response?.data?.message || err.message}`);\n  }\n};\n\nonMounted(() => fetchData());\n</script>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}