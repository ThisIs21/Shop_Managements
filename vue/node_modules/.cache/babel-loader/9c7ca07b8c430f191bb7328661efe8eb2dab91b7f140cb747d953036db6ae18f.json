{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = {\n  class: \"login-container\"\n};\nconst _hoisted_2 = {\n  class: \"form-group\"\n};\nconst _hoisted_3 = [\"disabled\"];\nconst _hoisted_4 = {\n  key: 0,\n  class: \"error-message\"\n};\nconst _hoisted_5 = {\n  class: \"form-group\"\n};\nconst _hoisted_6 = [\"disabled\"];\nconst _hoisted_7 = {\n  key: 0,\n  class: \"error-message\"\n};\nconst _hoisted_8 = {\n  key: 0,\n  class: \"error-message general-error\"\n};\nconst _hoisted_9 = [\"disabled\"];\nconst _hoisted_10 = {\n  key: 0\n};\nconst _hoisted_11 = {\n  key: 1\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"form\", {\n    onSubmit: _withModifiers($setup.handleLogin, [\"prevent\"]),\n    class: \"login-form\"\n  }, [_cache[4] || (_cache[4] = _createElementVNode(\"h2\", null, \"Sistem Penjualan - Login\", -1 /* CACHED */)), _createElementVNode(\"div\", _hoisted_2, [_cache[2] || (_cache[2] = _createElementVNode(\"label\", {\n    for: \"email\"\n  }, \"Email\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"email\",\n    id: \"email\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.email = $event),\n    required: \"\",\n    disabled: $setup.isLoading\n  }, null, 8 /* PROPS */, _hoisted_3), [[_vModelText, $setup.email]]), $setup.errors.email ? (_openBlock(), _createElementBlock(\"p\", _hoisted_4, _toDisplayString($setup.errors.email), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", _hoisted_5, [_cache[3] || (_cache[3] = _createElementVNode(\"label\", {\n    for: \"password\"\n  }, \"Password\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"password\",\n    id: \"password\",\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.password = $event),\n    required: \"\",\n    minlength: \"6\",\n    disabled: $setup.isLoading\n  }, null, 8 /* PROPS */, _hoisted_6), [[_vModelText, $setup.password]]), $setup.errors.password ? (_openBlock(), _createElementBlock(\"p\", _hoisted_7, _toDisplayString($setup.errors.password), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), $setup.generalError ? (_openBlock(), _createElementBlock(\"p\", _hoisted_8, _toDisplayString($setup.generalError), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"button\", {\n    type: \"submit\",\n    disabled: $setup.isLoading\n  }, [$setup.isLoading ? (_openBlock(), _createElementBlock(\"span\", _hoisted_10, \"Loading...\")) : (_openBlock(), _createElementBlock(\"span\", _hoisted_11, \"Login\"))], 8 /* PROPS */, _hoisted_9)], 32 /* NEED_HYDRATION */)]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","onSubmit","_withModifiers","$setup","handleLogin","_hoisted_2","for","type","id","email","$event","required","disabled","isLoading","errors","_hoisted_4","_toDisplayString","_hoisted_5","password","minlength","_hoisted_7","generalError","_hoisted_8","_hoisted_10","_hoisted_11"],"sources":["C:\\Users\\Personal\\Documents\\PKL\\aplikasi\\aplikasi\\src\\views\\Login.vue"],"sourcesContent":["<template>\r\n  <div class=\"login-container\">\r\n    <form @submit.prevent=\"handleLogin\" class=\"login-form\">\r\n      <h2>Sistem Penjualan - Login</h2>\r\n\r\n      <div class=\"form-group\">\r\n        <label for=\"email\">Email</label>\r\n        <input\r\n          type=\"email\"\r\n          id=\"email\"\r\n          v-model=\"email\"\r\n          required\r\n          :disabled=\"isLoading\"\r\n        />\r\n        <p v-if=\"errors.email\" class=\"error-message\">{{ errors.email }}</p>\r\n      </div>\r\n\r\n      <div class=\"form-group\">\r\n        <label for=\"password\">Password</label>\r\n        <input\r\n          type=\"password\"\r\n          id=\"password\"\r\n          v-model=\"password\"\r\n          required\r\n          minlength=\"6\"\r\n          :disabled=\"isLoading\"\r\n        />\r\n        <p v-if=\"errors.password\" class=\"error-message\">\r\n          {{ errors.password }}\r\n        </p>\r\n      </div>\r\n\r\n      <p v-if=\"generalError\" class=\"error-message general-error\">\r\n        {{ generalError }}\r\n      </p>\r\n\r\n      <button type=\"submit\" :disabled=\"isLoading\">\r\n        <span v-if=\"isLoading\">Loading...</span>\r\n        <span v-else>Login</span>\r\n      </button>\r\n    </form>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from \"vue\";\r\nimport router from \"@/router\"; // Asumsikan Anda menggunakan Vue Router\r\nimport apiClient from \"../services/api.js\"; // Import instance Axios yang sudah dibuat\r\n\r\n// State untuk formulir\r\nconst email = ref(\"\");\r\nconst password = ref(\"\");\r\n\r\n// State untuk UI dan Error Handling\r\nconst isLoading = ref(false);\r\nconst generalError = ref(\"\");\r\nconst errors = ref({\r\n  email: \"\",\r\n  password: \"\",\r\n});\r\n\r\n/**\r\n * Validasi sisi klien sederhana\r\n */\r\nconst validateForm = () => {\r\n  let isValid = true;\r\n  errors.value = { email: \"\", password: \"\" };\r\n\r\n  if (!email.value) {\r\n    errors.value.email = \"Email wajib diisi.\";\r\n    isValid = false;\r\n  }\r\n  // Tidak perlu validasi email yang kompleks di sini, biarkan backend yang mengurus\r\n\r\n  if (!password.value) {\r\n    errors.value.password = \"Password wajib diisi.\";\r\n    isValid = false;\r\n  } else if (password.value.length < 6) {\r\n    errors.value.password = \"Password minimal 6 karakter.\";\r\n    isValid = false;\r\n  }\r\n\r\n  return isValid;\r\n};\r\n\r\n/**\r\n * Menangani proses login\r\n */\r\nconst handleLogin = async () => {\r\n  generalError.value = \"\"; // Reset error\r\n\r\n  if (!validateForm()) {\r\n    return;\r\n  }\r\n\r\n  isLoading.value = true;\r\n\r\n  try {\r\n    const response = await apiClient.post(\"/auth/login\", {\r\n      email: email.value,\r\n      password: password.value,\r\n    });\r\n\r\n    // Asumsi: Backend mengembalikan { token: \"...\", name: \"...\", role: \"...\" }\r\n    const { token, name, role } = response.data;\r\n\r\n    // 1. Simpan token di Local Storage atau Vuex/Pinia (disarankan untuk manajemen state)\r\n    localStorage.setItem(\"userToken\", token);\r\n\r\n    // 2. Simpan detail user lainnya\r\n    localStorage.setItem(\"userName\", name);\r\n    localStorage.setItem(\"userRole\", role);\r\n\r\n    // 3. Konfigurasi Axios untuk menyertakan token di setiap request berikutnya\r\n    apiClient.defaults.headers.common[\"Authorization\"] = `Bearer ${token}`;\r\n\r\n    // 4. Redirect pengguna ke halaman dashboard berdasarkan role\r\n    if (role === \"OWNER\") {\r\n      router.push(\"/owner/dashboard\");\r\n    } else if (role === \"KASIR\") {\r\n      router.push(\"/kasir/dashboard\");\r\n    } else {\r\n      // Role lain atau default\r\n      router.push(\"/dashboard\");\r\n    }\r\n  } catch (error) {\r\n    // Tangani error dari API\r\n    if (error.response) {\r\n      // Error 400 (Bad Request) atau 401 (Unauthorized) dari backend Go Anda\r\n      // Pesan error dari backend akan ada di error.response.data.message atau serupa\r\n      const message =\r\n        error.response.data.message ||\r\n        \"Email atau password salah. Silakan coba lagi.\";\r\n      generalError.value = message;\r\n    } else if (error.request) {\r\n      // Permintaan dikirim tetapi tidak ada respons (mis. server down)\r\n      generalError.value =\r\n        \"Tidak dapat terhubung ke server. Silakan cek koneksi Anda.\";\r\n    } else {\r\n      // Kesalahan lain\r\n      generalError.value = \"Terjadi kesalahan tak terduga saat login.\";\r\n      console.error(error);\r\n    }\r\n  } finally {\r\n    isLoading.value = false;\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.login-container {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  min-height: 100vh;\r\n  background-color: #f4f7f6;\r\n}\r\n\r\n.login-form {\r\n  background: white;\r\n  padding: 40px;\r\n  border-radius: 8px;\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\r\n  width: 100%;\r\n  max-width: 400px;\r\n}\r\n\r\nh2 {\r\n  text-align: center;\r\n  margin-bottom: 30px;\r\n  color: #333;\r\n}\r\n\r\n.form-group {\r\n  margin-bottom: 20px;\r\n}\r\n\r\nlabel {\r\n  display: block;\r\n  margin-bottom: 5px;\r\n  font-weight: bold;\r\n  color: #555;\r\n}\r\n\r\ninput {\r\n  width: 100%;\r\n  padding: 10px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 4px;\r\n  box-sizing: border-box;\r\n}\r\n\r\ninput:focus {\r\n  border-color: #007bff;\r\n  outline: none;\r\n  box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);\r\n}\r\n\r\nbutton {\r\n  width: 100%;\r\n  padding: 12px;\r\n  background-color: #007bff;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  font-size: 16px;\r\n  transition: background-color 0.3s;\r\n}\r\n\r\nbutton:hover:not(:disabled) {\r\n  background-color: #0056b3;\r\n}\r\n\r\nbutton:disabled {\r\n  background-color: #a0c3e1;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.error-message {\r\n  color: #dc3545;\r\n  font-size: 0.875em;\r\n  margin-top: 5px;\r\n}\r\n\r\n.general-error {\r\n  text-align: center;\r\n  font-weight: bold;\r\n  margin-bottom: 15px;\r\n  padding: 10px;\r\n  border: 1px solid #f5c6cb;\r\n  background-color: #f8d7da;\r\n  border-radius: 4px;\r\n}\r\n</style>\r\n"],"mappings":";;EACOA,KAAK,EAAC;AAAiB;;EAInBA,KAAK,EAAC;AAAY;;;;EASEA,KAAK,EAAC;;;EAG1BA,KAAK,EAAC;AAAY;;;;EAUKA,KAAK,EAAC;;;;EAKXA,KAAK,EAAC;;;;;;;;;;uBA/BjCC,mBAAA,CAwCM,OAxCNC,UAwCM,GAvCJC,mBAAA,CAsCO;IAtCAC,QAAM,EAAAC,cAAA,CAAUC,MAAA,CAAAC,WAAW;IAAEP,KAAK,EAAC;gCACxCG,mBAAA,CAAiC,YAA7B,0BAAwB,qBAE5BA,mBAAA,CAUM,OAVNK,UAUM,G,0BATJL,mBAAA,CAAgC;IAAzBM,GAAG,EAAC;EAAO,GAAC,OAAK,qB,gBACxBN,mBAAA,CAME;IALAO,IAAI,EAAC,OAAO;IACZC,EAAE,EAAC,OAAO;+DACDL,MAAA,CAAAM,KAAK,GAAAC,MAAA;IACdC,QAAQ,EAAR,EAAQ;IACPC,QAAQ,EAAET,MAAA,CAAAU;sDAFFV,MAAA,CAAAM,KAAK,E,GAIPN,MAAA,CAAAW,MAAM,CAACL,KAAK,I,cAArBX,mBAAA,CAAmE,KAAnEiB,UAAmE,EAAAC,gBAAA,CAAnBb,MAAA,CAAAW,MAAM,CAACL,KAAK,oB,qCAG9DT,mBAAA,CAaM,OAbNiB,UAaM,G,0BAZJjB,mBAAA,CAAsC;IAA/BM,GAAG,EAAC;EAAU,GAAC,UAAQ,qB,gBAC9BN,mBAAA,CAOE;IANAO,IAAI,EAAC,UAAU;IACfC,EAAE,EAAC,UAAU;+DACJL,MAAA,CAAAe,QAAQ,GAAAR,MAAA;IACjBC,QAAQ,EAAR,EAAQ;IACRQ,SAAS,EAAC,GAAG;IACZP,QAAQ,EAAET,MAAA,CAAAU;sDAHFV,MAAA,CAAAe,QAAQ,E,GAKVf,MAAA,CAAAW,MAAM,CAACI,QAAQ,I,cAAxBpB,mBAAA,CAEI,KAFJsB,UAEI,EAAAJ,gBAAA,CADCb,MAAA,CAAAW,MAAM,CAACI,QAAQ,oB,qCAIbf,MAAA,CAAAkB,YAAY,I,cAArBvB,mBAAA,CAEI,KAFJwB,UAEI,EAAAN,gBAAA,CADCb,MAAA,CAAAkB,YAAY,oB,mCAGjBrB,mBAAA,CAGS;IAHDO,IAAI,EAAC,QAAQ;IAAEK,QAAQ,EAAET,MAAA,CAAAU;MACnBV,MAAA,CAAAU,SAAS,I,cAArBf,mBAAA,CAAwC,QAAAyB,WAAA,EAAjB,YAAU,M,cACjCzB,mBAAA,CAAyB,QAAA0B,WAAA,EAAZ,OAAK,G","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}