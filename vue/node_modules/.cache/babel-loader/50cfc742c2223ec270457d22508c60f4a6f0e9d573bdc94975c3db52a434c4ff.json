{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/es.iterator.reduce.js\";\nimport \"core-js/modules/es.iterator.some.js\";\nimport { ref, onMounted, computed, nextTick } from 'vue';\nimport { useRouter } from 'vue-router'; // Jika perlu navigasi\nimport axios from 'axios';\nimport CashierLayouts from '@/components/CashierLayouts.vue';\nexport default {\n  __name: 'PurchaseReturn',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const router = useRouter();\n\n    /* -------------------------\n       API Configuration\n       ------------------------- */\n    const API_BASE = import.meta.env.VITE_API_BASE_URL || 'http://localhost:8081/api/v1';\n    const ENDPOINTS = {\n      PURCHASES: '/history/purchases',\n      PURCHASE_DETAIL: '/pembelian/purchases',\n      // Base untuk /:id\n      PURCHASE_RETURNS: '/history/purchase-returns',\n      CREATE_RETURN: '/pembelian/purchase-returns'\n    };\n    const api = axios.create({\n      baseURL: API_BASE\n    });\n    const token = localStorage.getItem('token');\n    if (token) {\n      api.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n    }\n\n    // Interceptor untuk error global\n    api.interceptors.response.use(response => response, error => {\n      if (error.response?.status === 401) {\n        localStorage.removeItem('token');\n        router.push('/login');\n      }\n      return Promise.reject(error);\n    });\n\n    /* -------------------------\n       State Management\n       ------------------------- */\n    const purchases = ref([]);\n    const loadingPurchases = ref(false);\n    const fromDate = ref('');\n    const toDate = ref('');\n    const currentPagePurchases = ref(1);\n    const totalPurchases = ref(0);\n    const purchaseReturns = ref([]);\n    const loadingReturns = ref(false);\n    const returnFromDate = ref('');\n    const returnToDate = ref('');\n    const returnStatusFilter = ref('');\n    const currentPageReturns = ref(1);\n    const totalReturns = ref(0);\n    const totalPagesReturns = computed(() => Math.ceil(totalReturns.value / 10));\n\n    /* Modal State */\n    const showModal = ref(false);\n    const selectedPurchase = ref(null);\n    const returnForm = ref({\n      items: []\n    });\n    const returnNotes = ref('');\n    const submitting = ref(false);\n\n    /* Toast State (Rekomendasi baru: Feedback user) */\n    const toast = ref({\n      message: '',\n      type: 'success'\n    });\n    const showToast = (message, type = 'success') => {\n      toast.value = {\n        message,\n        type\n      };\n      setTimeout(() => {\n        toast.value.message = '';\n      }, 3000);\n    };\n\n    /* -------------------------\n       Computed Properties\n       ------------------------- */\n    const isFormValid = computed(() => {\n      return returnForm.value.items.some(item => item.qty > 0 && item.reason?.trim().length >= 10);\n    });\n    const totalReturnAmount = computed(() => {\n      return returnForm.value.items.reduce((sum, item) => sum + (item.subtotal || 0), 0);\n    });\n\n    /* -------------------------\n       Utility Functions\n       ------------------------- */\n    const formatDate = dateStr => {\n      if (!dateStr) return 'N/A';\n      const date = new Date(dateStr);\n      return date.toLocaleDateString('id-ID', {\n        day: '2-digit',\n        month: 'short',\n        year: 'numeric'\n      });\n    };\n    const formatDateFull = dateStr => dateStr ? new Date(dateStr).toLocaleDateString('id-ID') : 'N/A';\n    const formatCurrency = amount => {\n      return new Intl.NumberFormat('id-ID', {\n        style: 'currency',\n        currency: 'IDR',\n        minimumFractionDigits: 0\n      }).format(amount || 0);\n    };\n    const formatPONumber = id => `PO-${String(id || '').padStart(3, '0')}`;\n    const formatReturnNumber = id => `RTN-${new Date().getFullYear()}-${String(id || '').padStart(3, '0')}`;\n    const getPOStatusClass = status => {\n      switch (status?.toUpperCase()) {\n        case 'APPROVED':\n          return 'bg-green-100 text-green-800';\n        case 'SUBMITTED':\n          return 'bg-yellow-100 text-yellow-800';\n        case 'REJECTED':\n          return 'bg-red-100 text-red-800';\n        default:\n          return 'bg-gray-100 text-gray-800';\n      }\n    };\n    const getPOStatusText = status => {\n      switch (status?.toUpperCase()) {\n        case 'APPROVED':\n          return 'Disetujui';\n        case 'SUBMITTED':\n          return 'Diajukan';\n        case 'REJECTED':\n          return 'Ditolak';\n        default:\n          return status || 'Draft';\n      }\n    };\n    const getStatusClass = status => {\n      switch (status?.toUpperCase()) {\n        case 'PENDING':\n          return 'bg-yellow-100 text-yellow-800';\n        case 'APPROVED':\n          return 'bg-green-100 text-green-800';\n        case 'REJECTED':\n          return 'bg-red-100 text-red-800';\n        default:\n          return 'bg-gray-100 text-gray-800';\n      }\n    };\n    const getStatusText = status => {\n      switch (status?.toUpperCase()) {\n        case 'PENDING':\n          return 'Menunggu';\n        case 'APPROVED':\n          return 'Disetujui';\n        case 'REJECTED':\n          return 'Ditolak';\n        default:\n          return status || '-';\n      }\n    };\n\n    /* -------------------------\n       API Calls\n       ------------------------- */\n    const fetchPurchases = async (page = 1) => {\n      loadingPurchases.value = true;\n      currentPagePurchases.value = page;\n      try {\n        const params = {\n          page,\n          size: 10,\n          status: 'APPROVED'\n        }; // Hanya PO approved untuk retur\n        if (fromDate.value) params.from = fromDate.value;\n        if (toDate.value) params.to = toDate.value;\n        const res = await api.get(ENDPOINTS.PURCHASES, {\n          params\n        });\n        const data = res.data?.data || res.data || [];\n        purchases.value = Array.isArray(data) ? data : [];\n        totalPurchases.value = res.data?.total || data.length;\n        showToast('Daftar PO dimuat berhasil!');\n      } catch (err) {\n        console.error('Error fetching purchases:', err);\n        showToast(`Gagal memuat PO: ${err.response?.data?.error || err.message}`, 'error');\n        purchases.value = [];\n      } finally {\n        loadingPurchases.value = false;\n      }\n    };\n    const fetchPurchaseReturns = async (page = 1) => {\n      loadingReturns.value = true;\n      currentPageReturns.value = page;\n      try {\n        const params = {\n          page,\n          size: 10\n        };\n        if (returnFromDate.value) params.from = returnFromDate.value;\n        if (returnToDate.value) params.to = returnToDate.value;\n        if (returnStatusFilter.value) params.status = returnStatusFilter.value;\n        const res = await api.get(ENDPOINTS.PURCHASE_RETURNS, {\n          params\n        });\n        const data = res.data?.data || res.data || [];\n        purchaseReturns.value = Array.isArray(data) ? data : [];\n        totalReturns.value = res.data?.total || data.length;\n      } catch (err) {\n        console.error('Error fetching returns:', err);\n        showToast(`Gagal memuat retur: ${err.response?.data?.error || err.message}`, 'error');\n        purchaseReturns.value = [];\n      } finally {\n        loadingReturns.value = false;\n      }\n    };\n    const openReturnModal = async purchaseId => {\n      try {\n        const res = await api.get(`${ENDPOINTS.PURCHASE_DETAIL}/${purchaseId}`);\n        selectedPurchase.value = res.data?.data || res.data;\n\n        // Map items dengan data lengkap (termasuk original_qty dari purchase items)\n        returnForm.value.items = (selectedPurchase.value.Items || []).map(item => ({\n          product_id: item.ProductID || item.product_id || item.Product?.id,\n          product_name: item.Product?.name || 'N/A',\n          original_qty: item.Qty || 0,\n          qty: 0,\n          price: item.Price || 0,\n          reason: '',\n          subtotal: 0\n        }));\n        returnNotes.value = '';\n        showModal.value = true;\n        await nextTick(); // Pastikan DOM updated\n      } catch (err) {\n        console.error('Error loading purchase detail:', err);\n        showToast(`Gagal memuat detail PO: ${err.response?.data?.error || err.message}`, 'error');\n      }\n    };\n    const updateSubtotal = index => {\n      const item = returnForm.value.items[index];\n      if (item) {\n        item.subtotal = item.qty * item.price;\n      }\n    };\n    const removeItem = index => {\n      returnForm.value.items.splice(index, 1);\n    };\n    const closeModal = () => {\n      showModal.value = false;\n      selectedPurchase.value = null;\n      returnForm.value = {\n        items: []\n      };\n      returnNotes.value = '';\n    };\n    const submitReturn = async () => {\n      if (!isFormValid.value) {\n        showToast('Minimal satu item harus punya qty > 0 dan alasan minimal 10 karakter!', 'error');\n        return;\n      }\n      submitting.value = true;\n      try {\n        const validItems = returnForm.value.items.filter(item => item.qty > 0 && item.reason?.trim().length >= 10).map(item => ({\n          product_id: item.product_id,\n          qty: item.qty,\n          price: item.price\n        }));\n        const payload = {\n          purchase_id: selectedPurchase.value.id || selectedPurchase.value.ID,\n          date: new Date().toISOString().split('T')[0],\n          // YYYY-MM-DD\n          items: validItems,\n          notes: returnNotes.value.trim()\n        };\n        const res = await api.post(ENDPOINTS.CREATE_RETURN, payload);\n        if (res.status === 201 || res.status === 200) {\n          showToast('Retur berhasil dibuat! Status: PENDING (menunggu approval).');\n          closeModal();\n          fetchPurchaseReturns();\n          fetchPurchases();\n        }\n      } catch (err) {\n        console.error('Error submitting return:', err);\n        showToast(`Gagal submit retur: ${err.response?.data?.error || err.message}`, 'error');\n      } finally {\n        submitting.value = false;\n      }\n    };\n    const viewReturnDetail = returnId => {\n      // Rekomendasi: Navigasi ke detail page atau open modal detail\n      console.log('View detail return:', returnId);\n      // router.push(`/retur/detail/${returnId}`); // Jika ada route detail\n      alert(`Fitur detail retur untuk ID ${returnId} - Bisa dikembangkan lebih lanjut!`);\n    };\n    const resetPurchaseFilter = () => {\n      fromDate.value = '';\n      toDate.value = '';\n      fetchPurchases();\n    };\n    const resetReturnFilter = () => {\n      returnFromDate.value = '';\n      returnToDate.value = '';\n      returnStatusFilter.value = '';\n      fetchPurchaseReturns();\n    };\n    const changePageReturns = delta => {\n      const newPage = currentPageReturns.value + delta;\n      if (newPage >= 1 && newPage <= totalPagesReturns.value) {\n        fetchPurchaseReturns(newPage);\n      }\n    };\n\n    /* -------------------------\n       Lifecycle Hooks\n       ------------------------- */\n    onMounted(() => {\n      fetchPurchases();\n      fetchPurchaseReturns();\n    });\n    const __returned__ = {\n      router,\n      API_BASE,\n      ENDPOINTS,\n      api,\n      token,\n      purchases,\n      loadingPurchases,\n      fromDate,\n      toDate,\n      currentPagePurchases,\n      totalPurchases,\n      purchaseReturns,\n      loadingReturns,\n      returnFromDate,\n      returnToDate,\n      returnStatusFilter,\n      currentPageReturns,\n      totalReturns,\n      totalPagesReturns,\n      showModal,\n      selectedPurchase,\n      returnForm,\n      returnNotes,\n      submitting,\n      toast,\n      showToast,\n      isFormValid,\n      totalReturnAmount,\n      formatDate,\n      formatDateFull,\n      formatCurrency,\n      formatPONumber,\n      formatReturnNumber,\n      getPOStatusClass,\n      getPOStatusText,\n      getStatusClass,\n      getStatusText,\n      fetchPurchases,\n      fetchPurchaseReturns,\n      openReturnModal,\n      updateSubtotal,\n      removeItem,\n      closeModal,\n      submitReturn,\n      viewReturnDetail,\n      resetPurchaseFilter,\n      resetReturnFilter,\n      changePageReturns,\n      ref,\n      onMounted,\n      computed,\n      nextTick,\n      get useRouter() {\n        return useRouter;\n      },\n      get axios() {\n        return axios;\n      },\n      CashierLayouts\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","computed","nextTick","useRouter","axios","CashierLayouts","router","API_BASE","import","meta","env","VITE_API_BASE_URL","ENDPOINTS","PURCHASES","PURCHASE_DETAIL","PURCHASE_RETURNS","CREATE_RETURN","api","create","baseURL","token","localStorage","getItem","defaults","headers","common","interceptors","response","use","error","status","removeItem","push","Promise","reject","purchases","loadingPurchases","fromDate","toDate","currentPagePurchases","totalPurchases","purchaseReturns","loadingReturns","returnFromDate","returnToDate","returnStatusFilter","currentPageReturns","totalReturns","totalPagesReturns","Math","ceil","value","showModal","selectedPurchase","returnForm","items","returnNotes","submitting","toast","message","type","showToast","setTimeout","isFormValid","some","item","qty","reason","trim","length","totalReturnAmount","reduce","sum","subtotal","formatDate","dateStr","date","Date","toLocaleDateString","day","month","year","formatDateFull","formatCurrency","amount","Intl","NumberFormat","style","currency","minimumFractionDigits","format","formatPONumber","id","String","padStart","formatReturnNumber","getFullYear","getPOStatusClass","toUpperCase","getPOStatusText","getStatusClass","getStatusText","fetchPurchases","page","params","size","from","to","res","get","data","Array","isArray","total","err","console","fetchPurchaseReturns","openReturnModal","purchaseId","Items","map","product_id","ProductID","Product","product_name","name","original_qty","Qty","price","Price","updateSubtotal","index","splice","closeModal","submitReturn","validItems","filter","payload","purchase_id","ID","toISOString","split","notes","post","viewReturnDetail","returnId","log","alert","resetPurchaseFilter","resetReturnFilter","changePageReturns","delta","newPage"],"sources":["C:/Users/Personal/Documents/PKL/aplikasi/aplikasi/src/views/PurchaseReturn.vue"],"sourcesContent":["<template>\n  <CashierLayouts>\n    <div class=\"space-y-6\">\n      <!-- Header -->\n      <div class=\"flex flex-wrap justify-between items-center gap-3 p-4 bg-white rounded-lg shadow-sm\">\n        <div>\n          <h1 class=\"text-[#111418] tracking-tight text-3xl font-bold leading-tight\">\n            Retur Pembelian\n          </h1>\n          <p class=\"text-gray-600 mt-1\">Kelola retur untuk pembelian yang sudah disetujui. Pilih PO, tentukan item retur, dan tambahkan alasan.</p>\n        </div>\n        <div class=\"flex gap-2\">\n          <button\n            @click=\"fetchPurchases\"\n            :disabled=\"loadingPurchases\"\n            class=\"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors flex items-center gap-2\"\n          >\n            <span v-if=\"loadingPurchases\" class=\"animate-spin\">⏳</span>\n            {{ fromDate || toDate ? 'Filter PO' : 'Load 10 Terakhir' }}\n          </button>\n          <button\n            @click=\"resetPurchaseFilter\"\n            class=\"px-6 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors\"\n          >\n            Reset Filter\n          </button>\n        </div>\n      </div>\n\n      <!-- Filter untuk Daftar PO -->\n      <div v-if=\"purchases.length > 0\" class=\"p-4 bg-blue-50 rounded-lg border border-blue-200\">\n        <div class=\"flex flex-wrap gap-4 items-end max-w-md\">\n          <div class=\"flex-1 min-w-[200px]\">\n            <label class=\"block text-sm font-medium text-gray-700 mb-1\">Dari Tanggal</label>\n            <input\n              type=\"date\"\n              v-model=\"fromDate\"\n              class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            />\n          </div>\n          <div class=\"flex-1 min-w-[200px]\">\n            <label class=\"block text-sm font-medium text-gray-700 mb-1\">Sampai Tanggal</label>\n            <input\n              type=\"date\"\n              v-model=\"toDate\"\n              class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            />\n          </div>\n        </div>\n        <p v-if=\"fromDate || toDate\" class=\"text-sm text-blue-600 mt-2\">\n          Filter: {{ formatDateFull(fromDate) }} - {{ formatDateFull(toDate) }}\n        </p>\n      </div>\n\n      <!-- Table: Daftar Purchase Orders (PO) untuk Retur -->\n      <div class=\"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden\">\n        <div class=\"p-4 border-b border-gray-200\">\n          <h2 class=\"text-xl font-semibold text-gray-900\">\n            Daftar Pembelian Tersedia untuk Retur\n            <span class=\"text-sm text-gray-500 ml-2\">({{ purchases.length }} item{{ purchases.length !== 1 ? 's' : '' }})</span>\n          </h2>\n        </div>\n        <div class=\"overflow-x-auto\">\n          <table class=\"min-w-full divide-y divide-gray-200\">\n            <thead class=\"bg-gray-50\">\n              <tr>\n                <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Tanggal</th>\n                <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Nomor PO</th>\n                <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Supplier</th>\n                <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Total</th>\n                <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Status</th>\n                <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Aksi</th>\n              </tr>\n            </thead>\n            <tbody class=\"bg-white divide-y divide-gray-200\">\n              <tr v-if=\"loadingPurchases\" class=\"text-center\">\n                <td colspan=\"6\" class=\"py-12\">\n                  <div class=\"flex items-center justify-center gap-2 text-gray-500\">\n                    <div class=\"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600\"></div>\n                    Memuat daftar PO...\n                  </div>\n                </td>\n              </tr>\n              <tr v-else-if=\"purchases.length === 0\">\n                <td colspan=\"6\" class=\"py-12 text-center text-gray-500\">\n                  <p>Tidak ada pembelian yang tersedia untuk retur.</p>\n                  <p class=\"text-sm mt-1\">Coba filter tanggal atau load ulang.</p>\n                </td>\n              </tr>\n              <tr v-else v-for=\"po in purchases\" :key=\"po.id || po.ID\" class=\"hover:bg-gray-50\">\n                <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                  {{ formatDate(po.created_at || po.Date) }}\n                </td>\n                <td class=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\">\n                  {{ formatPONumber(po.id || po.ID) }}\n                </td>\n                <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                  {{ po.Supplier?.name || po.supplier_name || 'Tidak diketahui' }}\n                </td>\n                <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                  {{ formatCurrency(po.total || po.Total) }}\n                </td>\n                <td class=\"px-6 py-4 whitespace-nowrap\">\n                  <span :class=\"getPOStatusClass(po.status)\" class=\"px-3 py-1 rounded-full text-xs font-medium\">\n                    {{ getPOStatusText(po.status) }}\n                  </span>\n                </td>\n                <td class=\"px-6 py-4 whitespace-nowrap text-sm font-medium\">\n                  <button\n                    @click=\"openReturnModal(po.id || po.ID)\"\n                    :disabled=\"po.status !== 'APPROVED'\"\n                    class=\"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors text-sm font-medium\"\n                  >\n                    {{ po.status === 'APPROVED' ? 'Add Retur' : 'Tidak Bisa' }}\n                  </button>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n\n      <!-- Section: Daftar Retur Saya -->\n      <div class=\"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden\">\n        <div class=\"p-4 border-b border-gray-200 flex justify-between items-center\">\n          <h2 class=\"text-xl font-semibold text-gray-900\">Daftar Retur Pembelian Saya</h2>\n          <div class=\"flex gap-2\">\n            <button\n              @click=\"fetchPurchaseReturns\"\n              :disabled=\"loadingReturns\"\n              class=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors flex items-center gap-2 text-sm\"\n            >\n              <span v-if=\"loadingReturns\" class=\"animate-spin\">⏳</span>\n              Filter\n            </button>\n            <button\n              @click=\"resetReturnFilter\"\n              class=\"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors text-sm\"\n            >\n              Reset\n            </button>\n          </div>\n        </div>\n\n        <!-- Filter untuk Retur -->\n        <div class=\"p-4 bg-gray-50\">\n          <div class=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n            <div>\n              <label class=\"block text-sm font-medium text-gray-700 mb-1\">Dari Tanggal</label>\n              <input\n                type=\"date\"\n                v-model=\"returnFromDate\"\n                class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              />\n            </div>\n            <div>\n              <label class=\"block text-sm font-medium text-gray-700 mb-1\">Sampai Tanggal</label>\n              <input\n                type=\"date\"\n                v-model=\"returnToDate\"\n                class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              />\n            </div>\n            <div>\n              <label class=\"block text-sm font-medium text-gray-700 mb-1\">Status</label>\n              <select\n                v-model=\"returnStatusFilter\"\n                class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              >\n                <option value=\"\">Semua Status</option>\n                <option value=\"PENDING\">Pending</option>\n                <option value=\"APPROVED\">Disetujui</option>\n                <option value=\"REJECTED\">Ditolak</option>\n              </select>\n            </div>\n            <div class=\"flex items-end\">\n              <p v-if=\"returnFromDate || returnToDate || returnStatusFilter\" class=\"text-sm text-gray-600 col-span-full mt-2\">\n                Filter: {{ formatDateFull(returnFromDate) }} - {{ formatDateFull(returnToDate) }} | Status: {{ returnStatusFilter || 'Semua' }}\n              </p>\n            </div>\n          </div>\n        </div>\n\n        <!-- Table: Retur Saya -->\n        <div class=\"overflow-x-auto\">\n          <table class=\"min-w-full divide-y divide-gray-200\">\n            <thead class=\"bg-gray-50\">\n              <tr>\n                <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">No. Retur</th>\n                <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">PO Terkait</th>\n                <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Tanggal Retur</th>\n                <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Total Retur</th>\n                <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Status</th>\n                <th class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Aksi</th>\n              </tr>\n            </thead>\n            <tbody class=\"bg-white divide-y divide-gray-200\">\n              <tr v-if=\"loadingReturns\">\n                <td colspan=\"6\" class=\"text-center py-12\">\n                  <div class=\"flex items-center justify-center gap-2 text-gray-500\">\n                    <div class=\"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600\"></div>\n                    Memuat retur...\n                  </div>\n                </td>\n              </tr>\n              <tr v-else-if=\"purchaseReturns.length === 0\">\n                <td colspan=\"6\" class=\"py-12 text-center text-gray-500\">\n                  Belum ada retur pembelian yang dibuat.\n                </td>\n              </tr>\n              <tr v-else v-for=\"ret in purchaseReturns\" :key=\"ret.id\">\n                <td class=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\">\n                  {{ formatReturnNumber(ret.id) }}\n                </td>\n                <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                  {{ formatPONumber(ret.purchase_id) }}\n                </td>\n                <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                  {{ formatDate(ret.created_at || ret.date) }}\n                </td>\n                <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                  {{ formatCurrency(ret.total || ret.Total) }}\n                </td>\n                <td class=\"px-6 py-4 whitespace-nowrap\">\n                  <span :class=\"getStatusClass(ret.status)\" class=\"px-3 py-1 rounded-full text-xs font-medium\">\n                    {{ getStatusText(ret.status) }}\n                  </span>\n                </td>\n                <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                  <button\n                    @click=\"viewReturnDetail(ret.id)\"\n                    class=\"text-blue-600 hover:text-blue-900 text-sm font-medium\"\n                  >\n                    Lihat Detail\n                  </button>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n\n        <!-- Pagination untuk Retur (Rekomendasi: Tambah pagination sederhana) -->\n        <div v-if=\"purchaseReturns.length > 0\" class=\"p-4 bg-gray-50 border-t border-gray-200 flex justify-between items-center\">\n          <p class=\"text-sm text-gray-600\">Menampilkan {{ purchaseReturns.length }} dari {{ totalReturns }} retur</p>\n          <div class=\"flex gap-2\">\n            <button\n              @click=\"changePageReturns(-1)\"\n              :disabled=\"currentPageReturns <= 1\"\n              class=\"px-3 py-1 bg-gray-300 text-gray-700 rounded disabled:opacity-50\"\n            >\n              Sebelumnya\n            </button>\n            <span class=\"px-3 py-1 bg-white border rounded\">Hal. {{ currentPageReturns }}</span>\n            <button\n              @click=\"changePageReturns(1)\"\n              :disabled=\"currentPageReturns >= totalPagesReturns\"\n              class=\"px-3 py-1 bg-gray-300 text-gray-700 rounded disabled:opacity-50\"\n            >\n              Selanjutnya\n            </button>\n          </div>\n        </div>\n      </div>\n\n      <!-- Modal: Buat Retur Baru -->\n      <div v-if=\"showModal\" class=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-y-auto\">\n        <div class=\"bg-white rounded-lg p-6 max-w-6xl w-full max-h-[95vh]\">\n          <div class=\"flex justify-between items-center mb-6\">\n            <h2 class=\"text-2xl font-bold text-gray-900\">Buat Retur Pembelian</h2>\n            <button @click=\"closeModal\" class=\"text-gray-400 hover:text-gray-600 text-2xl\">&times;</button>\n          </div>\n\n          <!-- Info PO Terpilih -->\n          <div v-if=\"selectedPurchase\" class=\"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200\">\n            <h3 class=\"font-semibold text-gray-900 mb-2\">Detail Pembelian Terpilih</h3>\n            <div class=\"grid grid-cols-1 md:grid-cols-4 gap-4 text-sm\">\n              <div><strong>Nomor PO:</strong> {{ formatPONumber(selectedPurchase.id || selectedPurchase.ID) }}</div>\n              <div><strong>Tanggal:</strong> {{ formatDate(selectedPurchase.created_at || selectedPurchase.Date) }}</div>\n              <div><strong>Supplier:</strong> {{ selectedPurchase.Supplier?.name || 'N/A' }}</div>\n              <div><strong>Total Asli:</strong> {{ formatCurrency(selectedPurchase.total || selectedPurchase.Total) }}</div>\n            </div>\n          </div>\n\n          <!-- Form Items Retur -->\n          <div class=\"mb-6\">\n            <h3 class=\"text-lg font-semibold mb-4 text-gray-900\">Pilih Item untuk Diretur</h3>\n            <div v-if=\"returnForm.items.length === 0\" class=\"text-center py-8 text-gray-500\">\n              Tidak ada item yang tersedia untuk retur.\n            </div>\n            <div v-else class=\"space-y-4\">\n              <div\n                v-for=\"(item, index) in returnForm.items\"\n                :key=\"index\"\n                class=\"border border-gray-200 rounded-lg p-4 bg-gray-50\"\n              >\n                <div class=\"flex flex-wrap gap-4 items-start justify-between\">\n                  <div class=\"flex-1\">\n                    <p class=\"font-medium text-gray-900\">{{ item.product_name || 'N/A' }}</p>\n                    <p class=\"text-sm text-gray-600\">\n                      Qty Asli: {{ item.original_qty }} | Harga: {{ formatCurrency(item.price) }}\n                    </p>\n                  </div>\n                  <div class=\"w-24\">\n                    <label class=\"block text-sm font-medium text-gray-700 mb-1\">Qty Retur</label>\n                    <input\n                      type=\"number\"\n                      v-model.number=\"item.qty\"\n                      :min=\"0\"\n                      :max=\"item.original_qty\"\n                      class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500\"\n                      @input=\"updateSubtotal(index)\"\n                    />\n                  </div>\n                  <div class=\"flex-1\">\n                    <label class=\"block text-sm font-medium text-gray-700 mb-1\">Alasan Retur *</label>\n                    <textarea\n                      v-model=\"item.reason\"\n                      placeholder=\"Jelaskan alasan retur item ini (wajib)\"\n                      rows=\"2\"\n                      class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 resize-none\"\n                    ></textarea>\n                    <p v-if=\"item.reason && item.reason.length < 10\" class=\"text-xs text-red-500 mt-1\">\n                      Alasan minimal 10 karakter.\n                    </p>\n                  </div>\n                  <div class=\"w-24 text-right\">\n                    <p class=\"text-sm font-medium text-gray-900\">Subtotal: {{ formatCurrency(item.subtotal) }}</p>\n                  </div>\n                </div>\n                <button\n                  v-if=\"item.qty > 0\"\n                  @click=\"removeItem(index)\"\n                  class=\"mt-2 text-red-600 hover:text-red-800 text-sm font-medium\"\n                >\n                  Hapus Item Ini\n                </button>\n              </div>\n            </div>\n            <p v-if=\"totalReturnAmount > 0\" class=\"mt-4 text-right font-semibold text-lg text-gray-900\">\n              Total Retur: {{ formatCurrency(totalReturnAmount) }}\n            </p>\n          </div>\n\n          <!-- Catatan Tambahan -->\n          <div class=\"mb-6\">\n            <label class=\"block text-sm font-medium text-gray-700 mb-2\">Catatan Tambahan (Opsional)</label>\n            <textarea\n              v-model=\"returnNotes\"\n              placeholder=\"Tambahkan catatan untuk retur ini (misal: nomor invoice supplier)\"\n              rows=\"3\"\n              class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none\"\n            ></textarea>\n          </div>\n\n          <!-- Footer Modal -->\n          <div class=\"flex justify-end gap-3 pt-4 border-t border-gray-200\">\n            <button\n              @click=\"closeModal\"\n              class=\"px-6 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors\"\n            >\n              Batal\n            </button>\n            <button\n              @click=\"submitReturn\"\n              :disabled=\"submitting || !isFormValid\"\n              class=\"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2\"\n            >\n              <span v-if=\"submitting\" class=\"animate-spin\">⏳</span>\n              {{ submitting ? 'Menyimpan...' : 'Submit Retur' }}\n            </button>\n          </div>\n        </div>\n      </div>\n\n      <!-- Toast Notification (Rekomendasi: Simple toast untuk feedback) -->\n      <div v-if=\"toast.message\" :class=\"['fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 transition-all', toast.type === 'success' ? 'bg-green-500 text-white' : 'bg-red-500 text-white']\">\n        {{ toast.message }}\n      </div>\n    </div>\n  </CashierLayouts>\n</template>\n\n<script setup>\nimport { ref, onMounted, computed, nextTick } from 'vue';\nimport { useRouter } from 'vue-router'; // Jika perlu navigasi\nimport axios from 'axios';\nimport CashierLayouts from '@/components/CashierLayouts.vue';\n\nconst router = useRouter();\n\n/* -------------------------\n   API Configuration\n   ------------------------- */\nconst API_BASE = import.meta.env.VITE_API_BASE_URL || 'http://localhost:8081/api/v1';\nconst ENDPOINTS = {\n  PURCHASES: '/history/purchases',\n  PURCHASE_DETAIL: '/pembelian/purchases', // Base untuk /:id\n  PURCHASE_RETURNS: '/history/purchase-returns',\n  CREATE_RETURN: '/pembelian/purchase-returns'\n};\n\nconst api = axios.create({ baseURL: API_BASE });\nconst token = localStorage.getItem('token');\nif (token) {\n  api.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n}\n\n// Interceptor untuk error global\napi.interceptors.response.use(\n  (response) => response,\n  (error) => {\n    if (error.response?.status === 401) {\n      localStorage.removeItem('token');\n      router.push('/login');\n    }\n    return Promise.reject(error);\n  }\n);\n\n/* -------------------------\n   State Management\n   ------------------------- */\nconst purchases = ref([]);\nconst loadingPurchases = ref(false);\nconst fromDate = ref('');\nconst toDate = ref('');\nconst currentPagePurchases = ref(1);\nconst totalPurchases = ref(0);\n\nconst purchaseReturns = ref([]);\nconst loadingReturns = ref(false);\nconst returnFromDate = ref('');\nconst returnToDate = ref('');\nconst returnStatusFilter = ref('');\nconst currentPageReturns = ref(1);\nconst totalReturns = ref(0);\nconst totalPagesReturns = computed(() => Math.ceil(totalReturns.value / 10));\n\n/* Modal State */\nconst showModal = ref(false);\nconst selectedPurchase = ref(null);\nconst returnForm = ref({ items: [] });\nconst returnNotes = ref('');\nconst submitting = ref(false);\n\n/* Toast State (Rekomendasi baru: Feedback user) */\nconst toast = ref({ message: '', type: 'success' });\nconst showToast = (message, type = 'success') => {\n  toast.value = { message, type };\n  setTimeout(() => { toast.value.message = ''; }, 3000);\n};\n\n/* -------------------------\n   Computed Properties\n   ------------------------- */\nconst isFormValid = computed(() => {\n  return returnForm.value.items.some(item => item.qty > 0 && item.reason?.trim().length >= 10);\n});\n\nconst totalReturnAmount = computed(() => {\n  return returnForm.value.items.reduce((sum, item) => sum + (item.subtotal || 0), 0);\n});\n\n/* -------------------------\n   Utility Functions\n   ------------------------- */\nconst formatDate = (dateStr) => {\n  if (!dateStr) return 'N/A';\n  const date = new Date(dateStr);\n  return date.toLocaleDateString('id-ID', { day: '2-digit', month: 'short', year: 'numeric' });\n};\n\nconst formatDateFull = (dateStr) => dateStr ? new Date(dateStr).toLocaleDateString('id-ID') : 'N/A';\n\nconst formatCurrency = (amount) => {\n  return new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', minimumFractionDigits: 0 }).format(amount || 0);\n};\n\nconst formatPONumber = (id) => `PO-${String(id || '').padStart(3, '0')}`;\nconst formatReturnNumber = (id) => `RTN-${new Date().getFullYear()}-${String(id || '').padStart(3, '0')}`;\n\nconst getPOStatusClass = (status) => {\n  switch (status?.toUpperCase()) {\n    case 'APPROVED': return 'bg-green-100 text-green-800';\n    case 'SUBMITTED': return 'bg-yellow-100 text-yellow-800';\n    case 'REJECTED': return 'bg-red-100 text-red-800';\n    default: return 'bg-gray-100 text-gray-800';\n  }\n};\n\nconst getPOStatusText = (status) => {\n  switch (status?.toUpperCase()) {\n    case 'APPROVED': return 'Disetujui';\n    case 'SUBMITTED': return 'Diajukan';\n    case 'REJECTED': return 'Ditolak';\n    default: return status || 'Draft';\n  }\n};\n\nconst getStatusClass = (status) => {\n  switch (status?.toUpperCase()) {\n    case 'PENDING': return 'bg-yellow-100 text-yellow-800';\n    case 'APPROVED': return 'bg-green-100 text-green-800';\n    case 'REJECTED': return 'bg-red-100 text-red-800';\n    default: return 'bg-gray-100 text-gray-800';\n  }\n};\n\nconst getStatusText = (status) => {\n  switch (status?.toUpperCase()) {\n    case 'PENDING': return 'Menunggu';\n    case 'APPROVED': return 'Disetujui';\n    case 'REJECTED': return 'Ditolak';\n    default: return status || '-';\n  }\n};\n\n/* -------------------------\n   API Calls\n   ------------------------- */\nconst fetchPurchases = async (page = 1) => {\n  loadingPurchases.value = true;\n  currentPagePurchases.value = page;\n  try {\n    const params = { page, size: 10, status: 'APPROVED' }; // Hanya PO approved untuk retur\n    if (fromDate.value) params.from = fromDate.value;\n    if (toDate.value) params.to = toDate.value;\n\n    const res = await api.get(ENDPOINTS.PURCHASES, { params });\n    const data = res.data?.data || res.data || [];\n    purchases.value = Array.isArray(data) ? data : [];\n    totalPurchases.value = res.data?.total || data.length;\n    showToast('Daftar PO dimuat berhasil!');\n  } catch (err) {\n    console.error('Error fetching purchases:', err);\n    showToast(`Gagal memuat PO: ${err.response?.data?.error || err.message}`, 'error');\n    purchases.value = [];\n  } finally {\n    loadingPurchases.value = false;\n  }\n};\n\nconst fetchPurchaseReturns = async (page = 1) => {\n  loadingReturns.value = true;\n  currentPageReturns.value = page;\n  try {\n    const params = { page, size: 10 };\n    if (returnFromDate.value) params.from = returnFromDate.value;\n    if (returnToDate.value) params.to = returnToDate.value;\n    if (returnStatusFilter.value) params.status = returnStatusFilter.value;\n\n    const res = await api.get(ENDPOINTS.PURCHASE_RETURNS, { params });\n    const data = res.data?.data || res.data || [];\n    purchaseReturns.value = Array.isArray(data) ? data : [];\n    totalReturns.value = res.data?.total || data.length;\n  } catch (err) {\n    console.error('Error fetching returns:', err);\n    showToast(`Gagal memuat retur: ${err.response?.data?.error || err.message}`, 'error');\n    purchaseReturns.value = [];\n  } finally {\n    loadingReturns.value = false;\n  }\n};\n\nconst openReturnModal = async (purchaseId) => {\n  try {\n    const res = await api.get(`${ENDPOINTS.PURCHASE_DETAIL}/${purchaseId}`);\n    selectedPurchase.value = res.data?.data || res.data;\n\n    // Map items dengan data lengkap (termasuk original_qty dari purchase items)\n    returnForm.value.items = (selectedPurchase.value.Items || []).map(item => ({\n      product_id: item.ProductID || item.product_id || item.Product?.id,\n      product_name: item.Product?.name || 'N/A',\n      original_qty: item.Qty || 0,\n      qty: 0,\n      price: item.Price || 0,\n      reason: '',\n      subtotal: 0\n    }));\n\n    returnNotes.value = '';\n    showModal.value = true;\n    await nextTick(); // Pastikan DOM updated\n  } catch (err) {\n    console.error('Error loading purchase detail:', err);\n    showToast(`Gagal memuat detail PO: ${err.response?.data?.error || err.message}`, 'error');\n  }\n};\n\nconst updateSubtotal = (index) => {\n  const item = returnForm.value.items[index];\n  if (item) {\n    item.subtotal = item.qty * item.price;\n  }\n};\n\nconst removeItem = (index) => {\n  returnForm.value.items.splice(index, 1);\n};\n\nconst closeModal = () => {\n  showModal.value = false;\n  selectedPurchase.value = null;\n  returnForm.value = { items: [] };\n  returnNotes.value = '';\n};\n\nconst submitReturn = async () => {\n  if (!isFormValid.value) {\n    showToast('Minimal satu item harus punya qty > 0 dan alasan minimal 10 karakter!', 'error');\n    return;\n  }\n\n  submitting.value = true;\n  try {\n    const validItems = returnForm.value.items\n      .filter(item => item.qty > 0 && item.reason?.trim().length >= 10)\n      .map(item => ({\n        product_id: item.product_id,\n        qty: item.qty,\n        price: item.price\n      }));\n\n    const payload = {\n      purchase_id: selectedPurchase.value.id || selectedPurchase.value.ID,\n      date: new Date().toISOString().split('T')[0], // YYYY-MM-DD\n      items: validItems,\n      notes: returnNotes.value.trim()\n    };\n\n    const res = await api.post(ENDPOINTS.CREATE_RETURN, payload);\n    if (res.status === 201 || res.status === 200) {\n      showToast('Retur berhasil dibuat! Status: PENDING (menunggu approval).');\n      closeModal();\n      fetchPurchaseReturns();\n      fetchPurchases();\n    }\n  } catch (err) {\n    console.error('Error submitting return:', err);\n    showToast(`Gagal submit retur: ${err.response?.data?.error || err.message}`, 'error');\n  } finally {\n    submitting.value = false;\n  }\n};\n\nconst viewReturnDetail = (returnId) => {\n  // Rekomendasi: Navigasi ke detail page atau open modal detail\n  console.log('View detail return:', returnId);\n  // router.push(`/retur/detail/${returnId}`); // Jika ada route detail\n  alert(`Fitur detail retur untuk ID ${returnId} - Bisa dikembangkan lebih lanjut!`);\n};\n\nconst resetPurchaseFilter = () => {\n  fromDate.value = '';\n  toDate.value = '';\n  fetchPurchases();\n};\n\nconst resetReturnFilter = () => {\n  returnFromDate.value = '';\n  returnToDate.value = '';\n  returnStatusFilter.value = '';\n  fetchPurchaseReturns();\n};\n\nconst changePageReturns = (delta) => {\n  const newPage = currentPageReturns.value + delta;\n  if (newPage >= 1 && newPage <= totalPagesReturns.value) {\n    fetchPurchaseReturns(newPage);\n  }\n};\n\n/* -------------------------\n   Lifecycle Hooks\n   ------------------------- */\nonMounted(() => {\n  fetchPurchases();\n  fetchPurchaseReturns();\n});\n</script>\n\n<style scoped>\n/* Custom styles untuk smooth transitions */\n.fade-enter-active, .fade-leave-active {\n  transition: opacity 0.3s;\n}\n.fade-enter-from, .fade-leave-to {\n  opacity: 0;\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}