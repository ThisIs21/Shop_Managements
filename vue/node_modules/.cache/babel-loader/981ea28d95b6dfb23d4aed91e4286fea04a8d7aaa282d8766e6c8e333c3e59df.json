{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/es.iterator.reduce.js\";\nimport \"core-js/modules/es.set.difference.v2.js\";\nimport \"core-js/modules/es.set.intersection.v2.js\";\nimport \"core-js/modules/es.set.is-disjoint-from.v2.js\";\nimport \"core-js/modules/es.set.is-subset-of.v2.js\";\nimport \"core-js/modules/es.set.is-superset-of.v2.js\";\nimport \"core-js/modules/es.set.symmetric-difference.v2.js\";\nimport \"core-js/modules/es.set.union.v2.js\";\nimport { ref, computed, onMounted } from \"vue\";\nimport axios from \"axios\";\n\n// baseURL API Golang\n\nexport default {\n  __name: 'CashierPage',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const api = axios.create({\n      baseURL: \"http://localhost:8081/api/v1\",\n      headers: {\n        Authorization: \"Bearer \" + localStorage.getItem(\"token\") // ambil token JWT dari localStorage\n      }\n    });\n\n    // state\n    const products = ref([]);\n    const cart = ref([]);\n    const search = ref(\"\");\n    const selectedCategory = ref(\"All\");\n    const categories = ref([]);\n\n    // load products dari API\n    onMounted(async () => {\n      try {\n        const res = await api.get(\"/products\");\n        products.value = res.data.data; // sesuaikan dengan struktur response\n        // ambil distinct kategori dari API\n        categories.value = [...new Set(products.value.map(p => p.category.name))];\n      } catch (err) {\n        console.error(\"Gagal load produk\", err);\n      }\n    });\n\n    // computed untuk filter & search\n    const filteredProducts = computed(() => {\n      return products.value.filter(p => {\n        const matchCategory = selectedCategory.value === \"All\" || p.category.name === selectedCategory.value;\n        const matchSearch = p.name.toLowerCase().includes(search.value.toLowerCase());\n        return matchCategory && matchSearch;\n      });\n    });\n\n    // add to cart\n    const addToCart = product => {\n      const exist = cart.value.find(item => item.id === product.id);\n      if (exist) {\n        if (exist.qty < product.stock) {\n          exist.qty++;\n        }\n      } else {\n        cart.value.push({\n          ...product,\n          qty: 1\n        });\n      }\n    };\n\n    // remove item\n    const removeFromCart = i => cart.value.splice(i, 1);\n\n    // format\n    const formatCurrency = num => new Intl.NumberFormat(\"id-ID\", {\n      style: \"currency\",\n      currency: \"IDR\"\n    }).format(num);\n\n    // total\n    const totalAmount = computed(() => cart.value.reduce((sum, item) => sum + item.sell_price * item.qty, 0));\n\n    // checkout (POST ke Go)\n    const checkout = async () => {\n      if (cart.value.length === 0) return alert(\"Cart kosong\");\n      try {\n        const payload = {\n          customer_id: 1,\n          // sementara hardcode, bisa ambil dari input user\n          date: new Date(),\n          items: cart.value.map(item => ({\n            product_id: item.id,\n            qty: item.qty,\n            price: item.sell_price\n          }))\n        };\n        const res = await api.post(\"/kasir/sales\", payload);\n        alert(\"Transaksi berhasil dibuat!\");\n        cart.value = [];\n      } catch (err) {\n        console.error(\"Checkout gagal\", err);\n        alert(\"Checkout gagal: \" + err.response?.data?.error || err.message);\n      }\n    };\n    const __returned__ = {\n      api,\n      products,\n      cart,\n      search,\n      selectedCategory,\n      categories,\n      filteredProducts,\n      addToCart,\n      removeFromCart,\n      formatCurrency,\n      totalAmount,\n      checkout,\n      ref,\n      computed,\n      onMounted,\n      get axios() {\n        return axios;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","axios","api","create","baseURL","headers","Authorization","localStorage","getItem","products","cart","search","selectedCategory","categories","res","get","value","data","Set","map","p","category","name","err","console","error","filteredProducts","filter","matchCategory","matchSearch","toLowerCase","includes","addToCart","product","exist","find","item","id","qty","stock","push","removeFromCart","i","splice","formatCurrency","num","Intl","NumberFormat","style","currency","format","totalAmount","reduce","sum","sell_price","checkout","length","alert","payload","customer_id","date","Date","items","product_id","price","post","response","message"],"sources":["C:/Users/SPC STYLE 5/aplikasi/src/views/CashierPage.vue"],"sourcesContent":["<template>\n  <div class=\"min-h-screen flex bg-white\">\n    <!-- Sidebar -->\n    <CashierSidebar />\n\n    <!-- Main -->\n    <main class=\"flex-1 p-6 max-w-7xl mx-auto w-full\">\n      <h2 class=\"text-2xl font-bold text-center mb-6\">Cashier - Order</h2>\n\n      <div class=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n        <!-- ðŸ”¹ LEFT: Products -->\n        <section class=\"md:col-span-2\">\n          <h3 class=\"text-lg font-semibold mb-4\">Available Products</h3>\n\n          <!-- Search + Filter -->\n          <div\n            class=\"flex flex-col md:flex-row md:items-center md:justify-between gap-3 mb-4\"\n          >\n            <!-- Search -->\n            <input\n              v-model=\"search\"\n              type=\"text\"\n              placeholder=\"Cari produk...\"\n              class=\"w-full md:w-1/2 border rounded p-2 text-sm\"\n            />\n\n            <!-- Filter Dropdown -->\n            <select\n              v-model=\"selectedCategory\"\n              class=\"border rounded p-2 text-sm w-full md:w-48\"\n            >\n              <option value=\"All\">Semua Kategori</option>\n              <option v-for=\"cat in categories\" :key=\"cat\" :value=\"cat\">\n                {{ cat }}\n              </option>\n            </select>\n          </div>\n\n          <!-- Product Grid -->\n          <div class=\"grid grid-cols-2 gap-4\">\n            <div\n              v-for=\"p in paginatedProducts\"\n              :key=\"p.id\"\n              class=\"border rounded-lg p-4 bg-white shadow flex flex-col justify-between\"\n            >\n              <div>\n                <h4 class=\"font-semibold\">{{ p.name }}</h4>\n                <p class=\"text-sm text-gray-600\">\n                  {{ formatCurrency(p.price) }}\n                </p>\n                <p class=\"text-xs text-green-600\">Stock: {{ p.stock }}</p>\n              </div>\n              <button\n                @click=\"addToCart(p)\"\n                class=\"mt-3 bg-blue-500 text-white text-sm py-1 rounded hover:bg-blue-600\"\n              >\n                Add\n              </button>\n            </div>\n          </div>\n\n          <!-- Pagination -->\n          <div class=\"flex justify-center items-center gap-3 mt-6\">\n            <button\n              @click=\"prevPage\"\n              :disabled=\"currentPage === 1\"\n              class=\"px-3 py-1 border rounded disabled:opacity-50\"\n            >\n              Prev\n            </button>\n            <span>Page {{ currentPage }} of {{ totalPages }}</span>\n            <button\n              @click=\"nextPage\"\n              :disabled=\"currentPage === totalPages\"\n              class=\"px-3 py-1 border rounded disabled:opacity-50\"\n            >\n              Next\n            </button>\n          </div>\n        </section>\n\n        <!-- ðŸ”¹ RIGHT: Cart -->\n        <section class=\"md:col-span-1 flex flex-col\">\n          <h3 class=\"text-lg font-semibold mb-4\">Cart Order</h3>\n\n          <!-- Cart Table (Scrollable) -->\n          <div\n            class=\"border rounded-lg p-3 bg-white shadow max-h-64 overflow-y-auto\"\n          >\n            <table class=\"w-full text-sm\">\n              <thead class=\"justify top-0 bg-gray-100\">\n                <tr>\n                  <th class=\"p-2\">Item</th>\n                  <th class=\"p-2\">Qty</th>\n                  <th class=\"p-2\">Subtotal</th>\n                  <th class=\"p-2\">X</th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr v-for=\"(item, i) in cart\" :key=\"item.id\" class=\"border-t\">\n                  <td class=\"p-2\">{{ item.name }}</td>\n                  <td class=\"p-2\">\n                    <input\n                      type=\"number\"\n                      v-model.number=\"item.qty\"\n                      min=\"1\"\n                      :max=\"item.stock\"\n                      class=\"w-14 border rounded p-1\"\n                    />\n                  </td>\n                  <td class=\"p-2\">\n                    {{ formatCurrency(item.price * item.qty) }}\n                  </td>\n                  <td class=\"p-2\">\n                    <button @click=\"removeFromCart(i)\" class=\"text-red-500\">\n                      âœ•\n                    </button>\n                  </td>\n                </tr>\n                <tr v-if=\"cart.length === 0\">\n                  <td colspan=\"4\" class=\"text-center text-gray-500 py-4\">\n                    Cart kosong\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n\n          <!-- Order Summary -->\n          <div class=\"mt-6 border rounded-lg p-3 bg-white shadow\">\n            <h4 class=\"font-semibold mb-2\">Order Summary</h4>\n            <div class=\"space-y-1 text-sm\">\n              <div class=\"flex justify-between\">\n                <span>Subtotal</span>\n                <span>{{ formatCurrency(subtotal) }}</span>\n              </div>\n              <div class=\"flex justify-between\">\n                <span>Tax (10%)</span>\n                <span>{{ formatCurrency(tax) }}</span>\n              </div>\n              <div class=\"flex justify-between font-bold border-t pt-2\">\n                <span>Total</span>\n                <span>{{ formatCurrency(total) }}</span>\n              </div>\n            </div>\n\n            <!-- Payment -->\n            <div class=\"mt-4\">\n              <label class=\"block mb-2 text-sm\">Amount Received</label>\n              <input\n                v-model.number=\"amountReceived\"\n                type=\"number\"\n                placeholder=\"Masukkan nominal\"\n                class=\"w-full border rounded p-2 text-sm\"\n              />\n              <p class=\"text-sm mt-1\">\n                Change:\n                <span class=\"font-semibold\">\n                  {{ formatCurrency(change) }}\n                </span>\n              </p>\n            </div>\n\n            <!-- Buttons -->\n            <div class=\"flex flex-col gap-3 mt-6\">\n              <button\n                @click=\"handlePayNow\"\n                class=\"w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700\"\n              >\n                Pay Now\n              </button>\n              <button\n                @click=\"handlePrintReceipt\"\n                class=\"w-full bg-gray-100 py-2 rounded hover:bg-gray-200\"\n              >\n                Print Receipt\n              </button>\n            </div>\n          </div>\n        </section>\n      </div>\n    </main>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted } from \"vue\";\nimport axios from \"axios\";\n\n// baseURL API Golang\nconst api = axios.create({\n  baseURL: \"http://localhost:8081/api/v1\",\n  headers: {\n    Authorization: \"Bearer \" + localStorage.getItem(\"token\"), // ambil token JWT dari localStorage\n  },\n});\n\n// state\nconst products = ref([]);\nconst cart = ref([]);\nconst search = ref(\"\");\nconst selectedCategory = ref(\"All\");\nconst categories = ref([]);\n\n// load products dari API\nonMounted(async () => {\n  try {\n    const res = await api.get(\"/products\");\n    products.value = res.data.data; // sesuaikan dengan struktur response\n    // ambil distinct kategori dari API\n    categories.value = [...new Set(products.value.map(p => p.category.name))];\n  } catch (err) {\n    console.error(\"Gagal load produk\", err);\n  }\n});\n\n// computed untuk filter & search\nconst filteredProducts = computed(() => {\n  return products.value.filter(p => {\n    const matchCategory = selectedCategory.value === \"All\" || p.category.name === selectedCategory.value;\n    const matchSearch = p.name.toLowerCase().includes(search.value.toLowerCase());\n    return matchCategory && matchSearch;\n  });\n});\n\n// add to cart\nconst addToCart = (product) => {\n  const exist = cart.value.find(item => item.id === product.id);\n  if (exist) {\n    if (exist.qty < product.stock) {\n      exist.qty++;\n    }\n  } else {\n    cart.value.push({ ...product, qty: 1 });\n  }\n};\n\n// remove item\nconst removeFromCart = (i) => cart.value.splice(i, 1);\n\n// format\nconst formatCurrency = (num) => new Intl.NumberFormat(\"id-ID\", { style: \"currency\", currency: \"IDR\" }).format(num);\n\n// total\nconst totalAmount = computed(() =>\n  cart.value.reduce((sum, item) => sum + item.sell_price * item.qty, 0)\n);\n\n// checkout (POST ke Go)\nconst checkout = async () => {\n  if (cart.value.length === 0) return alert(\"Cart kosong\");\n\n  try {\n    const payload = {\n      customer_id: 1, // sementara hardcode, bisa ambil dari input user\n      date: new Date(),\n      items: cart.value.map(item => ({\n        product_id: item.id,\n        qty: item.qty,\n        price: item.sell_price,\n      })),\n    };\n\n    const res = await api.post(\"/kasir/sales\", payload);\n    alert(\"Transaksi berhasil dibuat!\");\n    cart.value = [];\n  } catch (err) {\n    console.error(\"Checkout gagal\", err);\n    alert(\"Checkout gagal: \" + err.response?.data?.error || err.message);\n  }\n};\n</script>\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}