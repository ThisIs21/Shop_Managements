{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport { ref, onMounted } from \"vue\";\nimport axios from \"axios\";\nimport KepalaGudangSidebar from \"@/components/KepalaGudangSidebar.vue\";\nexport default {\n  __name: 'PurchaseOrderKepalaGudang',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const purchases = ref([]);\n    const token = localStorage.getItem(\"token\"); // ambil token login\n\n    const fetchPurchases = async () => {\n      try {\n        const res = await axios.get(\"http://localhost:8081/history/purchases\", {\n          params: {\n            page: 1,\n            size: 20,\n            q: \"\"\n          },\n          // backend kamu support paging & search\n          headers: {\n            Authorization: `Bearer ${token}` // kirim token ke backend\n          }\n        });\n        purchases.value = res.data.data || []; // simpan hasil response ke state\n      } catch (err) {\n        console.error(\"Failed to fetch purchases:\", err);\n      }\n    };\n    const approvePO = async id => {\n      try {\n        await axios.post(`/purchases/${id}/approve`, {}, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        purchases.value = purchases.value.filter(po => po.id !== id);\n      } catch (err) {\n        console.error(\"Failed to approve:\", err);\n      }\n    };\n    const rejectPO = async id => {\n      try {\n        await axios.post(`/purchases/${id}/reject`, {}, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        purchases.value = purchases.value.filter(po => po.id !== id);\n      } catch (err) {\n        console.error(\"Failed to reject:\", err);\n      }\n    };\n    const formatDate = dateStr => new Date(dateStr).toLocaleDateString();\n    const formatCurrency = val => {\n      if (!val) return \"-\";\n      return new Intl.NumberFormat(\"en-US\", {\n        style: \"currency\",\n        currency: \"USD\"\n      }).format(val);\n    };\n    onMounted(() => {\n      fetchPurchases();\n    });\n    const __returned__ = {\n      purchases,\n      token,\n      fetchPurchases,\n      approvePO,\n      rejectPO,\n      formatDate,\n      formatCurrency,\n      ref,\n      onMounted,\n      get axios() {\n        return axios;\n      },\n      KepalaGudangSidebar\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","axios","KepalaGudangSidebar","purchases","token","localStorage","getItem","fetchPurchases","res","get","params","page","size","q","headers","Authorization","value","data","err","console","error","approvePO","id","post","filter","po","rejectPO","formatDate","dateStr","Date","toLocaleDateString","formatCurrency","val","Intl","NumberFormat","style","currency","format"],"sources":["C:/Users/Personal/Documents/PKL/aplikasi/aplikasi/src/views/PurchaseOrderKepalaGudang.vue"],"sourcesContent":["<template>\n  <div\n    class=\"flex size-full min-h-screen flex-col bg-white font-manrope lg:flex-row\"\n  >\n    <KepalaGudangSidebar />\n\n    <div class=\"flex flex-1 flex-col\">\n      <main class=\"flex-1 p-8\">\n        <div class=\"layout-content-container flex flex-col flex-1\">\n          <div class=\"mb-6\">\n            <p\n              class=\"text-[#111418] tracking-light text-[32px] font-bold leading-tight\"\n            >\n              Purchase Orders Pending Approval\n            </p>\n          </div>\n\n          <div class=\"px-4 py-3 @container\">\n            <div\n              class=\"flex overflow-hidden rounded-lg border border-[#dbe0e6] bg-white\"\n            >\n              <table class=\"flex-1\">\n                <thead>\n                  <tr class=\"bg-white\">\n                    <th\n                      class=\"px-4 py-3 text-left text-[#111418] text-sm font-medium\"\n                    >\n                      PO Number\n                    </th>\n                    <th\n                      class=\"px-4 py-3 text-left text-[#111418] text-sm font-medium\"\n                    >\n                      Supplier\n                    </th>\n                    <th\n                      class=\"px-4 py-3 text-left text-[#111418] text-sm font-medium\"\n                    >\n                      Date\n                    </th>\n                    <th\n                      class=\"px-4 py-3 text-left text-[#111418] text-sm font-medium\"\n                    >\n                      Total\n                    </th>\n                    <th\n                      class=\"px-4 py-3 text-left text-[#60758a] text-sm font-medium\"\n                    >\n                      Action\n                    </th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <tr\n                    v-for=\"po in purchases\"\n                    :key=\"po.id\"\n                    class=\"border-t border-t-[#dbe0e6]\"\n                  >\n                    <td class=\"h-[72px] px-4 py-2 text-[#111418] text-sm\">\n                      {{ po.po_number }}\n                    </td>\n                    <td class=\"h-[72px] px-4 py-2 text-[#60758a] text-sm\">\n                      {{ po.supplier_name }}\n                    </td>\n                    <td class=\"h-[72px] px-4 py-2 text-[#60758a] text-sm\">\n                      {{ formatDate(po.date) }}\n                    </td>\n                    <td class=\"h-[72px] px-4 py-2 text-[#60758a] text-sm\">\n                      {{ formatCurrency(po.total) }}\n                    </td>\n                    <td class=\"h-[72px] px-4 py-2 text-sm font-bold flex gap-2\">\n                      <button\n                        @click=\"approvePO(po.id)\"\n                        class=\"px-3 py-1 rounded bg-green-500 text-white hover:bg-green-600\"\n                      >\n                        Approve\n                      </button>\n                      <button\n                        @click=\"rejectPO(po.id)\"\n                        class=\"px-3 py-1 rounded bg-red-500 text-white hover:bg-red-600\"\n                      >\n                        Reject\n                      </button>\n                    </td>\n                  </tr>\n                  <tr v-if=\"purchases.length === 0\">\n                    <td\n                      colspan=\"5\"\n                      class=\"text-center py-4 text-[#60758a] text-sm\"\n                    >\n                      No pending purchase orders\n                    </td>\n                  </tr>\n                </tbody>\n              </table>\n            </div>\n          </div>\n        </div>\n      </main>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, onMounted } from \"vue\";\nimport axios from \"axios\";\nimport KepalaGudangSidebar from \"@/components/KepalaGudangSidebar.vue\";\n\nconst purchases = ref([]);\nconst token = localStorage.getItem(\"token\"); // ambil token login\n\nconst fetchPurchases = async () => {\n  try {\n    const res = await axios.get(\"http://localhost:8081/history/purchases\", {\n      params: { page: 1, size: 20, q: \"\" }, // backend kamu support paging & search\n      headers: {\n        Authorization: `Bearer ${token}`, // kirim token ke backend\n      },\n    });\n    purchases.value = res.data.data || []; // simpan hasil response ke state\n  } catch (err) {\n    console.error(\"Failed to fetch purchases:\", err);\n  }\n};\n\nconst approvePO = async (id) => {\n  try {\n    await axios.post(\n      `/purchases/${id}/approve`,\n      {},\n      {\n        headers: { Authorization: `Bearer ${token}` },\n      }\n    );\n    purchases.value = purchases.value.filter((po) => po.id !== id);\n  } catch (err) {\n    console.error(\"Failed to approve:\", err);\n  }\n};\n\nconst rejectPO = async (id) => {\n  try {\n    await axios.post(\n      `/purchases/${id}/reject`,\n      {},\n      {\n        headers: { Authorization: `Bearer ${token}` },\n      }\n    );\n    purchases.value = purchases.value.filter((po) => po.id !== id);\n  } catch (err) {\n    console.error(\"Failed to reject:\", err);\n  }\n};\n\nconst formatDate = (dateStr) => new Date(dateStr).toLocaleDateString();\n\nconst formatCurrency = (val) => {\n  if (!val) return \"-\";\n  return new Intl.NumberFormat(\"en-US\", {\n    style: \"currency\",\n    currency: \"USD\",\n  }).format(val);\n};\n\nonMounted(() => {\n  fetchPurchases();\n});\n</script>\n"],"mappings":";;AAuGA,SAASA,GAAG,EAAEC,SAAS,QAAQ,KAAK;AACpC,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAOC,mBAAmB,MAAM,sCAAsC;;;;;;;IAEtE,MAAMC,SAAS,GAAGJ,GAAG,CAAC,EAAE,CAAC;IACzB,MAAMK,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC;;IAE7C,MAAMC,cAAc,GAAG,MAAAA,CAAA,KAAY;MACjC,IAAI;QACF,MAAMC,GAAG,GAAG,MAAMP,KAAK,CAACQ,GAAG,CAAC,yCAAyC,EAAE;UACrEC,MAAM,EAAE;YAAEC,IAAI,EAAE,CAAC;YAAEC,IAAI,EAAE,EAAE;YAAEC,CAAC,EAAE;UAAG,CAAC;UAAE;UACtCC,OAAO,EAAE;YACPC,aAAa,EAAE,UAAUX,KAAK,EAAE,CAAE;UACpC;QACF,CAAC,CAAC;QACFD,SAAS,CAACa,KAAK,GAAGR,GAAG,CAACS,IAAI,CAACA,IAAI,IAAI,EAAE,CAAC,CAAC;MACzC,CAAC,CAAC,OAAOC,GAAG,EAAE;QACZC,OAAO,CAACC,KAAK,CAAC,4BAA4B,EAAEF,GAAG,CAAC;MAClD;IACF,CAAC;IAED,MAAMG,SAAS,GAAG,MAAOC,EAAE,IAAK;MAC9B,IAAI;QACF,MAAMrB,KAAK,CAACsB,IAAI,CACd,cAAcD,EAAE,UAAU,EAC1B,CAAC,CAAC,EACF;UACER,OAAO,EAAE;YAAEC,aAAa,EAAE,UAAUX,KAAK;UAAG;QAC9C,CACF,CAAC;QACDD,SAAS,CAACa,KAAK,GAAGb,SAAS,CAACa,KAAK,CAACQ,MAAM,CAAEC,EAAE,IAAKA,EAAE,CAACH,EAAE,KAAKA,EAAE,CAAC;MAChE,CAAC,CAAC,OAAOJ,GAAG,EAAE;QACZC,OAAO,CAACC,KAAK,CAAC,oBAAoB,EAAEF,GAAG,CAAC;MAC1C;IACF,CAAC;IAED,MAAMQ,QAAQ,GAAG,MAAOJ,EAAE,IAAK;MAC7B,IAAI;QACF,MAAMrB,KAAK,CAACsB,IAAI,CACd,cAAcD,EAAE,SAAS,EACzB,CAAC,CAAC,EACF;UACER,OAAO,EAAE;YAAEC,aAAa,EAAE,UAAUX,KAAK;UAAG;QAC9C,CACF,CAAC;QACDD,SAAS,CAACa,KAAK,GAAGb,SAAS,CAACa,KAAK,CAACQ,MAAM,CAAEC,EAAE,IAAKA,EAAE,CAACH,EAAE,KAAKA,EAAE,CAAC;MAChE,CAAC,CAAC,OAAOJ,GAAG,EAAE;QACZC,OAAO,CAACC,KAAK,CAAC,mBAAmB,EAAEF,GAAG,CAAC;MACzC;IACF,CAAC;IAED,MAAMS,UAAU,GAAIC,OAAO,IAAK,IAAIC,IAAI,CAACD,OAAO,CAAC,CAACE,kBAAkB,CAAC,CAAC;IAEtE,MAAMC,cAAc,GAAIC,GAAG,IAAK;MAC9B,IAAI,CAACA,GAAG,EAAE,OAAO,GAAG;MACpB,OAAO,IAAIC,IAAI,CAACC,YAAY,CAAC,OAAO,EAAE;QACpCC,KAAK,EAAE,UAAU;QACjBC,QAAQ,EAAE;MACZ,CAAC,CAAC,CAACC,MAAM,CAACL,GAAG,CAAC;IAChB,CAAC;IAEDhC,SAAS,CAAC,MAAM;MACdO,cAAc,CAAC,CAAC;IAClB,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}