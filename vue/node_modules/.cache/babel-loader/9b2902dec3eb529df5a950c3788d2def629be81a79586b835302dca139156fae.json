{"ast":null,"code":"import axios from \"axios\";\nimport KepalaGudangSidebar from \"@/components/KepalaGudangSidebar.vue\";\nexport default {\n  name: \"ProductCatalogKepalaGudang\",\n  components: {\n    KepalaGudangSidebar\n  },\n  data() {\n    return {\n      showForm: false,\n      products: [],\n      categories: [],\n      newProduct: {\n        name: \"\",\n        cost_price: null,\n        // backend expects cost_price\n        sell_price: null,\n        // backend expects sell_price\n        stock: null,\n        selectedCategoryIndex: \"\"\n      },\n      api: axios.create({\n        baseURL: \"http://localhost:8081/api/v1\",\n        timeout: 10000,\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem(\"token\") || \"\"}`\n        }\n      })\n    };\n  },\n  methods: {\n    async fetchProducts() {\n      try {\n        const res = await this.api.get(\"/products\");\n        this.products = Array.isArray(res.data) ? res.data : res.data.data ?? [];\n      } catch (err) {\n        console.error(\"Gagal ambil produk:\", err.response?.data ?? err.message);\n        this.products = [];\n      }\n    },\n    async fetchCategories() {\n      try {\n        const res = await this.api.get(\"/categories\");\n        this.categories = Array.isArray(res.data) ? res.data : res.data.data ?? [];\n      } catch (err) {\n        console.error(\"Gagal ambil kategori:\", err.response?.data ?? err.message);\n        this.categories = [];\n      }\n    },\n    buildPayloadForBackend() {\n      const payload = {\n        name: this.newProduct.name,\n        cost_price: Number(this.newProduct.cost_price),\n        sell_price: Number(this.newProduct.sell_price),\n        stock: Number(this.newProduct.stock)\n      };\n      const idx = this.newProduct.selectedCategoryIndex;\n      if (idx !== \"\" && this.categories[idx] !== undefined) {\n        const cat = this.categories[idx];\n        if (cat && typeof cat === \"object\") {\n          if (cat.id !== undefined) payload.category_id = cat.id;\n          if (cat.name !== undefined) payload.category = cat.name;\n        } else {\n          payload.category = cat;\n        }\n      }\n      return payload;\n    },\n    async addProduct() {\n      try {\n        const payload = this.buildPayloadForBackend();\n        const res = await this.api.post(\"/owner/products\", payload);\n        console.log(\"Create product response:\", res.data);\n        this.newProduct = {\n          name: \"\",\n          cost_price: null,\n          sell_price: null,\n          stock: null,\n          selectedCategoryIndex: \"\"\n        };\n        this.showForm = false;\n        await this.fetchProducts();\n        alert(\"Produk berhasil ditambahkan.\");\n      } catch (err) {\n        console.error(\"Gagal tambah produk:\", err.response?.data ?? err.message);\n        alert(\"Gagal simpan produk: \" + (err.response?.data?.message ?? err.message ?? \"Unknown error\"));\n      }\n    },\n    formatPrice(value) {\n      if (value == null || isNaN(value)) return \"0\";\n      return new Intl.NumberFormat(\"id-ID\").format(value);\n    }\n  },\n  mounted() {\n    this.fetchCategories();\n    this.fetchProducts();\n  }\n};","map":{"version":3,"names":["axios","KepalaGudangSidebar","name","components","data","showForm","products","categories","newProduct","cost_price","sell_price","stock","selectedCategoryIndex","api","create","baseURL","timeout","headers","Authorization","localStorage","getItem","methods","fetchProducts","res","get","Array","isArray","err","console","error","response","message","fetchCategories","buildPayloadForBackend","payload","Number","idx","undefined","cat","id","category_id","category","addProduct","post","log","alert","formatPrice","value","isNaN","Intl","NumberFormat","format","mounted"],"sources":["C:\\Users\\Personal\\Documents\\PKL\\aplikasi\\aplikasi\\src\\views\\ProductCatalogKepalaGudang.vue"],"sourcesContent":["<template>\n  <div class=\"flex h-screen bg-gray-100\">\n    <!-- Sidebar (tidak diubah) -->\n    <KepalaGudangSidebar />\n\n    <!-- Main Content -->\n    <div class=\"flex-1 flex flex-col\">\n      <!-- Header -->\n      <header class=\"bg-white shadow p-4 flex justify-between items-center\">\n        <h1 class=\"text-2xl font-bold\">Product Catalog - Kepala Gudang</h1>\n      </header>\n\n      <!-- Content -->\n      <main class=\"p-6 flex-1 overflow-y-auto\">\n        <!-- Tombol Tambah Produk -->\n        <div class=\"flex justify-end mb-4\">\n          <button\n            @click=\"showForm = !showForm\"\n            class=\"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700\"\n          >\n            {{ showForm ? \"Tutup Form\" : \"Tambah Produk\" }}\n          </button>\n        </div>\n\n        <!-- Form Tambah Produk -->\n        <section\n          v-if=\"showForm\"\n          class=\"mb-8 border rounded p-4 bg-white shadow\"\n        >\n          <h2 class=\"text-xl font-semibold mb-4\">Tambah Produk</h2>\n\n          <form\n            @submit.prevent=\"addProduct\"\n            class=\"grid grid-cols-1 md:grid-cols-2 gap-4\"\n          >\n            <div>\n              <label class=\"block text-sm font-medium mb-1\">Nama Produk</label>\n              <input\n                v-model=\"newProduct.name\"\n                type=\"text\"\n                class=\"w-full border rounded p-2 bg-gray-800 text-white\"\n                required\n              />\n            </div>\n\n            <div>\n              <label class=\"block text-sm font-medium mb-1\">Harga Beli</label>\n              <input\n                v-model.number=\"newProduct.cost_price\"\n                type=\"number\"\n                min=\"0\"\n                class=\"w-full border rounded p-2 bg-gray-800 text-white\"\n                required\n              />\n            </div>\n\n            <div>\n              <label class=\"block text-sm font-medium mb-1\">Harga Jual</label>\n              <input\n                v-model.number=\"newProduct.sell_price\"\n                type=\"number\"\n                min=\"0\"\n                class=\"w-full border rounded p-2 bg-gray-800 text-white\"\n                required\n              />\n            </div>\n\n            <div>\n              <label class=\"block text-sm font-medium mb-1\">Kategori</label>\n              <select\n                v-model=\"newProduct.selectedCategoryIndex\"\n                class=\"w-full border rounded p-2 bg-gray-800 text-white\"\n                required\n              >\n                <option value=\"\" disabled>Pilih Kategori</option>\n                <option\n                  v-for=\"(cat, idx) in categories\"\n                  :key=\"cat.id ?? cat.name\"\n                  :value=\"idx\"\n                >\n                  {{ cat.name ?? cat }}\n                </option>\n              </select>\n            </div>\n\n            <div>\n              <label class=\"block text-sm font-medium mb-1\">Stok</label>\n              <input\n                v-model.number=\"newProduct.stock\"\n                type=\"number\"\n                min=\"0\"\n                class=\"w-full border rounded p-2 bg-gray-800 text-white\"\n                required\n              />\n            </div>\n\n            <div class=\"md:col-span-2\">\n              <button\n                type=\"submit\"\n                class=\"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700\"\n              >\n                Simpan Produk\n              </button>\n            </div>\n          </form>\n        </section>\n\n        <!-- Daftar Produk -->\n        <section>\n          <h2 class=\"text-xl font-semibold mb-4\">Daftar Produk</h2>\n\n          <div class=\"overflow-x-auto bg-white p-4 rounded shadow\">\n            <table class=\"w-full border-collapse text-sm\">\n              <thead class=\"bg-gray-100\">\n                <tr>\n                  <th class=\"border p-2 text-left\">Nama</th>\n                  <th class=\"border p-2 text-left\">Kategori</th>\n                  <th class=\"border p-2 text-right\">Harga Beli</th>\n                  <th class=\"border p-2 text-right\">Harga Jual</th>\n                  <th class=\"border p-2 text-right\">Stok</th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr v-for=\"prod in products\" :key=\"prod.id\">\n                  <td class=\"border p-2\">{{ prod.name }}</td>\n                  <td class=\"border p-2\">\n                    {{ prod.category?.name ?? prod.category ?? \"-\" }}\n                  </td>\n                  <td class=\"border p-2 text-right\">\n                    {{\n                      prod.cost_price != null\n                        ? \"Rp \" + formatPrice(prod.cost_price)\n                        : \"-\"\n                    }}\n                  </td>\n                  <td class=\"border p-2 text-right\">\n                    {{\n                      prod.sell_price != null\n                        ? \"Rp \" + formatPrice(prod.sell_price)\n                        : \"-\"\n                    }}\n                  </td>\n                  <td class=\"border p-2 text-right\">{{ prod.stock ?? \"-\" }}</td>\n                </tr>\n\n                <tr v-if=\"products.length === 0\">\n                  <td class=\"text-center p-4\" colspan=\"5\">\n                    No products available\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </section>\n      </main>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport KepalaGudangSidebar from \"@/components/KepalaGudangSidebar.vue\";\n\nexport default {\n  name: \"ProductCatalogKepalaGudang\",\n  components: { KepalaGudangSidebar },\n  data() {\n    return {\n      showForm: false,\n      products: [],\n      categories: [],\n      newProduct: {\n        name: \"\",\n        cost_price: null,   // backend expects cost_price\n        sell_price: null,   // backend expects sell_price\n        stock: null,\n        selectedCategoryIndex: \"\",\n      },\n      api: axios.create({\n        baseURL: \"http://localhost:8081/api/v1\",\n        timeout: 10000,\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem(\"token\") || \"\"}`,\n        },\n      }),\n    };\n  },\n  methods: {\n    async fetchProducts() {\n      try {\n        const res = await this.api.get(\"/products\");\n        this.products = Array.isArray(res.data)\n          ? res.data\n          : res.data.data ?? [];\n      } catch (err) {\n        console.error(\"Gagal ambil produk:\", err.response?.data ?? err.message);\n        this.products = [];\n      }\n    },\n    async fetchCategories() {\n      try {\n        const res = await this.api.get(\"/categories\");\n        this.categories = Array.isArray(res.data)\n          ? res.data\n          : res.data.data ?? [];\n      } catch (err) {\n        console.error(\"Gagal ambil kategori:\", err.response?.data ?? err.message);\n        this.categories = [];\n      }\n    },\n    buildPayloadForBackend() {\n      const payload = {\n        name: this.newProduct.name,\n        cost_price: Number(this.newProduct.cost_price),\n        sell_price: Number(this.newProduct.sell_price),\n        stock: Number(this.newProduct.stock),\n      };\n\n      const idx = this.newProduct.selectedCategoryIndex;\n      if (idx !== \"\" && this.categories[idx] !== undefined) {\n        const cat = this.categories[idx];\n        if (cat && typeof cat === \"object\") {\n          if (cat.id !== undefined) payload.category_id = cat.id;\n          if (cat.name !== undefined) payload.category = cat.name;\n        } else {\n          payload.category = cat;\n        }\n      }\n      return payload;\n    },\n    async addProduct() {\n      try {\n        const payload = this.buildPayloadForBackend();\n        const res = await this.api.post(\"/owner/products\", payload);\n\n        console.log(\"Create product response:\", res.data);\n\n        this.newProduct = {\n          name: \"\",\n          cost_price: null,\n          sell_price: null,\n          stock: null,\n          selectedCategoryIndex: \"\",\n        };\n        this.showForm = false;\n        await this.fetchProducts();\n        alert(\"Produk berhasil ditambahkan.\");\n      } catch (err) {\n        console.error(\"Gagal tambah produk:\", err.response?.data ?? err.message);\n        alert(\n          \"Gagal simpan produk: \" +\n            (err.response?.data?.message ?? err.message ?? \"Unknown error\")\n        );\n      }\n    },\n    formatPrice(value) {\n      if (value == null || isNaN(value)) return \"0\";\n      return new Intl.NumberFormat(\"id-ID\").format(value);\n    },\n  },\n  mounted() {\n    this.fetchCategories();\n    this.fetchProducts();\n  },\n};\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}