{"ast":null,"code":"import { ref, onMounted, computed, watch } from \"vue\";\nimport axios from \"axios\";\nimport OwnerLayouts from \"../components/OwnerLayouts.vue\";\nexport default {\n  __name: 'ManagementVoucherOwner',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const vouchers = ref([]);\n    const loading = ref(true);\n    const showModal = ref(false);\n    const isEditMode = ref(false);\n    const formData = ref({\n      id: null,\n      code: \"\",\n      type: \"PERCENT\",\n      value: 0,\n      active: true\n    });\n    // Pagination\n    const vouchersAll = ref([]);\n    const page = ref(1);\n    const perPage = ref(10);\n    const totalPages = computed(() => Math.max(1, Math.ceil((vouchersAll.value || []).length / perPage.value)));\n    const updatePagination = () => {\n      const start = (page.value - 1) * perPage.value;\n      vouchers.value = vouchersAll.value.slice(start, start + perPage.value);\n    };\n    const fetchVouchers = async () => {\n      try {\n        const token = localStorage.getItem(\"token\");\n        const res = await axios.get(\"http://localhost:8081/api/v1/vouchers\", {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        vouchersAll.value = res.data.data || [];\n        page.value = 1;\n        updatePagination();\n      } catch (err) {\n        console.error(\"Error fetching vouchers:\", err);\n      } finally {\n        loading.value = false;\n      }\n    };\n    const openCreateModal = () => {\n      isEditMode.value = false;\n      formData.value = {\n        id: null,\n        code: \"\",\n        type: \"PERCENT\",\n        value: 0,\n        active: true\n      };\n      showModal.value = true;\n    };\n    const openEditModal = voucher => {\n      isEditMode.value = true;\n      formData.value = {\n        id: voucher.ID,\n        code: voucher.Code,\n        type: voucher.Type,\n        value: voucher.Value,\n        active: voucher.Active\n      };\n      showModal.value = true;\n    };\n    const closeModal = () => {\n      showModal.value = false;\n    };\n    const submitForm = async () => {\n      try {\n        const token = localStorage.getItem(\"token\");\n        const url = isEditMode.value ? `http://localhost:8081/api/v1/owner/vouchers/${formData.value.id}` : \"http://localhost:8081/api/v1/owner/vouchers\";\n        const method = isEditMode.value ? \"put\" : \"post\";\n        const payload = {\n          code: formData.value.code,\n          type: formData.value.type,\n          value: formData.value.value,\n          active: formData.value.active\n        };\n        await axios({\n          method,\n          url,\n          data: payload,\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        fetchVouchers();\n        closeModal();\n      } catch (err) {\n        console.error(\"Error saving voucher:\", err);\n      }\n    };\n    const confirmDelete = async id => {\n      if (!confirm(\"Are you sure want to delete this voucher?\")) return;\n      try {\n        const token = localStorage.getItem(\"token\");\n        await axios.delete(`http://localhost:8081/api/v1/owner/vouchers/${id}`, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        fetchVouchers();\n      } catch (err) {\n        console.error(\"Error deleting voucher:\", err);\n      }\n    };\n    onMounted(() => {\n      fetchVouchers();\n    });\n    watch([page, perPage], () => updatePagination());\n    const __returned__ = {\n      vouchers,\n      loading,\n      showModal,\n      isEditMode,\n      formData,\n      vouchersAll,\n      page,\n      perPage,\n      totalPages,\n      updatePagination,\n      fetchVouchers,\n      openCreateModal,\n      openEditModal,\n      closeModal,\n      submitForm,\n      confirmDelete,\n      ref,\n      onMounted,\n      computed,\n      watch,\n      get axios() {\n        return axios;\n      },\n      OwnerLayouts\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","computed","watch","axios","OwnerLayouts","vouchers","loading","showModal","isEditMode","formData","id","code","type","value","active","vouchersAll","page","perPage","totalPages","Math","max","ceil","length","updatePagination","start","slice","fetchVouchers","token","localStorage","getItem","res","get","headers","Authorization","data","err","console","error","openCreateModal","openEditModal","voucher","ID","Code","Type","Value","Active","closeModal","submitForm","url","method","payload","confirmDelete","confirm","delete"],"sources":["C:/Users/Personal/Documents/PKL/PKL Shop Managements/vue/src/views/ManagementVoucherOwner.vue"],"sourcesContent":["<template>\n  <OwnerLayouts>\n    <div class=\"flex flex-1 justify-center py-5\">\n      <div class=\"layout-content-container flex flex-col max-w-[960px] flex-1\">\n        <!-- Title -->\n        <div class=\"flex flex-wrap justify-between gap-3 p-4\">\n          <p\n            class=\"text-[#111418] tracking-light text-[32px] font-bold leading-tight min-w-72\"\n          >\n            Management Voucher\n          </p>\n          <button\n            @click=\"openCreateModal\"\n            class=\"flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-8 px-4 bg-[#f0f2f5] text-[#111418] text-sm font-medium leading-normal\"\n          >\n            <span class=\"truncate\">Add Voucher</span>\n          </button>\n        </div>\n\n        <!-- Table -->\n        <div class=\"px-4 py-3\">\n          <div\n            class=\"flex overflow-hidden rounded-lg border border-[#dbe0e6] bg-white\"\n          >\n            <table class=\"flex-1\">\n              <thead>\n                <tr class=\"bg-white\">\n                  <th class=\"px-4 py-3 text-left text-sm font-medium\">ID</th>\n                  <th class=\"px-4 py-3 text-left text-sm font-medium\">Code</th>\n                  <th class=\"px-4 py-3 text-left text-sm font-medium\">Type</th>\n                  <th class=\"px-4 py-3 text-left text-sm font-medium\">Value</th>\n                  <th class=\"px-4 py-3 text-left text-sm font-medium\">\n                    Active\n                  </th>\n                  <th class=\"px-4 py-3 text-left text-sm font-medium\">\n                    Actions\n                  </th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr v-if=\"loading\" class=\"border-t\">\n                  <td\n                    colspan=\"6\"\n                    class=\"h-[72px] text-center text-sm text-[#60758a]\"\n                  >\n                    Loading...\n                  </td>\n                </tr>\n                <tr v-else-if=\"vouchers.length === 0\" class=\"border-t\">\n                  <td\n                    colspan=\"6\"\n                    class=\"h-[72px] text-center text-sm text-[#60758a]\"\n                  >\n                    No vouchers found.\n                  </td>\n                </tr>\n                <tr\n                  v-for=\"voucher in vouchers\"\n                  :key=\"voucher.ID\"\n                  class=\"border-t\"\n                >\n                  <td class=\"px-4 py-2 text-sm\">{{ voucher.ID }}</td>\n                  <td class=\"px-4 py-2 text-sm\">{{ voucher.Code }}</td>\n                  <td class=\"px-4 py-2 text-sm\">{{ voucher.Type }}</td>\n                  <td class=\"px-4 py-2 text-sm\">{{ voucher.Value }}</td>\n                  <td class=\"px-4 py-2 text-sm\">\n                    <span\n                      :class=\"\n                        voucher.Active ? 'text-green-600' : 'text-red-600'\n                      \"\n                    >\n                      {{ voucher.Active ? \"Active\" : \"Inactive\" }}\n                    </span>\n                  </td>\n                  <td class=\"px-4 py-2 text-sm font-bold text-[#60758a]\">\n                    <span\n                      class=\"text-blue-500 hover:underline cursor-pointer\"\n                      @click=\"openEditModal(voucher)\"\n                      >Edit</span\n                    >\n                    /\n                    <span\n                      class=\"text-red-500 hover:underline cursor-pointer\"\n                      @click=\"confirmDelete(voucher.ID)\"\n                      >Delete</span\n                    >\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n\n        <!-- Modal -->\n        <div\n          v-if=\"showModal\"\n          class=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\"\n        >\n          <div class=\"bg-white rounded-lg p-6 w-full max-w-md\">\n            <h2 class=\"text-xl font-bold mb-4\">\n              {{ isEditMode ? \"Edit Voucher\" : \"Create Voucher\" }}\n            </h2>\n            <form @submit.prevent=\"submitForm\">\n              <!-- Code -->\n              <div class=\"mb-4\">\n                <label class=\"block text-sm font-medium mb-1\">Code</label>\n                <input\n                  v-model=\"formData.code\"\n                  type=\"text\"\n                  class=\"w-full rounded-lg border border-[#dbe0e6] p-2 text-sm\"\n                  placeholder=\"Enter voucher code\"\n                  required\n                />\n              </div>\n\n              <!-- Type -->\n              <div class=\"mb-4\">\n                <label class=\"block text-sm font-medium mb-1\">Type</label>\n                <select\n                  v-model=\"formData.type\"\n                  class=\"w-full rounded-lg border border-[#dbe0e6] p-2 text-sm\"\n                  required\n                >\n                  <option value=\"PERCENT\">PERCENT</option>\n                  <option value=\"AMOUNT\">AMOUNT</option>\n                </select>\n              </div>\n\n              <!-- Value -->\n              <div class=\"mb-4\">\n                <label class=\"block text-sm font-medium mb-1\">Value</label>\n                <input\n                  v-model.number=\"formData.value\"\n                  type=\"number\"\n                  class=\"w-full rounded-lg border border-[#dbe0e6] p-2 text-sm\"\n                  placeholder=\"Enter voucher value\"\n                  required\n                />\n              </div>\n\n              <!-- Active -->\n              <div class=\"mb-4\">\n                <label class=\"block text-sm font-medium mb-1\">Active</label>\n                <select\n                  v-model=\"formData.active\"\n                  class=\"w-full rounded-lg border border-[#dbe0e6] p-2 text-sm\"\n                >\n                  <option :value=\"true\">Active</option>\n                  <option :value=\"false\">Inactive</option>\n                </select>\n              </div>\n\n              <!-- Buttons -->\n              <div class=\"flex justify-end gap-3\">\n                <button\n                  type=\"button\"\n                  @click=\"closeModal\"\n                  class=\"px-4 py-2 bg-gray-200 text-sm rounded-lg\"\n                >\n                  Cancel\n                </button>\n                <button\n                  type=\"submit\"\n                  class=\"px-4 py-2 bg-blue-500 text-white text-sm rounded-lg\"\n                >\n                  {{ isEditMode ? \"Update\" : \"Create\" }}\n                </button>\n              </div>\n            </form>\n          </div>\n        </div>\n      </div>\n    </div>\n  </OwnerLayouts>\n</template>\n\n<script setup>\nimport { ref, onMounted, computed, watch } from \"vue\";\nimport axios from \"axios\";\nimport OwnerLayouts from \"../components/OwnerLayouts.vue\";\n\nconst vouchers = ref([]);\nconst loading = ref(true);\nconst showModal = ref(false);\nconst isEditMode = ref(false);\nconst formData = ref({\n  id: null,\n  code: \"\",\n  type: \"PERCENT\",\n  value: 0,\n  active: true,\n});\n// Pagination\nconst vouchersAll = ref([]);\nconst page = ref(1);\nconst perPage = ref(10);\nconst totalPages = computed(() => Math.max(1, Math.ceil((vouchersAll.value || []).length / perPage.value)));\n\nconst updatePagination = () => {\n  const start = (page.value - 1) * perPage.value;\n  vouchers.value = vouchersAll.value.slice(start, start + perPage.value);\n};\n\nconst fetchVouchers = async () => {\n  try {\n    const token = localStorage.getItem(\"token\");\n    const res = await axios.get(\"http://localhost:8081/api/v1/vouchers\", {\n      headers: { Authorization: `Bearer ${token}` },\n    });\n    vouchersAll.value = res.data.data || [];\n    page.value = 1;\n    updatePagination();\n  } catch (err) {\n    console.error(\"Error fetching vouchers:\", err);\n  } finally {\n    loading.value = false;\n  }\n};\n\nconst openCreateModal = () => {\n  isEditMode.value = false;\n  formData.value = {\n    id: null,\n    code: \"\",\n    type: \"PERCENT\",\n    value: 0,\n    active: true,\n  };\n  showModal.value = true;\n};\n\nconst openEditModal = (voucher) => {\n  isEditMode.value = true;\n  formData.value = {\n    id: voucher.ID,\n    code: voucher.Code,\n    type: voucher.Type,\n    value: voucher.Value,\n    active: voucher.Active,\n  };\n  showModal.value = true;\n};\n\nconst closeModal = () => {\n  showModal.value = false;\n};\n\nconst submitForm = async () => {\n  try {\n    const token = localStorage.getItem(\"token\");\n    const url = isEditMode.value\n      ? `http://localhost:8081/api/v1/owner/vouchers/${formData.value.id}`\n      : \"http://localhost:8081/api/v1/owner/vouchers\";\n    const method = isEditMode.value ? \"put\" : \"post\";\n    const payload = {\n      code: formData.value.code,\n      type: formData.value.type,\n      value: formData.value.value,\n      active: formData.value.active,\n    };\n    await axios({\n      method,\n      url,\n      data: payload,\n      headers: { Authorization: `Bearer ${token}` },\n    });\n    fetchVouchers();\n    closeModal();\n  } catch (err) {\n    console.error(\"Error saving voucher:\", err);\n  }\n};\n\nconst confirmDelete = async (id) => {\n  if (!confirm(\"Are you sure want to delete this voucher?\")) return;\n  try {\n    const token = localStorage.getItem(\"token\");\n    await axios.delete(`http://localhost:8081/api/v1/owner/vouchers/${id}`, {\n      headers: { Authorization: `Bearer ${token}` },\n    });\n    fetchVouchers();\n  } catch (err) {\n    console.error(\"Error deleting voucher:\", err);\n  }\n};\n\nonMounted(() => {\n  fetchVouchers();\n});\n\nwatch([page, perPage], () => updatePagination());\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}