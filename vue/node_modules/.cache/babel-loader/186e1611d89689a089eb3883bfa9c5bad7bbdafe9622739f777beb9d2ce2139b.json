{"ast":null,"code":"import { ref, onMounted } from \"vue\";\nimport axios from \"axios\";\nimport KepalaGudangSidebar from \"@/components/KepalaGudangSidebar.vue\";\nexport default {\n  __name: 'PurchaseReturnKepalaGudang',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const purchaseReturns = ref([]);\n    const errorMessage = ref(\"\");\n    const loading = ref(true);\n    const fetchPurchaseReturns = async () => {\n      try {\n        const token = localStorage.getItem(\"token\");\n        if (!token) {\n          errorMessage.value = \"Token hilang, silakan login ulang.\";\n          loading.value = false;\n          return;\n        }\n        const response = await axios.get(\"http://localhost:8081/api/v1/history/purchase-returns?page=1&size=20&q=\", {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        purchaseReturns.value = response.data.data || [];\n      } catch (error) {\n        console.error(\"Gagal fetch data retur:\", error);\n\n        // Tangani error khusus dari backend\n        if (error.response && error.response.data?.error?.includes(\"Unknown column 'pr.reason'\")) {\n          errorMessage.value = \"Data tidak bisa ditampilkan (kolom 'reason' tidak ada di database).\";\n        } else {\n          errorMessage.value = error.response?.data?.error || \"Terjadi kesalahan server.\";\n        }\n      } finally {\n        loading.value = false;\n      }\n    };\n    onMounted(fetchPurchaseReturns);\n    const __returned__ = {\n      purchaseReturns,\n      errorMessage,\n      loading,\n      fetchPurchaseReturns,\n      ref,\n      onMounted,\n      get axios() {\n        return axios;\n      },\n      KepalaGudangSidebar\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","axios","KepalaGudangSidebar","purchaseReturns","errorMessage","loading","fetchPurchaseReturns","token","localStorage","getItem","value","response","get","headers","Authorization","data","error","console","includes"],"sources":["C:/Users/Personal/Documents/PKL/aplikasi/aplikasi/src/views/PurchaseReturnKepalaGudang.vue"],"sourcesContent":["<script setup>\nimport { ref, onMounted } from \"vue\";\nimport axios from \"axios\";\nimport KepalaGudangSidebar from \"@/components/KepalaGudangSidebar.vue\";\n\nconst purchaseReturns = ref([]);\nconst errorMessage = ref(\"\");\nconst loading = ref(true);\n\nconst fetchPurchaseReturns = async () => {\n  try {\n    const token = localStorage.getItem(\"token\");\n    if (!token) {\n      errorMessage.value = \"Token hilang, silakan login ulang.\";\n      loading.value = false;\n      return;\n    }\n\n    const response = await axios.get(\n      \"http://localhost:8081/api/v1/history/purchase-returns?page=1&size=20&q=\",\n      {\n        headers: { Authorization: `Bearer ${token}` },\n      }\n    );\n\n    purchaseReturns.value = response.data.data || [];\n  } catch (error) {\n    console.error(\"Gagal fetch data retur:\", error);\n\n    // Tangani error khusus dari backend\n    if (error.response && error.response.data?.error?.includes(\"Unknown column 'pr.reason'\")) {\n      errorMessage.value = \"Data tidak bisa ditampilkan (kolom 'reason' tidak ada di database).\";\n    } else {\n      errorMessage.value = error.response?.data?.error || \"Terjadi kesalahan server.\";\n    }\n  } finally {\n    loading.value = false;\n  }\n};\n\nonMounted(fetchPurchaseReturns);\n</script>\n\n<template>\n  <div class=\"flex\">\n    <KepalaGudangSidebar />\n    <main class=\"ml-64 flex-1 p-6 bg-gray-100 min-h-screen\">\n      <h1 class=\"text-2xl font-bold mb-4\">Purchase Return Requests</h1>\n\n      <div v-if=\"errorMessage\" class=\"bg-red-600 text-white p-3 rounded mb-4\">\n        {{ errorMessage }}\n      </div>\n\n      <table class=\"w-full border-collapse bg-white shadow rounded\">\n        <thead class=\"bg-gray-200\">\n          <tr>\n            <th class=\"p-2 border\">ID</th>\n            <th class=\"p-2 border\">Purchase ID</th>\n            <th class=\"p-2 border\">User ID</th>\n            <th class=\"p-2 border\">Total</th>\n            <th class=\"p-2 border\">Date</th>\n            <th class=\"p-2 border\">Status</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr v-if=\"!loading && purchaseReturns.length === 0\">\n            <td colspan=\"6\" class=\"text-center p-4 text-gray-500\">\n              Tidak ada data retur pembelian\n            </td>\n          </tr>\n          <tr v-for=\"pr in purchaseReturns\" :key=\"pr.id\">\n            <td class=\"p-2 border\">{{ pr.id }}</td>\n            <td class=\"p-2 border\">{{ pr.purchase_id }}</td>\n            <td class=\"p-2 border\">{{ pr.user_id }}</td>\n            <td class=\"p-2 border\">{{ pr.total }}</td>\n            <td class=\"p-2 border\">{{ pr.date }}</td>\n            <td class=\"p-2 border\">{{ pr.status }}</td>\n          </tr>\n        </tbody>\n      </table>\n    </main>\n  </div>\n</template>\n"],"mappings":"AACA,SAASA,GAAG,EAAEC,SAAS,QAAQ,KAAK;AACpC,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAOC,mBAAmB,MAAM,sCAAsC;;;;;;;IAEtE,MAAMC,eAAe,GAAGJ,GAAG,CAAC,EAAE,CAAC;IAC/B,MAAMK,YAAY,GAAGL,GAAG,CAAC,EAAE,CAAC;IAC5B,MAAMM,OAAO,GAAGN,GAAG,CAAC,IAAI,CAAC;IAEzB,MAAMO,oBAAoB,GAAG,MAAAA,CAAA,KAAY;MACvC,IAAI;QACF,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;QAC3C,IAAI,CAACF,KAAK,EAAE;UACVH,YAAY,CAACM,KAAK,GAAG,oCAAoC;UACzDL,OAAO,CAACK,KAAK,GAAG,KAAK;UACrB;QACF;QAEA,MAAMC,QAAQ,GAAG,MAAMV,KAAK,CAACW,GAAG,CAC9B,yEAAyE,EACzE;UACEC,OAAO,EAAE;YAAEC,aAAa,EAAE,UAAUP,KAAK;UAAG;QAC9C,CACF,CAAC;QAEDJ,eAAe,CAACO,KAAK,GAAGC,QAAQ,CAACI,IAAI,CAACA,IAAI,IAAI,EAAE;MAClD,CAAC,CAAC,OAAOC,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;;QAE/C;QACA,IAAIA,KAAK,CAACL,QAAQ,IAAIK,KAAK,CAACL,QAAQ,CAACI,IAAI,EAAEC,KAAK,EAAEE,QAAQ,CAAC,4BAA4B,CAAC,EAAE;UACxFd,YAAY,CAACM,KAAK,GAAG,qEAAqE;QAC5F,CAAC,MAAM;UACLN,YAAY,CAACM,KAAK,GAAGM,KAAK,CAACL,QAAQ,EAAEI,IAAI,EAAEC,KAAK,IAAI,2BAA2B;QACjF;MACF,CAAC,SAAS;QACRX,OAAO,CAACK,KAAK,GAAG,KAAK;MACvB;IACF,CAAC;IAEDV,SAAS,CAACM,oBAAoB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}