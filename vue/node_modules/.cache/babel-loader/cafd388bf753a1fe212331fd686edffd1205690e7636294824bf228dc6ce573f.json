{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/es.iterator.reduce.js\";\nimport \"core-js/modules/es.iterator.some.js\";\nimport { ref, onMounted, computed, nextTick } from \"vue\";\nimport axios from \"axios\";\nimport CashierLayouts from \"@/components/CashierLayouts.vue\";\n\n/* API Configuration */\n\nexport default {\n  __name: 'PurchaseReturn',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const API_BASE = import.meta.env.VITE_API_BASE_URL || \"http://localhost:8081/api/v1\";\n    const ENDPOINTS = {\n      PURCHASES: \"/history/purchases\",\n      PURCHASE_DETAIL: \"/pembelian/purchases\",\n      PURCHASE_RETURNS: \"/history/purchase-returns\",\n      CREATE_RETURN: \"/pembelian/purchase-returns\"\n    };\n    const api = axios.create({\n      baseURL: API_BASE\n    });\n    const token = localStorage.getItem(\"token\");\n    if (token) {\n      api.defaults.headers.common[\"Authorization\"] = `Bearer ${token}`;\n    }\n\n    /* State Management */\n    const purchases = ref([]);\n    const loadingPurchases = ref(false);\n    const fromDate = ref(\"\");\n    const toDate = ref(\"\");\n    const purchaseReturns = ref([]);\n    const loadingReturns = ref(false);\n    const returnFromDate = ref(\"\");\n    const returnToDate = ref(\"\");\n    const returnStatusFilter = ref(\"\");\n    const currentPageReturns = ref(1);\n    const totalReturns = ref(0);\n    const totalPagesReturns = computed(() => Math.ceil(totalReturns.value / 10));\n\n    /* Modal State */\n    const showModal = ref(false);\n    const selectedPurchase = ref(null);\n    const returnForm = ref({\n      items: []\n    });\n    const returnNotes = ref(\"\");\n    const submitting = ref(false);\n\n    /* Toast State */\n    const toast = ref({\n      message: \"\",\n      type: \"success\"\n    });\n    const showToast = (message, type = \"success\") => {\n      toast.value = {\n        message,\n        type\n      };\n      setTimeout(() => {\n        toast.value.message = \"\";\n      }, 3000);\n    };\n\n    /* Computed Properties */\n    const safePurchasesLength = computed(() => Array.isArray(purchases.value) ? purchases.value.length : 0);\n    const isFormValid = computed(() => {\n      return Array.isArray(returnForm.value.items) && returnForm.value.items.some(item => (item.qty || 0) > 0 && (item.reason || \"\").trim().length >= 10);\n    });\n    const totalReturnAmount = computed(() => {\n      return Array.isArray(returnForm.value.items) ? returnForm.value.items.reduce((sum, item) => sum + (item.subtotal || 0), 0) : 0;\n    });\n\n    /* Utility Functions */\n    const formatDate = dateStr => {\n      if (!dateStr) return \"N/A\";\n      const date = new Date(dateStr);\n      return isNaN(date.getTime()) ? \"Invalid Date\" : date.toLocaleDateString(\"id-ID\", {\n        day: \"2-digit\",\n        month: \"short\",\n        year: \"numeric\"\n      });\n    };\n    const formatDateFull = dateStr => dateStr ? new Date(dateStr).toLocaleDateString(\"id-ID\") : \"N/A\";\n    const formatCurrency = amount => {\n      return new Intl.NumberFormat(\"id-ID\", {\n        style: \"currency\",\n        currency: \"IDR\",\n        minimumFractionDigits: 0\n      }).format(amount || 0);\n    };\n    const formatPONumber = id => `PO-${String(id || \"\").padStart(3, \"0\")}`;\n    const formatReturnNumber = id => `RTN-${new Date().getFullYear()}-${String(id || \"\").padStart(3, \"0\")}`;\n    const getPOStatusClass = status => {\n      switch (status?.toUpperCase()) {\n        case \"APPROVED\":\n          return \"bg-green-100 text-green-800\";\n        case \"SUBMITTED\":\n          return \"bg-yellow-100 text-yellow-800\";\n        case \"REJECTED\":\n          return \"bg-red-100 text-red-800\";\n        default:\n          return \"bg-gray-100 text-gray-800\";\n      }\n    };\n    const getPOStatusText = status => {\n      switch (status?.toUpperCase()) {\n        case \"APPROVED\":\n          return \"Disetujui\";\n        case \"SUBMITTED\":\n          return \"Diajukan\";\n        case \"REJECTED\":\n          return \"Ditolak\";\n        default:\n          return status || \"Draft\";\n      }\n    };\n    const getStatusClass = status => {\n      switch (status?.toUpperCase()) {\n        case \"PENDING\":\n          return \"bg-yellow-100 text-yellow-800\";\n        case \"APPROVED\":\n          return \"bg-green-100 text-green-800\";\n        case \"REJECTED\":\n          return \"bg-red-100 text-red-800\";\n        default:\n          return \"bg-gray-100 text-gray-800\";\n      }\n    };\n    const getStatusText = status => {\n      switch (status?.toUpperCase()) {\n        case \"PENDING\":\n          return \"Menunggu\";\n        case \"APPROVED\":\n          return \"Disetujui\";\n        case \"REJECTED\":\n          return \"Ditolak\";\n        default:\n          return status || \"-\";\n      }\n    };\n\n    /* API Calls */\n    const fetchPurchases = async () => {\n      loadingPurchases.value = true;\n      try {\n        const params = {\n          page: 1,\n          size: 10,\n          status: \"APPROVED\"\n        };\n        if (fromDate.value) params.from = fromDate.value;\n        if (toDate.value) params.to = toDate.value;\n        const res = await api.get(ENDPOINTS.PURCHASES, {\n          params\n        });\n        const data = res.data?.data || res.data || [];\n        purchases.value = Array.isArray(data) ? data : [];\n        totalReturns.value = res.data?.total || data.length;\n        showToast(\"Daftar PO dimuat berhasil!\");\n      } catch (err) {\n        console.error(\"Error fetching purchases:\", err);\n        showToast(`Gagal memuat PO: ${err.response?.data?.error || err.message}`, \"error\");\n        purchases.value = [];\n      } finally {\n        loadingPurchases.value = false;\n      }\n    };\n    const fetchPurchaseReturns = async () => {\n      loadingReturns.value = true;\n      try {\n        const params = {\n          page: currentPageReturns.value,\n          size: 10\n        };\n        if (returnFromDate.value) params.from = returnFromDate.value;\n        if (returnToDate.value) params.to = returnToDate.value;\n        if (returnStatusFilter.value) params.status = returnStatusFilter.value;\n        const res = await api.get(ENDPOINTS.PURCHASE_RETURNS, {\n          params\n        });\n        const data = res.data?.data || res.data || [];\n        purchaseReturns.value = Array.isArray(data) ? data : [];\n        totalReturns.value = res.data?.total || data.length;\n      } catch (err) {\n        console.error(\"Error fetching returns:\", err);\n        showToast(`Gagal memuat retur: ${err.response?.data?.error || err.message}`, \"error\");\n        purchaseReturns.value = [];\n      } finally {\n        loadingReturns.value = false;\n      }\n    };\n    const openReturnModal = async purchaseId => {\n      if (!purchaseId) {\n        showToast(\"ID PO tidak valid!\", \"error\");\n        return;\n      }\n      try {\n        const res = await api.get(`${ENDPOINTS.PURCHASE_DETAIL}/${purchaseId}`);\n        selectedPurchase.value = res.data?.data || res.data || null;\n        if (!selectedPurchase.value) {\n          throw new Error(\"Data PO kosong\");\n        }\n        const items = selectedPurchase.value.Items || [];\n        returnForm.value.items = Array.isArray(items) ? items.map(item => ({\n          product_id: item.ProductID || item.product_id || item.Product?.id,\n          product_name: item.Product?.name || \"N/A\",\n          original_qty: item.Qty || 0,\n          qty: 0,\n          price: item.Price || 0,\n          reason: \"\",\n          subtotal: 0\n        })) : [];\n        returnNotes.value = \"\";\n        showModal.value = true;\n        await nextTick();\n      } catch (err) {\n        console.error(\"Error loading PO detail:\", err);\n        showToast(`Gagal memuat detail PO: ${err.response?.data?.error || err.message}`, \"error\");\n      }\n    };\n    const updateSubtotal = index => {\n      const item = returnForm.value.items[index];\n      if (item) {\n        item.subtotal = item.qty * item.price;\n      }\n    };\n    const removeItem = index => {\n      returnForm.value.items.splice(index, 1);\n    };\n    const closeModal = () => {\n      showModal.value = false;\n      selectedPurchase.value = null;\n      returnForm.value = {\n        items: []\n      };\n      returnNotes.value = \"\";\n    };\n    const submitReturn = async () => {\n      if (!isFormValid.value) {\n        showToast(\"Minimal satu item harus punya qty > 0 dan alasan minimal 10 karakter!\", \"error\");\n        return;\n      }\n      submitting.value = true;\n      try {\n        const validItems = returnForm.value.items.filter(item => item.qty > 0 && item.reason?.trim().length >= 10).map(item => ({\n          product_id: item.product_id,\n          qty: item.qty,\n          price: item.price\n        }));\n        const payload = {\n          purchase_id: selectedPurchase.value.id || selectedPurchase.value.ID,\n          date: new Date().toISOString().split(\"T\")[0],\n          items: validItems,\n          notes: returnNotes.value.trim()\n        };\n        const res = await api.post(ENDPOINTS.CREATE_RETURN, payload);\n        if (res.status === 201 || res.status === 200) {\n          showToast(\"Retur berhasil dibuat! Status: PENDING (menunggu approval).\");\n          closeModal();\n          fetchPurchaseReturns();\n          fetchPurchases();\n        }\n      } catch (err) {\n        console.error(\"Error submitting return:\", err);\n        showToast(`Gagal submit retur: ${err.response?.data?.error || err.message}`, \"error\");\n      } finally {\n        submitting.value = false;\n      }\n    };\n    const viewReturnDetail = returnId => {\n      console.log(\"View detail return:\", returnId);\n      alert(`Fitur detail retur untuk ID ${returnId} - Bisa dikembangkan lebih lanjut!`);\n    };\n    const resetPurchaseFilter = () => {\n      fromDate.value = \"\";\n      toDate.value = \"\";\n      fetchPurchases();\n    };\n    const resetReturnFilter = () => {\n      returnFromDate.value = \"\";\n      returnToDate.value = \"\";\n      returnStatusFilter.value = \"\";\n      currentPageReturns.value = 1;\n      fetchPurchaseReturns();\n    };\n    const changePageReturns = delta => {\n      const newPage = currentPageReturns.value + delta;\n      if (newPage >= 1 && newPage <= totalPagesReturns.value) {\n        currentPageReturns.value = newPage;\n        fetchPurchaseReturns();\n      }\n    };\n\n    /* Lifecycle */\n    onMounted(async () => {\n      try {\n        await fetchPurchases();\n        await fetchPurchaseReturns();\n      } catch (err) {\n        console.error(\"Mount error:\", err);\n        showToast(\"Gagal inisialisasi halaman\", \"error\");\n      }\n    });\n    const __returned__ = {\n      API_BASE,\n      ENDPOINTS,\n      api,\n      token,\n      purchases,\n      loadingPurchases,\n      fromDate,\n      toDate,\n      purchaseReturns,\n      loadingReturns,\n      returnFromDate,\n      returnToDate,\n      returnStatusFilter,\n      currentPageReturns,\n      totalReturns,\n      totalPagesReturns,\n      showModal,\n      selectedPurchase,\n      returnForm,\n      returnNotes,\n      submitting,\n      toast,\n      showToast,\n      safePurchasesLength,\n      isFormValid,\n      totalReturnAmount,\n      formatDate,\n      formatDateFull,\n      formatCurrency,\n      formatPONumber,\n      formatReturnNumber,\n      getPOStatusClass,\n      getPOStatusText,\n      getStatusClass,\n      getStatusText,\n      fetchPurchases,\n      fetchPurchaseReturns,\n      openReturnModal,\n      updateSubtotal,\n      removeItem,\n      closeModal,\n      submitReturn,\n      viewReturnDetail,\n      resetPurchaseFilter,\n      resetReturnFilter,\n      changePageReturns,\n      ref,\n      onMounted,\n      computed,\n      nextTick,\n      get axios() {\n        return axios;\n      },\n      CashierLayouts\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","computed","nextTick","axios","CashierLayouts","API_BASE","import","meta","env","VITE_API_BASE_URL","ENDPOINTS","PURCHASES","PURCHASE_DETAIL","PURCHASE_RETURNS","CREATE_RETURN","api","create","baseURL","token","localStorage","getItem","defaults","headers","common","purchases","loadingPurchases","fromDate","toDate","purchaseReturns","loadingReturns","returnFromDate","returnToDate","returnStatusFilter","currentPageReturns","totalReturns","totalPagesReturns","Math","ceil","value","showModal","selectedPurchase","returnForm","items","returnNotes","submitting","toast","message","type","showToast","setTimeout","safePurchasesLength","Array","isArray","length","isFormValid","some","item","qty","reason","trim","totalReturnAmount","reduce","sum","subtotal","formatDate","dateStr","date","Date","isNaN","getTime","toLocaleDateString","day","month","year","formatDateFull","formatCurrency","amount","Intl","NumberFormat","style","currency","minimumFractionDigits","format","formatPONumber","id","String","padStart","formatReturnNumber","getFullYear","getPOStatusClass","status","toUpperCase","getPOStatusText","getStatusClass","getStatusText","fetchPurchases","params","page","size","from","to","res","get","data","total","err","console","error","response","fetchPurchaseReturns","openReturnModal","purchaseId","Error","Items","map","product_id","ProductID","Product","product_name","name","original_qty","Qty","price","Price","updateSubtotal","index","removeItem","splice","closeModal","submitReturn","validItems","filter","payload","purchase_id","ID","toISOString","split","notes","post","viewReturnDetail","returnId","log","alert","resetPurchaseFilter","resetReturnFilter","changePageReturns","delta","newPage"],"sources":["C:/Users/Personal/Documents/PKL/aplikasi/aplikasi/src/views/PurchaseReturn.vue"],"sourcesContent":["<template>\n  <CashierLayouts>\n    <Suspense>\n      <template #default>\n        <div class=\"space-y-6\">\n          <!-- Header -->\n          <div\n            v-if=\"!loadingPurchases && !loadingReturns\"\n            class=\"flex flex-wrap justify-between items-center gap-3 p-4 bg-white rounded-lg shadow-sm\"\n          >\n            <div>\n              <h1\n                class=\"text-[#111418] tracking-tight text-3xl font-bold leading-tight\"\n              >\n                Retur Pembelian\n              </h1>\n              <p class=\"text-gray-600 mt-1\">\n                Kelola retur untuk pembelian yang sudah disetujui. Pilih PO,\n                tentukan item retur, dan tambahkan alasan.\n              </p>\n            </div>\n            <div class=\"flex gap-2\">\n              <button\n                @click=\"fetchPurchases\"\n                :disabled=\"loadingPurchases\"\n                class=\"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors flex items-center gap-2\"\n              >\n                <span v-if=\"loadingPurchases\" class=\"animate-spin\">⏳</span>\n                {{ fromDate || toDate ? \"Filter PO\" : \"Load 10 Terakhir\" }}\n              </button>\n              <button\n                @click=\"resetPurchaseFilter\"\n                class=\"px-6 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors\"\n              >\n                Reset Filter\n              </button>\n            </div>\n          </div>\n\n          <!-- Filter PO -->\n          <div\n            v-if=\"!loadingPurchases\"\n            class=\"p-4 bg-blue-50 rounded-lg border border-blue-200\"\n          >\n            <div class=\"flex flex-wrap gap-4 items-end max-w-md\">\n              <div class=\"flex-1 min-w-[200px]\">\n                <label class=\"block text-sm font-medium text-gray-700 mb-1\"\n                  >Dari Tanggal</label\n                >\n                <input\n                  type=\"date\"\n                  v-model=\"fromDate\"\n                  class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                />\n              </div>\n              <div class=\"flex-1 min-w-[200px]\">\n                <label class=\"block text-sm font-medium text-gray-700 mb-1\"\n                  >Sampai Tanggal</label\n                >\n                <input\n                  type=\"date\"\n                  v-model=\"toDate\"\n                  class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                />\n              </div>\n            </div>\n            <p v-if=\"fromDate || toDate\" class=\"text-sm text-blue-600 mt-2\">\n              Filter: {{ formatDateFull(fromDate) }} -\n              {{ formatDateFull(toDate) }}\n            </p>\n          </div>\n\n          <!-- Table PO -->\n          <div\n            class=\"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden\"\n          >\n            <div class=\"p-4 border-b border-gray-200\">\n              <h2 class=\"text-xl font-semibold text-gray-900\">\n                Daftar Pembelian Tersedia untuk Retur\n                <span class=\"text-sm text-gray-500 ml-2\"\n                  >({{ safePurchasesLength }} item{{\n                    safePurchasesLength !== 1 ? \"s\" : \"\"\n                  }})</span\n                >\n              </h2>\n            </div>\n            <div class=\"overflow-x-auto\">\n              <table class=\"min-w-full divide-y divide-gray-200\">\n                <thead class=\"bg-gray-50\">\n                  <tr>\n                    <th\n                      class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\"\n                    >\n                      Tanggal\n                    </th>\n                    <th\n                      class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\"\n                    >\n                      Nomor PO\n                    </th>\n                    <th\n                      class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\"\n                    >\n                      Supplier\n                    </th>\n                    <th\n                      class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\"\n                    >\n                      Total\n                    </th>\n                    <th\n                      class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\"\n                    >\n                      Status\n                    </th>\n                    <th\n                      class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\"\n                    >\n                      Aksi\n                    </th>\n                  </tr>\n                </thead>\n                <tbody class=\"bg-white divide-y divide-gray-200\">\n                  <tr v-if=\"loadingPurchases\">\n                    <td colspan=\"6\" class=\"py-12 text-center\">\n                      <div\n                        class=\"flex items-center justify-center gap-2 text-gray-500\"\n                      >\n                        <div\n                          class=\"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600\"\n                        ></div>\n                        Memuat daftar PO...\n                      </div>\n                    </td>\n                  </tr>\n                  <tr v-else-if=\"safePurchasesLength === 0\">\n                    <td colspan=\"6\" class=\"py-12 text-center text-gray-500\">\n                      <p>Tidak ada pembelian yang tersedia untuk retur.</p>\n                      <p class=\"text-sm mt-1\">\n                        Coba filter tanggal atau load ulang.\n                      </p>\n                    </td>\n                  </tr>\n                  <tr\n                    v-else\n                    v-for=\"(po, index) in purchases\"\n                    :key=\"po.id || po.ID || index\"\n                    class=\"hover:bg-gray-50\"\n                  >\n                    <td\n                      class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\"\n                    >\n                      {{ formatDate(po?.created_at || po?.Date) || \"N/A\" }}\n                    </td>\n                    <td\n                      class=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\"\n                    >\n                      {{ formatPONumber(po?.id || po?.ID) }}\n                    </td>\n                    <td\n                      class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\"\n                    >\n                      {{\n                        po?.Supplier?.name ||\n                        po?.supplier_name ||\n                        \"Tidak diketahui\"\n                      }}\n                    </td>\n                    <td\n                      class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\"\n                    >\n                      {{ formatCurrency(po?.total || po?.Total) }}\n                    </td>\n                    <td class=\"px-6 py-4 whitespace-nowrap\">\n                      <span\n                        :class=\"getPOStatusClass(po?.status)\"\n                        class=\"px-3 py-1 rounded-full text-xs font-medium\"\n                      >\n                        {{ getPOStatusText(po?.status) }}\n                      </span>\n                    </td>\n                    <td class=\"px-6 py-4 whitespace-nowrap text-sm font-medium\">\n                      <button\n                        @click=\"openReturnModal(po?.id || po?.ID)\"\n                        :disabled=\"po?.status !== 'APPROVED'\"\n                        class=\"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors text-sm font-medium\"\n                      >\n                        {{\n                          po?.status === \"APPROVED\" ? \"Add Retur\" : \"Tidak Bisa\"\n                        }}\n                      </button>\n                    </td>\n                  </tr>\n                </tbody>\n              </table>\n            </div>\n          </div>\n\n          <!-- Section Retur Saya -->\n          <div\n            class=\"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden\"\n          >\n            <div\n              class=\"p-4 border-b border-gray-200 flex justify-between items-center\"\n            >\n              <h2 class=\"text-xl font-semibold text-gray-900\">\n                Daftar Retur Pembelian Saya\n              </h2>\n              <div class=\"flex gap-2\">\n                <button\n                  @click=\"fetchPurchaseReturns\"\n                  :disabled=\"loadingReturns\"\n                  class=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors flex items-center gap-2 text-sm\"\n                >\n                  <span v-if=\"loadingReturns\" class=\"animate-spin\">⏳</span>\n                  Filter\n                </button>\n                <button\n                  @click=\"resetReturnFilter\"\n                  class=\"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors text-sm\"\n                >\n                  Reset\n                </button>\n              </div>\n            </div>\n\n            <!-- Filter Retur -->\n            <div class=\"p-4 bg-gray-50\">\n              <div class=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n                <div>\n                  <label class=\"block text-sm font-medium text-gray-700 mb-1\"\n                    >Dari Tanggal</label\n                  >\n                  <input\n                    type=\"date\"\n                    v-model=\"returnFromDate\"\n                    class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  />\n                </div>\n                <div>\n                  <label class=\"block text-sm font-medium text-gray-700 mb-1\"\n                    >Sampai Tanggal</label\n                  >\n                  <input\n                    type=\"date\"\n                    v-model=\"returnToDate\"\n                    class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  />\n                </div>\n                <div>\n                  <label class=\"block text-sm font-medium text-gray-700 mb-1\"\n                    >Status</label\n                  >\n                  <select\n                    v-model=\"returnStatusFilter\"\n                    class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  >\n                    <option value=\"\">Semua Status</option>\n                    <option value=\"PENDING\">Pending</option>\n                    <option value=\"APPROVED\">Disetujui</option>\n                    <option value=\"REJECTED\">Ditolak</option>\n                  </select>\n                </div>\n                <div class=\"flex items-end\">\n                  <p\n                    v-if=\"returnFromDate || returnToDate || returnStatusFilter\"\n                    class=\"text-sm text-gray-600 col-span-full mt-2\"\n                  >\n                    Filter: {{ formatDateFull(returnFromDate) }} -\n                    {{ formatDateFull(returnToDate) }} | Status:\n                    {{ returnStatusFilter || \"Semua\" }}\n                  </p>\n                </div>\n              </div>\n            </div>\n\n            <!-- Table Retur -->\n            <div class=\"overflow-x-auto\">\n              <table class=\"min-w-full divide-y divide-gray-200\">\n                <thead class=\"bg-gray-50\">\n                  <tr>\n                    <th\n                      class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\"\n                    >\n                      No. Retur\n                    </th>\n                    <th\n                      class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\"\n                    >\n                      PO Terkait\n                    </th>\n                    <th\n                      class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\"\n                    >\n                      Tanggal Retur\n                    </th>\n                    <th\n                      class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\"\n                    >\n                      Total Retur\n                    </th>\n                    <th\n                      class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\"\n                    >\n                      Status\n                    </th>\n                    <th\n                      class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\"\n                    >\n                      Aksi\n                    </th>\n                  </tr>\n                </thead>\n                <tbody class=\"bg-white divide-y divide-gray-200\">\n                  <tr v-if=\"loadingReturns\">\n                    <td colspan=\"6\" class=\"py-12 text-center\">\n                      <div\n                        class=\"flex items-center justify-center gap-2 text-gray-500\"\n                      >\n                        <div\n                          class=\"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600\"\n                        ></div>\n                        Memuat retur...\n                      </div>\n                    </td>\n                  </tr>\n                  <tr v-else-if=\"purchaseReturns.length === 0\">\n                    <td colspan=\"6\" class=\"py-12 text-center text-gray-500\">\n                      Belum ada retur pembelian yang dibuat.\n                    </td>\n                  </tr>\n                  <tr\n                    v-else\n                    v-for=\"(ret, index) in purchaseReturns\"\n                    :key=\"ret.id || index\"\n                    class=\"hover:bg-gray-50\"\n                  >\n                    <td\n                      class=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\"\n                    >\n                      {{ formatReturnNumber(ret?.id) }}\n                    </td>\n                    <td\n                      class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\"\n                    >\n                      {{ formatPONumber(ret?.purchase_id) }}\n                    </td>\n                    <td\n                      class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\"\n                    >\n                      {{ formatDate(ret?.created_at || ret?.date) }}\n                    </td>\n                    <td\n                      class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\"\n                    >\n                      {{ formatCurrency(ret?.total || ret?.Total) }}\n                    </td>\n                    <td class=\"px-6 py-4 whitespace-nowrap\">\n                      <span\n                        :class=\"getStatusClass(ret?.status)\"\n                        class=\"px-3 py-1 rounded-full text-xs font-medium\"\n                      >\n                        {{ getStatusText(ret?.status) }}\n                      </span>\n                    </td>\n                    <td\n                      class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\"\n                    >\n                      <button\n                        @click=\"viewReturnDetail(ret?.id)\"\n                        class=\"text-blue-600 hover:text-blue-900 text-sm font-medium\"\n                      >\n                        Lihat Detail\n                      </button>\n                    </td>\n                  </tr>\n                </tbody>\n              </table>\n            </div>\n\n            <!-- Pagination Retur -->\n            <div\n              v-if=\"purchaseReturns.length > 0\"\n              class=\"p-4 bg-gray-50 border-t border-gray-200 flex justify-between items-center\"\n            >\n              <p class=\"text-sm text-gray-600\">\n                Menampilkan {{ purchaseReturns.length }} dari\n                {{ totalReturns }} retur\n              </p>\n              <div class=\"flex gap-2\">\n                <button\n                  @click=\"changePageReturns(-1)\"\n                  :disabled=\"currentPageReturns <= 1\"\n                  class=\"px-3 py-1 bg-gray-300 text-gray-700 rounded disabled:opacity-50\"\n                >\n                  Sebelumnya\n                </button>\n                <span class=\"px-3 py-1 bg-white border rounded\"\n                  >Hal. {{ currentPageReturns }}</span\n                >\n                <button\n                  @click=\"changePageReturns(1)\"\n                  :disabled=\"currentPageReturns >= totalPagesReturns\"\n                  class=\"px-3 py-1 bg-gray-300 text-gray-700 rounded disabled:opacity-50\"\n                >\n                  Selanjutnya\n                </button>\n              </div>\n            </div>\n          </div>\n\n          <!-- Modal Retur -->\n          <div\n            v-if=\"showModal && selectedPurchase\"\n            class=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-y-auto\"\n          >\n            <div class=\"bg-white rounded-lg p-6 max-w-6xl w-full max-h-[95vh]\">\n              <div class=\"flex justify-between items-center mb-6\">\n                <h2 class=\"text-2xl font-bold text-gray-900\">\n                  Buat Retur Pembelian\n                </h2>\n                <button\n                  @click=\"closeModal\"\n                  class=\"text-gray-400 hover:text-gray-600 text-2xl\"\n                >\n                  &times;\n                </button>\n              </div>\n\n              <!-- Info PO -->\n              <div\n                class=\"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200\"\n              >\n                <h3 class=\"font-semibold text-gray-900 mb-2\">\n                  Detail Pembelian Terpilih\n                </h3>\n                <div class=\"grid grid-cols-1 md:grid-cols-4 gap-4 text-sm\">\n                  <div>\n                    <strong>Nomor PO:</strong>\n                    {{\n                      formatPONumber(\n                        selectedPurchase?.id || selectedPurchase?.ID\n                      )\n                    }}\n                  </div>\n                  <div>\n                    <strong>Tanggal:</strong>\n                    {{\n                      formatDate(\n                        selectedPurchase?.created_at || selectedPurchase?.Date\n                      )\n                    }}\n                  </div>\n                  <div>\n                    <strong>Supplier:</strong>\n                    {{ selectedPurchase?.Supplier?.name || \"N/A\" }}\n                  </div>\n                  <div>\n                    <strong>Total Asli:</strong>\n                    {{\n                      formatCurrency(\n                        selectedPurchase?.total || selectedPurchase?.Total\n                      )\n                    }}\n                  </div>\n                </div>\n              </div>\n\n              <!-- Form Items -->\n              <div class=\"mb-6\">\n                <h3 class=\"text-lg font-semibold mb-4 text-gray-900\">\n                  Pilih Item untuk Diretur\n                </h3>\n                <div\n                  v-if=\"returnForm.items.length === 0\"\n                  class=\"text-center py-8 text-gray-500\"\n                >\n                  Tidak ada item yang tersedia untuk retur.\n                </div>\n                <div v-else class=\"space-y-4\">\n                  <div\n                    v-for=\"(item, index) in returnForm.items\"\n                    :key=\"index\"\n                    class=\"border border-gray-200 rounded-lg p-4 bg-gray-50\"\n                  >\n                    <div\n                      class=\"flex flex-wrap gap-4 items-start justify-between\"\n                    >\n                      <div class=\"flex-1\">\n                        <p class=\"font-medium text-gray-900\">\n                          {{ item.product_name || \"N/A\" }}\n                        </p>\n                        <p class=\"text-sm text-gray-600\">\n                          Qty Asli: {{ item.original_qty || 0 }} | Harga:\n                          {{ formatCurrency(item.price) }}\n                        </p>\n                      </div>\n                      <div class=\"w-24\">\n                        <label\n                          class=\"block text-sm font-medium text-gray-700 mb-1\"\n                          >Qty Retur</label\n                        >\n                        <input\n                          type=\"number\"\n                          v-model.number=\"item.qty\"\n                          :min=\"0\"\n                          :max=\"item.original_qty || 0\"\n                          class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500\"\n                          @input=\"updateSubtotal(index)\"\n                        />\n                      </div>\n                      <div class=\"flex-1\">\n                        <label\n                          class=\"block text-sm font-medium text-gray-700 mb-1\"\n                          >Alasan Retur *</label\n                        >\n                        <textarea\n                          v-model=\"item.reason\"\n                          placeholder=\"Jelaskan alasan retur item ini (wajib)\"\n                          rows=\"2\"\n                          class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 resize-none\"\n                        ></textarea>\n                        <p\n                          v-if=\"item.reason && item.reason.length < 10\"\n                          class=\"text-xs text-red-500 mt-1\"\n                        >\n                          Alasan minimal 10 karakter.\n                        </p>\n                      </div>\n                      <div class=\"w-24 text-right\">\n                        <p class=\"text-sm font-medium text-gray-900\">\n                          Subtotal: {{ formatCurrency(item.subtotal) }}\n                        </p>\n                      </div>\n                    </div>\n                    <button\n                      v-if=\"item.qty > 0\"\n                      @click=\"removeItem(index)\"\n                      class=\"mt-2 text-red-600 hover:text-red-800 text-sm font-medium\"\n                    >\n                      Hapus Item Ini\n                    </button>\n                  </div>\n                </div>\n                <p\n                  v-if=\"totalReturnAmount > 0\"\n                  class=\"mt-4 text-right font-semibold text-lg text-gray-900\"\n                >\n                  Total Retur: {{ formatCurrency(totalReturnAmount) }}\n                </p>\n              </div>\n\n              <!-- Catatan -->\n              <div class=\"mb-6\">\n                <label class=\"block text-sm font-medium text-gray-700 mb-2\"\n                  >Catatan Tambahan (Opsional)</label\n                >\n                <textarea\n                  v-model=\"returnNotes\"\n                  placeholder=\"Tambahkan catatan untuk retur ini (misal: nomor invoice supplier)\"\n                  rows=\"3\"\n                  class=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none\"\n                ></textarea>\n              </div>\n\n              <!-- Footer -->\n              <div class=\"flex justify-end gap-3 pt-4 border-t border-gray-200\">\n                <button\n                  @click=\"closeModal\"\n                  class=\"px-6 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors\"\n                >\n                  Batal\n                </button>\n                <button\n                  @click=\"submitReturn\"\n                  :disabled=\"submitting || !isFormValid\"\n                  class=\"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2\"\n                >\n                  <span v-if=\"submitting\" class=\"animate-spin\">⏳</span>\n                  {{ submitting ? \"Menyimpan...\" : \"Submit Retur\" }}\n                </button>\n              </div>\n            </div>\n          </div>\n\n          <!-- Toast -->\n          <div\n            v-if=\"toast.message\"\n            :class=\"[\n              'fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 transition-all',\n              toast.type === 'success'\n                ? 'bg-green-500 text-white'\n                : 'bg-red-500 text-white',\n            ]\"\n          >\n            {{ toast.message }}\n          </div>\n        </div>\n      </template>\n      <template #fallback>\n        <div class=\"flex items-center justify-center h-64\">\n          <div\n            class=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"\n          ></div>\n          <span class=\"ml-2 text-gray-500\">Loading app...</span>\n        </div>\n      </template>\n    </Suspense>\n  </CashierLayouts>\n</template>\n\n<script setup>\nimport { ref, onMounted, computed, nextTick } from \"vue\";\nimport axios from \"axios\";\nimport CashierLayouts from \"@/components/CashierLayouts.vue\";\n\n/* API Configuration */\nconst API_BASE =\n  import.meta.env.VITE_API_BASE_URL || \"http://localhost:8081/api/v1\";\nconst ENDPOINTS = {\n  PURCHASES: \"/history/purchases\",\n  PURCHASE_DETAIL: \"/pembelian/purchases\",\n  PURCHASE_RETURNS: \"/history/purchase-returns\",\n  CREATE_RETURN: \"/pembelian/purchase-returns\",\n};\n\nconst api = axios.create({ baseURL: API_BASE });\nconst token = localStorage.getItem(\"token\");\nif (token) {\n  api.defaults.headers.common[\"Authorization\"] = `Bearer ${token}`;\n}\n\n/* State Management */\nconst purchases = ref([]);\nconst loadingPurchases = ref(false);\nconst fromDate = ref(\"\");\nconst toDate = ref(\"\");\n\nconst purchaseReturns = ref([]);\nconst loadingReturns = ref(false);\nconst returnFromDate = ref(\"\");\nconst returnToDate = ref(\"\");\nconst returnStatusFilter = ref(\"\");\nconst currentPageReturns = ref(1);\nconst totalReturns = ref(0);\nconst totalPagesReturns = computed(() => Math.ceil(totalReturns.value / 10));\n\n/* Modal State */\nconst showModal = ref(false);\nconst selectedPurchase = ref(null);\nconst returnForm = ref({ items: [] });\nconst returnNotes = ref(\"\");\nconst submitting = ref(false);\n\n/* Toast State */\nconst toast = ref({ message: \"\", type: \"success\" });\nconst showToast = (message, type = \"success\") => {\n  toast.value = { message, type };\n  setTimeout(() => {\n    toast.value.message = \"\";\n  }, 3000);\n};\n\n/* Computed Properties */\nconst safePurchasesLength = computed(() =>\n  Array.isArray(purchases.value) ? purchases.value.length : 0\n);\n\nconst isFormValid = computed(() => {\n  return (\n    Array.isArray(returnForm.value.items) &&\n    returnForm.value.items.some(\n      (item) => (item.qty || 0) > 0 && (item.reason || \"\").trim().length >= 10\n    )\n  );\n});\n\nconst totalReturnAmount = computed(() => {\n  return Array.isArray(returnForm.value.items)\n    ? returnForm.value.items.reduce(\n        (sum, item) => sum + (item.subtotal || 0),\n        0\n      )\n    : 0;\n});\n\n/* Utility Functions */\nconst formatDate = (dateStr) => {\n  if (!dateStr) return \"N/A\";\n  const date = new Date(dateStr);\n  return isNaN(date.getTime())\n    ? \"Invalid Date\"\n    : date.toLocaleDateString(\"id-ID\", {\n        day: \"2-digit\",\n        month: \"short\",\n        year: \"numeric\",\n      });\n};\n\nconst formatDateFull = (dateStr) =>\n  dateStr ? new Date(dateStr).toLocaleDateString(\"id-ID\") : \"N/A\";\n\nconst formatCurrency = (amount) => {\n  return new Intl.NumberFormat(\"id-ID\", {\n    style: \"currency\",\n    currency: \"IDR\",\n    minimumFractionDigits: 0,\n  }).format(amount || 0);\n};\n\nconst formatPONumber = (id) => `PO-${String(id || \"\").padStart(3, \"0\")}`;\nconst formatReturnNumber = (id) =>\n  `RTN-${new Date().getFullYear()}-${String(id || \"\").padStart(3, \"0\")}`;\n\nconst getPOStatusClass = (status) => {\n  switch (status?.toUpperCase()) {\n    case \"APPROVED\":\n      return \"bg-green-100 text-green-800\";\n    case \"SUBMITTED\":\n      return \"bg-yellow-100 text-yellow-800\";\n    case \"REJECTED\":\n      return \"bg-red-100 text-red-800\";\n    default:\n      return \"bg-gray-100 text-gray-800\";\n  }\n};\n\nconst getPOStatusText = (status) => {\n  switch (status?.toUpperCase()) {\n    case \"APPROVED\":\n      return \"Disetujui\";\n    case \"SUBMITTED\":\n      return \"Diajukan\";\n    case \"REJECTED\":\n      return \"Ditolak\";\n    default:\n      return status || \"Draft\";\n  }\n};\n\nconst getStatusClass = (status) => {\n  switch (status?.toUpperCase()) {\n    case \"PENDING\":\n      return \"bg-yellow-100 text-yellow-800\";\n    case \"APPROVED\":\n      return \"bg-green-100 text-green-800\";\n    case \"REJECTED\":\n      return \"bg-red-100 text-red-800\";\n    default:\n      return \"bg-gray-100 text-gray-800\";\n  }\n};\n\nconst getStatusText = (status) => {\n  switch (status?.toUpperCase()) {\n    case \"PENDING\":\n      return \"Menunggu\";\n    case \"APPROVED\":\n      return \"Disetujui\";\n    case \"REJECTED\":\n      return \"Ditolak\";\n    default:\n      return status || \"-\";\n  }\n};\n\n/* API Calls */\nconst fetchPurchases = async () => {\n  loadingPurchases.value = true;\n  try {\n    const params = { page: 1, size: 10, status: \"APPROVED\" };\n    if (fromDate.value) params.from = fromDate.value;\n    if (toDate.value) params.to = toDate.value;\n\n    const res = await api.get(ENDPOINTS.PURCHASES, { params });\n    const data = res.data?.data || res.data || [];\n    purchases.value = Array.isArray(data) ? data : [];\n    totalReturns.value = res.data?.total || data.length;\n    showToast(\"Daftar PO dimuat berhasil!\");\n  } catch (err) {\n    console.error(\"Error fetching purchases:\", err);\n    showToast(\n      `Gagal memuat PO: ${err.response?.data?.error || err.message}`,\n      \"error\"\n    );\n    purchases.value = [];\n  } finally {\n    loadingPurchases.value = false;\n  }\n};\n\nconst fetchPurchaseReturns = async () => {\n  loadingReturns.value = true;\n  try {\n    const params = { page: currentPageReturns.value, size: 10 };\n    if (returnFromDate.value) params.from = returnFromDate.value;\n    if (returnToDate.value) params.to = returnToDate.value;\n    if (returnStatusFilter.value) params.status = returnStatusFilter.value;\n\n    const res = await api.get(ENDPOINTS.PURCHASE_RETURNS, { params });\n    const data = res.data?.data || res.data || [];\n    purchaseReturns.value = Array.isArray(data) ? data : [];\n    totalReturns.value = res.data?.total || data.length;\n  } catch (err) {\n    console.error(\"Error fetching returns:\", err);\n    showToast(\n      `Gagal memuat retur: ${err.response?.data?.error || err.message}`,\n      \"error\"\n    );\n    purchaseReturns.value = [];\n  } finally {\n    loadingReturns.value = false;\n  }\n};\n\nconst openReturnModal = async (purchaseId) => {\n  if (!purchaseId) {\n    showToast(\"ID PO tidak valid!\", \"error\");\n    return;\n  }\n  try {\n    const res = await api.get(`${ENDPOINTS.PURCHASE_DETAIL}/${purchaseId}`);\n    selectedPurchase.value = res.data?.data || res.data || null;\n    if (!selectedPurchase.value) {\n      throw new Error(\"Data PO kosong\");\n    }\n\n    const items = selectedPurchase.value.Items || [];\n    returnForm.value.items = Array.isArray(items)\n      ? items.map((item) => ({\n          product_id: item.ProductID || item.product_id || item.Product?.id,\n          product_name: item.Product?.name || \"N/A\",\n          original_qty: item.Qty || 0,\n          qty: 0,\n          price: item.Price || 0,\n          reason: \"\",\n          subtotal: 0,\n        }))\n      : [];\n    returnNotes.value = \"\";\n    showModal.value = true;\n    await nextTick();\n  } catch (err) {\n    console.error(\"Error loading PO detail:\", err);\n    showToast(\n      `Gagal memuat detail PO: ${err.response?.data?.error || err.message}`,\n      \"error\"\n    );\n  }\n};\n\nconst updateSubtotal = (index) => {\n  const item = returnForm.value.items[index];\n  if (item) {\n    item.subtotal = item.qty * item.price;\n  }\n};\n\nconst removeItem = (index) => {\n  returnForm.value.items.splice(index, 1);\n};\n\nconst closeModal = () => {\n  showModal.value = false;\n  selectedPurchase.value = null;\n  returnForm.value = { items: [] };\n  returnNotes.value = \"\";\n};\n\nconst submitReturn = async () => {\n  if (!isFormValid.value) {\n    showToast(\n      \"Minimal satu item harus punya qty > 0 dan alasan minimal 10 karakter!\",\n      \"error\"\n    );\n    return;\n  }\n\n  submitting.value = true;\n  try {\n    const validItems = returnForm.value.items\n      .filter((item) => item.qty > 0 && item.reason?.trim().length >= 10)\n      .map((item) => ({\n        product_id: item.product_id,\n        qty: item.qty,\n        price: item.price,\n      }));\n\n    const payload = {\n      purchase_id: selectedPurchase.value.id || selectedPurchase.value.ID,\n      date: new Date().toISOString().split(\"T\")[0],\n      items: validItems,\n      notes: returnNotes.value.trim(),\n    };\n\n    const res = await api.post(ENDPOINTS.CREATE_RETURN, payload);\n    if (res.status === 201 || res.status === 200) {\n      showToast(\"Retur berhasil dibuat! Status: PENDING (menunggu approval).\");\n      closeModal();\n      fetchPurchaseReturns();\n      fetchPurchases();\n    }\n  } catch (err) {\n    console.error(\"Error submitting return:\", err);\n    showToast(\n      `Gagal submit retur: ${err.response?.data?.error || err.message}`,\n      \"error\"\n    );\n  } finally {\n    submitting.value = false;\n  }\n};\n\nconst viewReturnDetail = (returnId) => {\n  console.log(\"View detail return:\", returnId);\n  alert(\n    `Fitur detail retur untuk ID ${returnId} - Bisa dikembangkan lebih lanjut!`\n  );\n};\n\nconst resetPurchaseFilter = () => {\n  fromDate.value = \"\";\n  toDate.value = \"\";\n  fetchPurchases();\n};\n\nconst resetReturnFilter = () => {\n  returnFromDate.value = \"\";\n  returnToDate.value = \"\";\n  returnStatusFilter.value = \"\";\n  currentPageReturns.value = 1;\n  fetchPurchaseReturns();\n};\n\nconst changePageReturns = (delta) => {\n  const newPage = currentPageReturns.value + delta;\n  if (newPage >= 1 && newPage <= totalPagesReturns.value) {\n    currentPageReturns.value = newPage;\n    fetchPurchaseReturns();\n  }\n};\n\n/* Lifecycle */\nonMounted(async () => {\n  try {\n    await fetchPurchases();\n    await fetchPurchaseReturns();\n  } catch (err) {\n    console.error(\"Mount error:\", err);\n    showToast(\"Gagal inisialisasi halaman\", \"error\");\n  }\n});\n</script>\n\n<style scoped>\n/* Custom styles untuk smooth transitions */\n.fade-enter-active,\n.fade-leave-active {\n  transition: opacity 0.3s;\n}\n.fade-enter-from,\n.fade-leave-to {\n  opacity: 0;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}