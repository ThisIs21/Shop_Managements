{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport { ref, computed, onMounted } from \"vue\";\nimport axios from \"axios\";\nimport CashierSidebar from \"@/components/CashierSidebar.vue\";\n\n// ... (kode existing tetap sama hingga const amountReceived = ref(0);)\n\nexport default {\n  __name: 'CashierPage',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const customerName = ref(\"\"); // Opsional: Tambahkan input untuk customer name di template jika perlu\n\n    // ... (fungsi login, loadProducts, filteredProducts, addToCart, removeFromCart, totalAmount, change, handlePrintReceipt, formatCurrency tetap sama)\n\n    // Modifikasi fungsi checkout\n    const checkout = async () => {\n      if (cart.value.length === 0) {\n        alert(\"Cart masih kosong!\");\n        return;\n      }\n      if (amountReceived.value < totalAmount.value) {\n        alert(\"Uang kurang!\");\n        return;\n      }\n      try {\n        // Siapkan payload sesuai dto CreateSaleReq\n        const payload = {\n          customer_name: customerName.value || null,\n          // Opsional, bisa null jika tidak ada input\n          paid_amount: amountReceived.value,\n          items: cart.value.map(item => ({\n            product_id: item.id,\n            qty: item.qty\n          }))\n        };\n        const res = await api.post(\"/kasir/sales\", payload); // Endpoint berdasarkan router\n        console.log(\"Transaksi sukses:\", res.data);\n        alert(\"Pembayaran berhasil! ID Transaksi: \" + res.data.id);\n        cart.value = [];\n        amountReceived.value = 0;\n        customerName.value = \"\"; // Reset jika ada\n\n        // Opsional: Trigger print receipt setelah sukses\n        handlePrintReceipt();\n      } catch (err) {\n        console.error(err);\n        const errorMsg = err.response?.data?.message || err.message || \"Transaksi gagal!\";\n        alert(errorMsg);\n      }\n    };\n\n    // ... (onMounted tetap sama)\n\n    const __returned__ = {\n      customerName,\n      checkout,\n      ref,\n      computed,\n      onMounted,\n      get axios() {\n        return axios;\n      },\n      CashierSidebar\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","axios","CashierSidebar","customerName","checkout","cart","value","length","alert","amountReceived","totalAmount","payload","customer_name","paid_amount","items","map","item","product_id","id","qty","res","api","post","console","log","data","handlePrintReceipt","err","error","errorMsg","response","message"],"sources":["C:/Users/Personal/Documents/PKL/aplikasi/aplikasi/src/views/CashierPage.vue"],"sourcesContent":["<template>\n  <div class=\"min-h-screen flex bg-white\">\n    <CashierSidebar v-if=\"isLoggedIn\" />\n\n    <main class=\"flex-1 p-6 max-w-7xl mx-auto w-full\">\n      <h2 class=\"text-2xl font-bold text-center mb-6\">Cashier - Order</h2>\n\n      <!-- LOGIN -->\n      <div\n        v-if=\"!isLoggedIn\"\n        class=\"max-w-sm mx-auto border rounded p-6 shadow\"\n      >\n        <h3 class=\"text-lg font-semibold mb-4\">Login Kasir</h3>\n        <input\n          v-model=\"username\"\n          type=\"text\"\n          placeholder=\"Username\"\n          class=\"w-full border rounded p-2 mb-3 text-sm\"\n        />\n        <input\n          v-model=\"password\"\n          type=\"password\"\n          placeholder=\"Password\"\n          class=\"w-full border rounded p-2 mb-3 text-sm\"\n        />\n        <button\n          @click=\"login\"\n          class=\"w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700\"\n        >\n          Login\n        </button>\n      </div>\n\n      <!-- KASIR -->\n      <div v-else class=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n        <!-- LEFT: Products -->\n        <section class=\"md:col-span-2\">\n          <h3 class=\"text-lg font-semibold mb-4\">Available Products</h3>\n\n          <div\n            class=\"flex flex-col md:flex-row md:items-center md:justify-between gap-3 mb-4\"\n          >\n            <input\n              v-model=\"search\"\n              type=\"text\"\n              placeholder=\"Cari produk...\"\n              class=\"w-full md:w-1/2 border rounded p-2 text-sm\"\n            />\n            <select\n              v-model=\"selectedCategory\"\n              class=\"border rounded p-2 text-sm w-full md:w-48\"\n            >\n              <option value=\"All\">Semua Kategori</option>\n              <option v-for=\"cat in categories\" :key=\"cat\" :value=\"cat\">\n                {{ cat }}\n              </option>\n            </select>\n          </div>\n\n          <div class=\"grid grid-cols-2 gap-4\">\n            <div\n              v-for=\"p in filteredProducts\"\n              :key=\"p.id\"\n              class=\"border rounded-lg p-4 bg-white shadow flex flex-col justify-between\"\n            >\n              <div>\n                <h4 class=\"font-semibold\">{{ p.name }}</h4>\n                <p class=\"text-sm text-gray-600\">\n                  {{ formatCurrency(p.sell_price) }}\n                </p>\n                <p class=\"text-xs text-green-600\">Stock: {{ p.stock }}</p>\n              </div>\n              <button\n                @click=\"addToCart(p)\"\n                class=\"mt-3 bg-blue-500 text-white text-sm py-1 rounded hover:bg-blue-600\"\n              >\n                Add\n              </button>\n            </div>\n          </div>\n        </section>\n\n        <!-- RIGHT: Cart -->\n        <section class=\"md:col-span-1 flex flex-col\">\n          <h3 class=\"text-lg font-semibold mb-4\">Cart Order</h3>\n\n          <div\n            class=\"border rounded-lg p-3 bg-white shadow max-h-64 overflow-y-auto\"\n          >\n            <table class=\"w-full text-sm\">\n              <thead class=\"sticky top-0 bg-gray-100\">\n                <tr>\n                  <th class=\"p-2\">Item</th>\n                  <th class=\"p-2\">Qty</th>\n                  <th class=\"p-2\">Subtotal</th>\n                  <th class=\"p-2\">X</th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr v-for=\"(item, i) in cart\" :key=\"item.id\" class=\"border-t\">\n                  <td class=\"p-2\">{{ item.name }}</td>\n                  <td class=\"p-2\">\n                    <input\n                      type=\"number\"\n                      v-model.number=\"item.qty\"\n                      min=\"1\"\n                      :max=\"item.stock\"\n                      class=\"w-14 border rounded p-1\"\n                    />\n                  </td>\n                  <td class=\"p-2\">\n                    {{ formatCurrency(item.sell_price * item.qty) }}\n                  </td>\n                  <td class=\"p-2\">\n                    <button @click=\"removeFromCart(i)\" class=\"text-red-500\">\n                      âœ•\n                    </button>\n                  </td>\n                </tr>\n                <tr v-if=\"cart.length === 0\">\n                  <td colspan=\"4\" class=\"text-center text-gray-500 py-4\">\n                    Cart kosong\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n\n          <div class=\"mt-6 border rounded-lg p-3 bg-white shadow\">\n            <h4 class=\"font-semibold mb-2\">Order Summary</h4>\n            <div class=\"flex justify-between text-sm\">\n              <span>Total</span>\n              <span>{{ formatCurrency(totalAmount) }}</span>\n            </div>\n\n            <div class=\"mt-4\">\n              <label class=\"block mb-2 text-sm\">Amount Received</label>\n              <input\n                v-model.number=\"amountReceived\"\n                type=\"number\"\n                placeholder=\"Masukkan nominal\"\n                class=\"w-full border rounded p-2 text-sm\"\n              />\n              <p class=\"text-sm mt-1\">\n                Change:\n                <span class=\"font-semibold\">{{ formatCurrency(change) }}</span>\n              </p>\n            </div>\n\n            <div class=\"flex flex-col gap-3 mt-6\">\n              <button\n                @click=\"checkout\"\n                class=\"w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700\"\n              >\n                Pay Now\n              </button>\n              <button\n                @click=\"handlePrintReceipt\"\n                class=\"w-full bg-gray-100 py-2 rounded hover:bg-gray-200\"\n              >\n                Print Receipt\n              </button>\n            </div>\n          </div>\n        </section>\n      </div>\n    </main>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted } from \"vue\";\nimport axios from \"axios\";\nimport CashierSidebar from \"@/components/CashierSidebar.vue\";\n\n// ... (kode existing tetap sama hingga const amountReceived = ref(0);)\n\nconst customerName = ref(\"\"); // Opsional: Tambahkan input untuk customer name di template jika perlu\n\n// ... (fungsi login, loadProducts, filteredProducts, addToCart, removeFromCart, totalAmount, change, handlePrintReceipt, formatCurrency tetap sama)\n\n// Modifikasi fungsi checkout\nconst checkout = async () => {\n  if (cart.value.length === 0) {\n    alert(\"Cart masih kosong!\");\n    return;\n  }\n  if (amountReceived.value < totalAmount.value) {\n    alert(\"Uang kurang!\");\n    return;\n  }\n\n  try {\n    // Siapkan payload sesuai dto CreateSaleReq\n    const payload = {\n      customer_name: customerName.value || null, // Opsional, bisa null jika tidak ada input\n      paid_amount: amountReceived.value,\n      items: cart.value.map(item => ({\n        product_id: item.id,\n        qty: item.qty\n      }))\n    };\n\n    const res = await api.post(\"/kasir/sales\", payload); // Endpoint berdasarkan router\n    console.log(\"Transaksi sukses:\", res.data);\n\n    alert(\"Pembayaran berhasil! ID Transaksi: \" + res.data.id);\n    cart.value = [];\n    amountReceived.value = 0;\n    customerName.value = \"\"; // Reset jika ada\n\n    // Opsional: Trigger print receipt setelah sukses\n    handlePrintReceipt();\n  } catch (err) {\n    console.error(err);\n    const errorMsg = err.response?.data?.message || err.message || \"Transaksi gagal!\";\n    alert(errorMsg);\n  }\n};\n\n// ... (onMounted tetap sama)\n</script>"],"mappings":";;AA2KA,SAASA,GAAG,EAAEC,QAAQ,EAAEC,SAAS,QAAQ,KAAK;AAC9C,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAOC,cAAc,MAAM,iCAAiC;;AAE5D;;;;;;;;IAEA,MAAMC,YAAY,GAAGL,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC;;IAE9B;;IAEA;IACA,MAAMM,QAAQ,GAAG,MAAAA,CAAA,KAAY;MAC3B,IAAIC,IAAI,CAACC,KAAK,CAACC,MAAM,KAAK,CAAC,EAAE;QAC3BC,KAAK,CAAC,oBAAoB,CAAC;QAC3B;MACF;MACA,IAAIC,cAAc,CAACH,KAAK,GAAGI,WAAW,CAACJ,KAAK,EAAE;QAC5CE,KAAK,CAAC,cAAc,CAAC;QACrB;MACF;MAEA,IAAI;QACF;QACA,MAAMG,OAAO,GAAG;UACdC,aAAa,EAAET,YAAY,CAACG,KAAK,IAAI,IAAI;UAAE;UAC3CO,WAAW,EAAEJ,cAAc,CAACH,KAAK;UACjCQ,KAAK,EAAET,IAAI,CAACC,KAAK,CAACS,GAAG,CAACC,IAAI,KAAK;YAC7BC,UAAU,EAAED,IAAI,CAACE,EAAE;YACnBC,GAAG,EAAEH,IAAI,CAACG;UACZ,CAAC,CAAC;QACJ,CAAC;QAED,MAAMC,GAAG,GAAG,MAAMC,GAAG,CAACC,IAAI,CAAC,cAAc,EAAEX,OAAO,CAAC,CAAC,CAAC;QACrDY,OAAO,CAACC,GAAG,CAAC,mBAAmB,EAAEJ,GAAG,CAACK,IAAI,CAAC;QAE1CjB,KAAK,CAAC,qCAAqC,GAAGY,GAAG,CAACK,IAAI,CAACP,EAAE,CAAC;QAC1Db,IAAI,CAACC,KAAK,GAAG,EAAE;QACfG,cAAc,CAACH,KAAK,GAAG,CAAC;QACxBH,YAAY,CAACG,KAAK,GAAG,EAAE,CAAC,CAAC;;QAEzB;QACAoB,kBAAkB,CAAC,CAAC;MACtB,CAAC,CAAC,OAAOC,GAAG,EAAE;QACZJ,OAAO,CAACK,KAAK,CAACD,GAAG,CAAC;QAClB,MAAME,QAAQ,GAAGF,GAAG,CAACG,QAAQ,EAAEL,IAAI,EAAEM,OAAO,IAAIJ,GAAG,CAACI,OAAO,IAAI,kBAAkB;QACjFvB,KAAK,CAACqB,QAAQ,CAAC;MACjB;IACF,CAAC;;IAED","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}