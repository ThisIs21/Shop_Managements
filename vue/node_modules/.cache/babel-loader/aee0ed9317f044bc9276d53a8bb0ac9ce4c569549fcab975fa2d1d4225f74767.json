{"ast":null,"code":"import { ref, onMounted } from \"vue\";\nimport axios from \"axios\";\nexport default {\n  __name: 'PurchaseReturnKepalaGudang',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const purchaseReturns = ref([]);\n    const token = localStorage.getItem(\"token\");\n\n    // Format tanggal agar lebih rapi\n    const formatDate = dateStr => {\n      if (!dateStr) return \"-\";\n      return new Date(dateStr).toLocaleString(\"id-ID\");\n    };\n    const fetchPurchaseReturns = async () => {\n      try {\n        const res = await axios.get(\"http://localhost:8081/api/v1/history/purchase-returns?page=1&size=20\", {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        console.log(\"DATA RETUR:\", res.data); // cek response backend\n        purchaseReturns.value = res.data.data || [];\n      } catch (err) {\n        console.error(\"Gagal fetch data retur:\", err.response?.data || err.message);\n      }\n    };\n    const approveReturn = async id => {\n      try {\n        await axios.post(`http://localhost:8081/api/v1/kepala-gudang/purchase-returns/${id}/approve`, {}, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        fetchPurchaseReturns();\n      } catch (err) {\n        console.error(\"Gagal approve retur:\", err.response?.data || err.message);\n      }\n    };\n    const rejectReturn = async id => {\n      try {\n        await axios.post(`http://localhost:8081/api/v1/kepala-gudang/purchase-returns/${id}/reject`, {}, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        fetchPurchaseReturns();\n      } catch (err) {\n        console.error(\"Gagal reject retur:\", err.response?.data || err.message);\n      }\n    };\n    onMounted(() => {\n      fetchPurchaseReturns();\n    });\n    const __returned__ = {\n      purchaseReturns,\n      token,\n      formatDate,\n      fetchPurchaseReturns,\n      approveReturn,\n      rejectReturn,\n      ref,\n      onMounted,\n      get axios() {\n        return axios;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","axios","purchaseReturns","token","localStorage","getItem","formatDate","dateStr","Date","toLocaleString","fetchPurchaseReturns","res","get","headers","Authorization","console","log","data","value","err","error","response","message","approveReturn","id","post","rejectReturn"],"sources":["C:/Users/Personal/Documents/PKL/aplikasi/aplikasi/src/views/PurchaseReturnKepalaGudang.vue"],"sourcesContent":["<template>\n  <div class=\"p-6\">\n    <h1 class=\"text-2xl font-bold mb-4\">Daftar Retur Pembelian</h1>\n\n    <!-- Table -->\n    <div class=\"overflow-x-auto bg-white rounded shadow\">\n      <table class=\"min-w-full border-collapse\">\n        <thead>\n          <tr class=\"bg-gray-50\">\n            <th class=\"px-4 py-3 text-left\">ID</th>\n            <th class=\"px-4 py-3 text-left\">Purchase ID</th>\n            <th class=\"px-4 py-3 text-left\">Total</th>\n            <th class=\"px-4 py-3 text-left\">Tanggal</th>\n            <th class=\"px-4 py-3 text-left\">Status</th>\n            <th class=\"px-4 py-3 text-left\">Actions</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr\n            v-for=\"item in purchaseReturns\"\n            :key=\"item.id\"\n            class=\"border-t hover:bg-gray-50\"\n          >\n            <td class=\"px-4 py-2\">{{ item.id }}</td>\n            <td class=\"px-4 py-2\">{{ item.purchase_id }}</td>\n            <td class=\"px-4 py-2\">{{ item.total }}</td>\n            <td class=\"px-4 py-2\">\n              {{ formatDate(item.date) }}\n            </td>\n            <td class=\"px-4 py-2\">\n              <span\n                :class=\"{\n                  'bg-yellow-100 text-yellow-800 px-2 py-1 rounded':\n                    item.status === 'PENDING',\n                  'bg-green-100 text-green-800 px-2 py-1 rounded':\n                    item.status === 'APPROVED',\n                  'bg-red-100 text-red-800 px-2 py-1 rounded':\n                    item.status === 'REJECTED',\n                }\"\n              >\n                {{ item.status }}\n              </span>\n            </td>\n            <td class=\"px-4 py-2 space-x-2\">\n              <button\n                class=\"bg-green-500 text-white px-3 py-1 rounded disabled:opacity-50\"\n                @click=\"approveReturn(item.id)\"\n                :disabled=\"item.status !== 'PENDING'\"\n              >\n                Approve\n              </button>\n              <button\n                class=\"bg-red-500 text-white px-3 py-1 rounded disabled:opacity-50\"\n                @click=\"rejectReturn(item.id)\"\n                :disabled=\"item.status !== 'PENDING'\"\n              >\n                Reject\n              </button>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n\n      <!-- Jika data kosong -->\n      <div\n        v-if=\"purchaseReturns.length === 0\"\n        class=\"p-4 text-center text-gray-500\"\n      >\n        Tidak ada data retur pembelian.\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, onMounted } from \"vue\";\nimport axios from \"axios\";\n\nconst purchaseReturns = ref([]);\nconst token = localStorage.getItem(\"token\");\n\n// Format tanggal agar lebih rapi\nconst formatDate = (dateStr) => {\n  if (!dateStr) return \"-\";\n  return new Date(dateStr).toLocaleString(\"id-ID\");\n};\n\nconst fetchPurchaseReturns = async () => {\n  try {\n    const res = await axios.get(\n      \"http://localhost:8081/api/v1/history/purchase-returns?page=1&size=20\",\n      {\n        headers: { Authorization: `Bearer ${token}` },\n      }\n    );\n    console.log(\"DATA RETUR:\", res.data); // cek response backend\n    purchaseReturns.value = res.data.data || [];\n  } catch (err) {\n    console.error(\"Gagal fetch data retur:\", err.response?.data || err.message);\n  }\n};\n\nconst approveReturn = async (id) => {\n  try {\n    await axios.post(\n      `http://localhost:8081/api/v1/kepala-gudang/purchase-returns/${id}/approve`,\n      {},\n      {\n        headers: { Authorization: `Bearer ${token}` },\n      }\n    );\n    fetchPurchaseReturns();\n  } catch (err) {\n    console.error(\"Gagal approve retur:\", err.response?.data || err.message);\n  }\n};\n\nconst rejectReturn = async (id) => {\n  try {\n    await axios.post(\n      `http://localhost:8081/api/v1/kepala-gudang/purchase-returns/${id}/reject`,\n      {},\n      {\n        headers: { Authorization: `Bearer ${token}` },\n      }\n    );\n    fetchPurchaseReturns();\n  } catch (err) {\n    console.error(\"Gagal reject retur:\", err.response?.data || err.message);\n  }\n};\n\nonMounted(() => {\n  fetchPurchaseReturns();\n});\n</script>\n"],"mappings":"AA2EA,SAASA,GAAG,EAAEC,SAAS,QAAQ,KAAK;AACpC,OAAOC,KAAK,MAAM,OAAO;;;;;;;IAEzB,MAAMC,eAAe,GAAGH,GAAG,CAAC,EAAE,CAAC;IAC/B,MAAMI,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;;IAE3C;IACA,MAAMC,UAAU,GAAIC,OAAO,IAAK;MAC9B,IAAI,CAACA,OAAO,EAAE,OAAO,GAAG;MACxB,OAAO,IAAIC,IAAI,CAACD,OAAO,CAAC,CAACE,cAAc,CAAC,OAAO,CAAC;IAClD,CAAC;IAED,MAAMC,oBAAoB,GAAG,MAAAA,CAAA,KAAY;MACvC,IAAI;QACF,MAAMC,GAAG,GAAG,MAAMV,KAAK,CAACW,GAAG,CACzB,sEAAsE,EACtE;UACEC,OAAO,EAAE;YAAEC,aAAa,EAAE,UAAUX,KAAK;UAAG;QAC9C,CACF,CAAC;QACDY,OAAO,CAACC,GAAG,CAAC,aAAa,EAAEL,GAAG,CAACM,IAAI,CAAC,CAAC,CAAC;QACtCf,eAAe,CAACgB,KAAK,GAAGP,GAAG,CAACM,IAAI,CAACA,IAAI,IAAI,EAAE;MAC7C,CAAC,CAAC,OAAOE,GAAG,EAAE;QACZJ,OAAO,CAACK,KAAK,CAAC,yBAAyB,EAAED,GAAG,CAACE,QAAQ,EAAEJ,IAAI,IAAIE,GAAG,CAACG,OAAO,CAAC;MAC7E;IACF,CAAC;IAED,MAAMC,aAAa,GAAG,MAAOC,EAAE,IAAK;MAClC,IAAI;QACF,MAAMvB,KAAK,CAACwB,IAAI,CACd,+DAA+DD,EAAE,UAAU,EAC3E,CAAC,CAAC,EACF;UACEX,OAAO,EAAE;YAAEC,aAAa,EAAE,UAAUX,KAAK;UAAG;QAC9C,CACF,CAAC;QACDO,oBAAoB,CAAC,CAAC;MACxB,CAAC,CAAC,OAAOS,GAAG,EAAE;QACZJ,OAAO,CAACK,KAAK,CAAC,sBAAsB,EAAED,GAAG,CAACE,QAAQ,EAAEJ,IAAI,IAAIE,GAAG,CAACG,OAAO,CAAC;MAC1E;IACF,CAAC;IAED,MAAMI,YAAY,GAAG,MAAOF,EAAE,IAAK;MACjC,IAAI;QACF,MAAMvB,KAAK,CAACwB,IAAI,CACd,+DAA+DD,EAAE,SAAS,EAC1E,CAAC,CAAC,EACF;UACEX,OAAO,EAAE;YAAEC,aAAa,EAAE,UAAUX,KAAK;UAAG;QAC9C,CACF,CAAC;QACDO,oBAAoB,CAAC,CAAC;MACxB,CAAC,CAAC,OAAOS,GAAG,EAAE;QACZJ,OAAO,CAACK,KAAK,CAAC,qBAAqB,EAAED,GAAG,CAACE,QAAQ,EAAEJ,IAAI,IAAIE,GAAG,CAACG,OAAO,CAAC;MACzE;IACF,CAAC;IAEDtB,SAAS,CAAC,MAAM;MACdU,oBAAoB,CAAC,CAAC;IACxB,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}