{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = {\n  class: \"login-container\"\n};\nconst _hoisted_2 = {\n  class: \"form-group\"\n};\nconst _hoisted_3 = [\"disabled\"];\nconst _hoisted_4 = {\n  key: 0,\n  class: \"error-message\"\n};\nconst _hoisted_5 = {\n  class: \"form-group\"\n};\nconst _hoisted_6 = [\"disabled\"];\nconst _hoisted_7 = {\n  key: 0,\n  class: \"error-message\"\n};\nconst _hoisted_8 = {\n  key: 0,\n  class: \"error-message general-error\"\n};\nconst _hoisted_9 = [\"disabled\"];\nconst _hoisted_10 = {\n  key: 0\n};\nconst _hoisted_11 = {\n  key: 1\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"form\", {\n    onSubmit: _withModifiers($setup.handleLogin, [\"prevent\"]),\n    class: \"login-form\"\n  }, [_cache[4] || (_cache[4] = _createElementVNode(\"h2\", null, \"Sistem Penjualan - Login\", -1 /* CACHED */)), _createElementVNode(\"div\", _hoisted_2, [_cache[2] || (_cache[2] = _createElementVNode(\"label\", {\n    for: \"email\"\n  }, \"Email\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"email\",\n    id: \"email\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.email = $event),\n    required: \"\",\n    disabled: $setup.isLoading\n  }, null, 8 /* PROPS */, _hoisted_3), [[_vModelText, $setup.email]]), $setup.errors.email ? (_openBlock(), _createElementBlock(\"p\", _hoisted_4, _toDisplayString($setup.errors.email), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", _hoisted_5, [_cache[3] || (_cache[3] = _createElementVNode(\"label\", {\n    for: \"password\"\n  }, \"Password\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"password\",\n    id: \"password\",\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.password = $event),\n    required: \"\",\n    minlength: \"6\",\n    disabled: $setup.isLoading\n  }, null, 8 /* PROPS */, _hoisted_6), [[_vModelText, $setup.password]]), $setup.errors.password ? (_openBlock(), _createElementBlock(\"p\", _hoisted_7, _toDisplayString($setup.errors.password), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), $setup.generalError ? (_openBlock(), _createElementBlock(\"p\", _hoisted_8, _toDisplayString($setup.generalError), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"button\", {\n    type: \"submit\",\n    disabled: $setup.isLoading\n  }, [$setup.isLoading ? (_openBlock(), _createElementBlock(\"span\", _hoisted_10, \"Loading...\")) : (_openBlock(), _createElementBlock(\"span\", _hoisted_11, \"Login\"))], 8 /* PROPS */, _hoisted_9)], 32 /* NEED_HYDRATION */)]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","onSubmit","_withModifiers","$setup","handleLogin","_hoisted_2","for","type","id","email","$event","required","disabled","isLoading","errors","_hoisted_4","_toDisplayString","_hoisted_5","password","minlength","_hoisted_7","generalError","_hoisted_8","_hoisted_10","_hoisted_11"],"sources":["C:\\Users\\Personal\\Documents\\PKL\\aplikasi\\aplikasi\\src\\views\\LoginForm.vue"],"sourcesContent":["<template>\n  <div class=\"login-container\">\n    <form @submit.prevent=\"handleLogin\" class=\"login-form\">\n      <h2>Sistem Penjualan - Login</h2>\n\n      <div class=\"form-group\">\n        <label for=\"email\">Email</label>\n        <input\n          type=\"email\"\n          id=\"email\"\n          v-model=\"email\"\n          required\n          :disabled=\"isLoading\"\n        />\n        <p v-if=\"errors.email\" class=\"error-message\">{{ errors.email }}</p>\n      </div>\n\n      <div class=\"form-group\">\n        <label for=\"password\">Password</label>\n        <input\n          type=\"password\"\n          id=\"password\"\n          v-model=\"password\"\n          required\n          minlength=\"6\"\n          :disabled=\"isLoading\"\n        />\n        <p v-if=\"errors.password\" class=\"error-message\">\n          {{ errors.password }}\n        </p>\n      </div>\n\n      <p v-if=\"generalError\" class=\"error-message general-error\">\n        {{ generalError }}\n      </p>\n\n      <button type=\"submit\" :disabled=\"isLoading\">\n        <span v-if=\"isLoading\">Loading...</span>\n        <span v-else>Login</span>\n      </button>\n    </form>\n  </div>\n</template>\n\n<script setup>\nimport { ref } from \"vue\";\nimport router from \"@/router\"; // Asumsikan Anda menggunakan Vue Router\nimport apiClient from \"../services/api.js\"; // Import instance Axios yang sudah dibuat\n\n// State untuk formulir\nconst email = ref(\"\");\nconst password = ref(\"\");\n\n// State untuk UI dan Error Handling\nconst isLoading = ref(false);\nconst generalError = ref(\"\");\nconst errors = ref({\n  email: \"\",\n  password: \"\",\n});\n\n/**\n * Validasi sisi klien sederhana\n */\nconst validateForm = () => {\n  let isValid = true;\n  errors.value = { email: \"\", password: \"\" };\n\n  if (!email.value) {\n    errors.value.email = \"Email wajib diisi.\";\n    isValid = false;\n  }\n  // Tidak perlu validasi email yang kompleks di sini, biarkan backend yang mengurus\n\n  if (!password.value) {\n    errors.value.password = \"Password wajib diisi.\";\n    isValid = false;\n  } else if (password.value.length < 6) {\n    errors.value.password = \"Password minimal 6 karakter.\";\n    isValid = false;\n  }\n\n  return isValid;\n};\n\n/**\n * Menangani proses login\n */\nconst handleLogin = async () => {\n  generalError.value = \"\"; // Reset error\n\n  if (!validateForm()) {\n    return;\n  }\n\n  isLoading.value = true;\n\n  try {\n    const response = await apiClient.post(\"/auth/login\", {\n      email: email.value,\n      password: password.value,\n    });\n\n    // Asumsi: Backend mengembalikan { token: \"...\", name: \"...\", role: \"...\" }\n    const { token, name, role } = response.data;\n\n    // 1. Simpan token di Local Storage atau Vuex/Pinia (disarankan untuk manajemen state)\n    localStorage.setItem(\"userToken\", token);\n\n    // 2. Simpan detail user lainnya\n    localStorage.setItem(\"userName\", name);\n    localStorage.setItem(\"userRole\", role);\n\n    // 3. Konfigurasi Axios untuk menyertakan token di setiap request berikutnya\n    apiClient.defaults.headers.common[\"Authorization\"] = `Bearer ${token}`;\n\n    // 4. Redirect pengguna ke halaman dashboard berdasarkan role\n    if (role === \"OWNER\") {\n      router.push(\"/owner/dashboard\");\n    } else if (role === \"KASIR\") {\n      router.push(\"/kasir/dashboard\");\n    } else {\n      // Role lain atau default\n      router.push(\"/dashboard\");\n    }\n  } catch (error) {\n    // Tangani error dari API\n    if (error.response) {\n      // Error 400 (Bad Request) atau 401 (Unauthorized) dari backend Go Anda\n      // Pesan error dari backend akan ada di error.response.data.message atau serupa\n      const message =\n        error.response.data.message ||\n        \"Email atau password salah. Silakan coba lagi.\";\n      generalError.value = message;\n    } else if (error.request) {\n      // Permintaan dikirim tetapi tidak ada respons (mis. server down)\n      generalError.value =\n        \"Tidak dapat terhubung ke server. Silakan cek koneksi Anda.\";\n    } else {\n      // Kesalahan lain\n      generalError.value = \"Terjadi kesalahan tak terduga saat login.\";\n      console.error(error);\n    }\n  } finally {\n    isLoading.value = false;\n  }\n};\n</script>\n\n<style scoped>\n.login-container {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  min-height: 100vh;\n  background-color: #f4f7f6;\n}\n\n.login-form {\n  background: white;\n  padding: 40px;\n  border-radius: 8px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n  width: 100%;\n  max-width: 400px;\n}\n\nh2 {\n  text-align: center;\n  margin-bottom: 30px;\n  color: #333;\n}\n\n.form-group {\n  margin-bottom: 20px;\n}\n\nlabel {\n  display: block;\n  margin-bottom: 5px;\n  font-weight: bold;\n  color: #555;\n}\n\ninput {\n  width: 100%;\n  padding: 10px;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  box-sizing: border-box;\n}\n\ninput:focus {\n  border-color: #007bff;\n  outline: none;\n  box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);\n}\n\nbutton {\n  width: 100%;\n  padding: 12px;\n  background-color: #007bff;\n  color: white;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 16px;\n  transition: background-color 0.3s;\n}\n\nbutton:hover:not(:disabled) {\n  background-color: #0056b3;\n}\n\nbutton:disabled {\n  background-color: #a0c3e1;\n  cursor: not-allowed;\n}\n\n.error-message {\n  color: #dc3545;\n  font-size: 0.875em;\n  margin-top: 5px;\n}\n\n.general-error {\n  text-align: center;\n  font-weight: bold;\n  margin-bottom: 15px;\n  padding: 10px;\n  border: 1px solid #f5c6cb;\n  background-color: #f8d7da;\n  border-radius: 4px;\n}\n</style>\n"],"mappings":";;EACOA,KAAK,EAAC;AAAiB;;EAInBA,KAAK,EAAC;AAAY;;;;EASEA,KAAK,EAAC;;;EAG1BA,KAAK,EAAC;AAAY;;;;EAUKA,KAAK,EAAC;;;;EAKXA,KAAK,EAAC;;;;;;;;;;uBA/BjCC,mBAAA,CAwCM,OAxCNC,UAwCM,GAvCJC,mBAAA,CAsCO;IAtCAC,QAAM,EAAAC,cAAA,CAAUC,MAAA,CAAAC,WAAW;IAAEP,KAAK,EAAC;gCACxCG,mBAAA,CAAiC,YAA7B,0BAAwB,qBAE5BA,mBAAA,CAUM,OAVNK,UAUM,G,0BATJL,mBAAA,CAAgC;IAAzBM,GAAG,EAAC;EAAO,GAAC,OAAK,qB,gBACxBN,mBAAA,CAME;IALAO,IAAI,EAAC,OAAO;IACZC,EAAE,EAAC,OAAO;+DACDL,MAAA,CAAAM,KAAK,GAAAC,MAAA;IACdC,QAAQ,EAAR,EAAQ;IACPC,QAAQ,EAAET,MAAA,CAAAU;sDAFFV,MAAA,CAAAM,KAAK,E,GAIPN,MAAA,CAAAW,MAAM,CAACL,KAAK,I,cAArBX,mBAAA,CAAmE,KAAnEiB,UAAmE,EAAAC,gBAAA,CAAnBb,MAAA,CAAAW,MAAM,CAACL,KAAK,oB,qCAG9DT,mBAAA,CAaM,OAbNiB,UAaM,G,0BAZJjB,mBAAA,CAAsC;IAA/BM,GAAG,EAAC;EAAU,GAAC,UAAQ,qB,gBAC9BN,mBAAA,CAOE;IANAO,IAAI,EAAC,UAAU;IACfC,EAAE,EAAC,UAAU;+DACJL,MAAA,CAAAe,QAAQ,GAAAR,MAAA;IACjBC,QAAQ,EAAR,EAAQ;IACRQ,SAAS,EAAC,GAAG;IACZP,QAAQ,EAAET,MAAA,CAAAU;sDAHFV,MAAA,CAAAe,QAAQ,E,GAKVf,MAAA,CAAAW,MAAM,CAACI,QAAQ,I,cAAxBpB,mBAAA,CAEI,KAFJsB,UAEI,EAAAJ,gBAAA,CADCb,MAAA,CAAAW,MAAM,CAACI,QAAQ,oB,qCAIbf,MAAA,CAAAkB,YAAY,I,cAArBvB,mBAAA,CAEI,KAFJwB,UAEI,EAAAN,gBAAA,CADCb,MAAA,CAAAkB,YAAY,oB,mCAGjBrB,mBAAA,CAGS;IAHDO,IAAI,EAAC,QAAQ;IAAEK,QAAQ,EAAET,MAAA,CAAAU;MACnBV,MAAA,CAAAU,SAAS,I,cAArBf,mBAAA,CAAwC,QAAAyB,WAAA,EAAjB,YAAU,M,cACjCzB,mBAAA,CAAyB,QAAA0B,WAAA,EAAZ,OAAK,G","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}