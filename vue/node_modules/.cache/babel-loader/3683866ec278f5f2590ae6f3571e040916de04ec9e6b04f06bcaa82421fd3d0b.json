{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, vModelText as _vModelText, createElementVNode as _createElementVNode, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, withCtx as _withCtx, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"p-4\"\n};\nconst _hoisted_2 = {\n  class: \"flex gap-4 mb-4\"\n};\nconst _hoisted_3 = {\n  key: 0\n};\nconst _hoisted_4 = {\n  key: 1,\n  class: \"text-red-500\"\n};\nconst _hoisted_5 = {\n  class: \"min-w-full border\"\n};\nconst _hoisted_6 = {\n  class: \"border px-4 py-2\"\n};\nconst _hoisted_7 = {\n  class: \"border px-4 py-2\"\n};\nconst _hoisted_8 = {\n  class: \"border px-4 py-2\"\n};\nconst _hoisted_9 = {\n  class: \"border px-4 py-2\"\n};\nconst _hoisted_10 = {\n  key: 0\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createBlock($setup[\"OwnerLayout\"], null, {\n    default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_1, [_createCommentVNode(\" FILTER \"), _createElementVNode(\"div\", _hoisted_2, [_withDirectives(_createElementVNode(\"input\", {\n      type: \"date\",\n      \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.filters.startDate = $event),\n      class: \"border p-2 rounded\"\n    }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.filters.startDate]]), _withDirectives(_createElementVNode(\"input\", {\n      type: \"date\",\n      \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.filters.endDate = $event),\n      class: \"border p-2 rounded\"\n    }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.filters.endDate]]), _createElementVNode(\"button\", {\n      onClick: $setup.fetchReport,\n      class: \"bg-blue-500 text-white px-4 py-2 rounded\"\n    }, \" Filter \"), _createCommentVNode(\" EXPORT \"), _createElementVNode(\"button\", {\n      onClick: _cache[2] || (_cache[2] = $event => $setup.exportReport('csv')),\n      class: \"bg-green-500 text-white px-4 py-2 rounded\"\n    }, \" Export CSV \"), _createElementVNode(\"button\", {\n      onClick: _cache[3] || (_cache[3] = $event => $setup.exportReport('pdf')),\n      class: \"bg-red-500 text-white px-4 py-2 rounded\"\n    }, \" Export PDF \")]), _createCommentVNode(\" LOADING \"), $setup.loading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, \"Loading...\")) : $setup.error ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, _toDisplayString($setup.error), 1 /* TEXT */)) : (_openBlock(), _createElementBlock(_Fragment, {\n      key: 2\n    }, [_createCommentVNode(\" TABLE \"), _createElementVNode(\"table\", _hoisted_5, [_cache[5] || (_cache[5] = _createElementVNode(\"thead\", {\n      class: \"bg-gray-200\"\n    }, [_createElementVNode(\"tr\", null, [_createElementVNode(\"th\", {\n      class: \"border px-4 py-2\"\n    }, \"Tanggal\"), _createElementVNode(\"th\", {\n      class: \"border px-4 py-2\"\n    }, \"Nama Barang\"), _createElementVNode(\"th\", {\n      class: \"border px-4 py-2\"\n    }, \"Stok Sebelum\"), _createElementVNode(\"th\", {\n      class: \"border px-4 py-2\"\n    }, \"Stok Sesudah\")])], -1 /* CACHED */)), _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.reportData, (item, idx) => {\n      return _openBlock(), _createElementBlock(\"tr\", {\n        key: idx\n      }, [_createElementVNode(\"td\", _hoisted_6, _toDisplayString($setup.formatDate(item.date)), 1 /* TEXT */), _createElementVNode(\"td\", _hoisted_7, _toDisplayString(item.product_name), 1 /* TEXT */), _createElementVNode(\"td\", _hoisted_8, _toDisplayString(item.stock_before), 1 /* TEXT */), _createElementVNode(\"td\", _hoisted_9, _toDisplayString(item.stock_after), 1 /* TEXT */)]);\n    }), 128 /* KEYED_FRAGMENT */)), $setup.reportData.length === 0 ? (_openBlock(), _createElementBlock(\"tr\", _hoisted_10, [...(_cache[4] || (_cache[4] = [_createElementVNode(\"td\", {\n      colspan: \"4\",\n      class: \"text-center py-4 text-gray-500\"\n    }, \" Tidak ada data untuk ditampilkan \", -1 /* CACHED */)]))])) : _createCommentVNode(\"v-if\", true)])])], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */))])]),\n    _: 1 /* STABLE */\n  });\n}","map":{"version":3,"names":["class","_createBlock","$setup","_createElementVNode","_hoisted_1","_createCommentVNode","_hoisted_2","type","filters","startDate","$event","endDate","onClick","fetchReport","_cache","exportReport","loading","_createElementBlock","_hoisted_3","error","_hoisted_4","_toDisplayString","_Fragment","key","_hoisted_5","_renderList","reportData","item","idx","_hoisted_6","formatDate","date","_hoisted_7","product_name","_hoisted_8","stock_before","_hoisted_9","stock_after","length","_hoisted_10","colspan"],"sources":["C:\\Users\\Personal\\Documents\\PKL\\aplikasi\\aplikasi\\src\\views\\ReportStockOpnameOwners.vue"],"sourcesContent":["<template>\n  <OwnerLayout>\n    <div class=\"p-4\">\n      <!-- FILTER -->\n      <div class=\"flex gap-4 mb-4\">\n        <input\n          type=\"date\"\n          v-model=\"filters.startDate\"\n          class=\"border p-2 rounded\"\n        />\n        <input\n          type=\"date\"\n          v-model=\"filters.endDate\"\n          class=\"border p-2 rounded\"\n        />\n        <button\n          @click=\"fetchReport\"\n          class=\"bg-blue-500 text-white px-4 py-2 rounded\"\n        >\n          Filter\n        </button>\n\n        <!-- EXPORT -->\n        <button\n          @click=\"exportReport('csv')\"\n          class=\"bg-green-500 text-white px-4 py-2 rounded\"\n        >\n          Export CSV\n        </button>\n        <button\n          @click=\"exportReport('pdf')\"\n          class=\"bg-red-500 text-white px-4 py-2 rounded\"\n        >\n          Export PDF\n        </button>\n      </div>\n\n      <!-- LOADING -->\n      <div v-if=\"loading\">Loading...</div>\n      <div v-else-if=\"error\" class=\"text-red-500\">{{ error }}</div>\n\n      <!-- TABLE -->\n      <table v-else class=\"min-w-full border\">\n        <thead class=\"bg-gray-200\">\n          <tr>\n            <th class=\"border px-4 py-2\">Tanggal</th>\n            <th class=\"border px-4 py-2\">Nama Barang</th>\n            <th class=\"border px-4 py-2\">Stok Sebelum</th>\n            <th class=\"border px-4 py-2\">Stok Sesudah</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr v-for=\"(item, idx) in reportData\" :key=\"idx\">\n            <td class=\"border px-4 py-2\">{{ formatDate(item.date) }}</td>\n            <td class=\"border px-4 py-2\">{{ item.product_name }}</td>\n            <td class=\"border px-4 py-2\">{{ item.stock_before }}</td>\n            <td class=\"border px-4 py-2\">{{ item.stock_after }}</td>\n          </tr>\n          <tr v-if=\"reportData.length === 0\">\n            <td colspan=\"4\" class=\"text-center py-4 text-gray-500\">\n              Tidak ada data untuk ditampilkan\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n  </OwnerLayout>\n</template>\n\n<script setup>\nimport { ref, onMounted } from \"vue\";\nimport axios from \"axios\";\nimport OwnerLayout from \"../layouts/OwnerLayout.vue\"; // pastikan path ini sesuai\n\nconst filters = ref({\n  startDate: \"\",\n  endDate: \"\",\n});\n\nconst reportData = ref([]);\nconst loading = ref(false);\nconst error = ref(null);\n\n// fungsi format tanggal tanpa dayjs\nconst formatDate = (dateStr) => {\n  if (!dateStr) return \"-\";\n  const date = new Date(dateStr);\n  if (isNaN(date)) return dateStr; // fallback kalau backend kasih format aneh\n  return date.toLocaleDateString(\"id-ID\", {\n    year: \"numeric\",\n    month: \"long\",\n    day: \"numeric\",\n  });\n};\n\n// ambil data laporan\nconst fetchReport = async () => {\n  loading.value = true;\n  error.value = null;\n\n  try {\n    const response = await axios.get(\n      \"http://localhost:8081/api/v1/history/stock-opname\",\n      {\n        params: {\n          startDate: filters.value.startDate,\n          endDate: filters.value.endDate,\n        },\n      }\n    );\n\n    // backend golang biasanya bungkus di data.data atau langsung data\n    reportData.value = response.data.data || response.data || [];\n  } catch (err) {\n    console.error(\"Failed to fetch report data:\", err);\n    error.value = \"Gagal memuat data laporan.\";\n  } finally {\n    loading.value = false;\n  }\n};\n\n// export csv/pdf\nconst exportReport = async (type) => {\n  try {\n    const response = await axios.get(\n      `http://localhost:8081/api/v1/history/stock-opname?export=${type}`,\n      {\n        params: {\n          startDate: filters.value.startDate,\n          endDate: filters.value.endDate,\n        },\n        responseType: \"blob\", // biar bisa download file\n      }\n    );\n\n    const blob = new Blob([response.data], {\n      type: type === \"csv\" ? \"text/csv\" : \"application/pdf\",\n    });\n    const link = document.createElement(\"a\");\n    link.href = window.URL.createObjectURL(blob);\n    link.download = `stock-opname-report.${type}`;\n    link.click();\n  } catch (err) {\n    console.error(\"Export failed:\", err);\n    alert(\"Gagal export laporan\");\n  }\n};\n\nonMounted(fetchReport);\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}