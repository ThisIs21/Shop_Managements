{"ast":null,"code":"import { ref, onMounted } from \"vue\";\nimport axios from \"axios\";\nimport OwnerLayout from \"../components/OwnerLayouts.vue\";\nimport dayjs from \"dayjs\"; // Import dayjs untuk format tanggal\n\nexport default {\n  __name: 'ReportStockOpnameOwners',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const filters = ref({\n      startDate: \"\",\n      endDate: \"\"\n    });\n    const data = ref([]);\n    const page = ref(1);\n    const size = ref(10);\n    const total = ref(0);\n\n    // Ambil token dari localStorage\n    const token = localStorage.getItem(\"token\");\n\n    // Fungsi untuk format tanggal\n    const formatDate = dateString => {\n      return dayjs(dateString).format('YYYY-MM-DD');\n    };\n\n    // Fungsi untuk mengambil data dari backend\n    const fetchData = async () => {\n      try {\n        const params = {\n          page: page.value,\n          size: size.value\n        };\n        if (filters.value.startDate) params.start_date = filters.value.startDate;\n        if (filters.value.endDate) params.end_date = filters.value.endDate;\n        const res = await axios.get(\"http://localhost:8081/api/v1/history/stock-opnames\", {\n          headers: token ? {\n            Authorization: `Bearer ${token}`\n          } : undefined,\n          params\n        });\n        data.value = res.data.data; // Array StockOpname\n        page.value = res.data.page;\n        size.value = res.data.size;\n        total.value = res.data.total;\n      } catch (err) {\n        console.error(\"Gagal ambil data:\", err);\n        data.value = []; // Reset data jika gagal\n        page.value = 1;\n        size.value = 10;\n        total.value = 0;\n      }\n    };\n\n    // Ambil data saat komponen dimuat\n    onMounted(fetchData);\n\n    // Terapkan filter dan ambil ulang data (reset page ke 1)\n    const applyFilter = () => {\n      page.value = 1; // Reset ke halaman pertama saat filter\n      fetchData();\n    };\n    const __returned__ = {\n      filters,\n      data,\n      page,\n      size,\n      total,\n      token,\n      formatDate,\n      fetchData,\n      applyFilter,\n      ref,\n      onMounted,\n      get axios() {\n        return axios;\n      },\n      OwnerLayout,\n      get dayjs() {\n        return dayjs;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","axios","OwnerLayout","dayjs","filters","startDate","endDate","data","page","size","total","token","localStorage","getItem","formatDate","dateString","format","fetchData","params","value","start_date","end_date","res","get","headers","Authorization","undefined","err","console","error","applyFilter"],"sources":["C:/Users/Personal/Documents/PKL/aplikasi/aplikasi/src/views/ReportStockOpnameOwners.vue"],"sourcesContent":["<template>\n  <OwnerLayout>\n    <div class=\"p-4\">\n      <!-- FILTER -->\n      <div class=\"flex gap-4 mb-4\">\n        <input\n          type=\"date\"\n          v-model=\"filters.startDate\"\n          class=\"border p-2 rounded\"\n        />\n        <input\n          type=\"date\"\n          v-model=\"filters.endDate\"\n          class=\"border p-2 rounded\"\n        />\n        <button\n          @click=\"applyFilter\"\n          class=\"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700\"\n        >\n          Terapkan\n        </button>\n      </div>\n\n      <!-- PAGINATION INFO (Optional, based on response) -->\n      <div class=\"mb-4 text-sm text-gray-600\">\n        Halaman {{ page }} dari total {{ total }} data (ukuran per halaman: {{ size }})\n      </div>\n\n      <!-- TABLE -->\n      <table class=\"w-full border-collapse border border-gray-300\">\n        <thead>\n          <tr class=\"bg-gray-100\">\n            <th class=\"border border-gray-300 px-4 py-2\">Tanggal</th>\n            <th class=\"border border-gray-300 px-4 py-2\">Nama Barang</th>\n            <th class=\"border border-gray-300 px-4 py-2\">Stok Awal</th>\n            <th class=\"border border-gray-300 px-4 py-2\">Stok Akhir</th>\n          </tr>\n        </thead>\n        <tbody>\n          <template v-for=\"(opname, opnameIndex) in data\" :key=\"opnameIndex\">\n            <tr v-if=\"!opname.Items || opname.Items.length === 0\">\n              <td class=\"border border-gray-300 px-4 py-2\">{{ formatDate(opname.Date) }}</td>\n              <td class=\"border border-gray-300 px-4 py-2\" colspan=\"3\">Tidak ada item</td>\n            </tr>\n            <tr v-for=\"(item, itemIndex) in opname.Items\" :key=\"`${opnameIndex}-${itemIndex}`\">\n              <td class=\"border border-gray-300 px-4 py-2\">{{ formatDate(opname.Date) }}</td>\n              <td class=\"border border-gray-300 px-4 py-2\">\n                {{ item.Product?.Name || 'N/A' }}\n              </td>\n              <td class=\"border border-gray-300 px-4 py-2\">\n                {{ item.QtySystem || 0 }}\n              </td>\n              <td class=\"border border-gray-300 px-4 py-2\">\n                {{ item.QtyPhysical || 0 }}\n              </td>\n            </tr>\n          </template>\n          <tr v-if=\"data.length === 0\">\n            <td colspan=\"4\" class=\"text-center py-4 text-gray-500\">\n              Tidak ada data\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n  </OwnerLayout>\n</template>\n\n<script setup>\nimport { ref, onMounted } from \"vue\";\nimport axios from \"axios\";\nimport OwnerLayout from \"../components/OwnerLayouts.vue\";\nimport dayjs from \"dayjs\"; // Import dayjs untuk format tanggal\n\nconst filters = ref({\n  startDate: \"\",\n  endDate: \"\",\n});\n\nconst data = ref([]);\nconst page = ref(1);\nconst size = ref(10);\nconst total = ref(0);\n\n// Ambil token dari localStorage\nconst token = localStorage.getItem(\"token\");\n\n// Fungsi untuk format tanggal\nconst formatDate = (dateString) => {\n  return dayjs(dateString).format('YYYY-MM-DD');\n};\n\n// Fungsi untuk mengambil data dari backend\nconst fetchData = async () => {\n  try {\n    const params = {\n      page: page.value,\n      size: size.value,\n    };\n    if (filters.value.startDate) params.start_date = filters.value.startDate;\n    if (filters.value.endDate) params.end_date = filters.value.endDate;\n\n    const res = await axios.get(\n      \"http://localhost:8081/api/v1/history/stock-opnames\",\n      {\n        headers: token ? { Authorization: `Bearer ${token}` } : undefined,\n        params,\n      }\n    );\n    data.value = res.data.data; // Array StockOpname\n    page.value = res.data.page;\n    size.value = res.data.size;\n    total.value = res.data.total;\n  } catch (err) {\n    console.error(\"Gagal ambil data:\", err);\n    data.value = []; // Reset data jika gagal\n    page.value = 1;\n    size.value = 10;\n    total.value = 0;\n  }\n};\n\n// Ambil data saat komponen dimuat\nonMounted(fetchData);\n\n// Terapkan filter dan ambil ulang data (reset page ke 1)\nconst applyFilter = () => {\n  page.value = 1; // Reset ke halaman pertama saat filter\n  fetchData();\n};\n</script>"],"mappings":"AAqEA,SAASA,GAAG,EAAEC,SAAS,QAAQ,KAAK;AACpC,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAOC,WAAW,MAAM,gCAAgC;AACxD,OAAOC,KAAK,MAAM,OAAO,CAAC,CAAC;;;;;;;;IAE3B,MAAMC,OAAO,GAAGL,GAAG,CAAC;MAClBM,SAAS,EAAE,EAAE;MACbC,OAAO,EAAE;IACX,CAAC,CAAC;IAEF,MAAMC,IAAI,GAAGR,GAAG,CAAC,EAAE,CAAC;IACpB,MAAMS,IAAI,GAAGT,GAAG,CAAC,CAAC,CAAC;IACnB,MAAMU,IAAI,GAAGV,GAAG,CAAC,EAAE,CAAC;IACpB,MAAMW,KAAK,GAAGX,GAAG,CAAC,CAAC,CAAC;;IAEpB;IACA,MAAMY,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;;IAE3C;IACA,MAAMC,UAAU,GAAIC,UAAU,IAAK;MACjC,OAAOZ,KAAK,CAACY,UAAU,CAAC,CAACC,MAAM,CAAC,YAAY,CAAC;IAC/C,CAAC;;IAED;IACA,MAAMC,SAAS,GAAG,MAAAA,CAAA,KAAY;MAC5B,IAAI;QACF,MAAMC,MAAM,GAAG;UACbV,IAAI,EAAEA,IAAI,CAACW,KAAK;UAChBV,IAAI,EAAEA,IAAI,CAACU;QACb,CAAC;QACD,IAAIf,OAAO,CAACe,KAAK,CAACd,SAAS,EAAEa,MAAM,CAACE,UAAU,GAAGhB,OAAO,CAACe,KAAK,CAACd,SAAS;QACxE,IAAID,OAAO,CAACe,KAAK,CAACb,OAAO,EAAEY,MAAM,CAACG,QAAQ,GAAGjB,OAAO,CAACe,KAAK,CAACb,OAAO;QAElE,MAAMgB,GAAG,GAAG,MAAMrB,KAAK,CAACsB,GAAG,CACzB,oDAAoD,EACpD;UACEC,OAAO,EAAEb,KAAK,GAAG;YAAEc,aAAa,EAAE,UAAUd,KAAK;UAAG,CAAC,GAAGe,SAAS;UACjER;QACF,CACF,CAAC;QACDX,IAAI,CAACY,KAAK,GAAGG,GAAG,CAACf,IAAI,CAACA,IAAI,CAAC,CAAC;QAC5BC,IAAI,CAACW,KAAK,GAAGG,GAAG,CAACf,IAAI,CAACC,IAAI;QAC1BC,IAAI,CAACU,KAAK,GAAGG,GAAG,CAACf,IAAI,CAACE,IAAI;QAC1BC,KAAK,CAACS,KAAK,GAAGG,GAAG,CAACf,IAAI,CAACG,KAAK;MAC9B,CAAC,CAAC,OAAOiB,GAAG,EAAE;QACZC,OAAO,CAACC,KAAK,CAAC,mBAAmB,EAAEF,GAAG,CAAC;QACvCpB,IAAI,CAACY,KAAK,GAAG,EAAE,CAAC,CAAC;QACjBX,IAAI,CAACW,KAAK,GAAG,CAAC;QACdV,IAAI,CAACU,KAAK,GAAG,EAAE;QACfT,KAAK,CAACS,KAAK,GAAG,CAAC;MACjB;IACF,CAAC;;IAED;IACAnB,SAAS,CAACiB,SAAS,CAAC;;IAEpB;IACA,MAAMa,WAAW,GAAGA,CAAA,KAAM;MACxBtB,IAAI,CAACW,KAAK,GAAG,CAAC,CAAC,CAAC;MAChBF,SAAS,CAAC,CAAC;IACb,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}