{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport { ref, computed, onMounted, watch } from \"vue\";\nimport axios from \"axios\";\nimport PurchasingSidebar from \"@/components/PurchasingSidebar.vue\";\n\n// State\n\nexport default {\n  __name: 'PurchaseReturn',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const purchaseOrders = ref([]);\n    const startDate = ref(\"\");\n    const endDate = ref(\"\");\n    const selectedPurchase = ref(null);\n    const showDetailsModal = ref(false);\n    const poItems = ref([]);\n    const additionalNotes = ref(\"\");\n    const selectedPOs = ref([]);\n    const token = localStorage.getItem(\"token\");\n\n    // Format functions\n    const formatPONumber = id => `PO-${String(id).padStart(3, \"0\")}`;\n    const formatDate = dateStr => {\n      if (!dateStr) return \"-\";\n      return new Date(dateStr).toLocaleDateString(\"id-ID\", {\n        day: \"2-digit\",\n        month: \"short\",\n        year: \"numeric\"\n      });\n    };\n    const formatCurrency = val => {\n      if (val === null || val === undefined) return \"-\";\n      return new Intl.NumberFormat(\"id-ID\", {\n        style: \"currency\",\n        currency: \"IDR\",\n        minimumFractionDigits: 0\n      }).format(val);\n    };\n    const getStatusText = status => {\n      switch (status) {\n        case \"SUBMITTED\":\n          return \"Submitted\";\n        case \"APPROVED\":\n          return \"Approved\";\n        case \"REJECTED\":\n          return \"Rejected\";\n        case \"DRAFT\":\n          return \"Draft\";\n        default:\n          return status || \"-\";\n      }\n    };\n\n    // Fetch purchase orders\n    const fetchPurchaseOrders = async () => {\n      if (!token) {\n        console.error(\"Token not found. Please log in.\");\n        return;\n      }\n      try {\n        const response = await axios.get(\"http://localhost:8081/api/v1/pembelian/purchases?status=APPROVED\", {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        console.log(\"API Response (fetchPurchaseOrders):\", response.data);\n        purchaseOrders.value = response.data.data.data || [];\n        selectedPOs.value = []; // Reset selected POs when fetching new data\n      } catch (error) {\n        console.error(\"Failed to fetch purchase orders:\", error);\n      }\n    };\n\n    // Filter berdasarkan tanggal\n    const filteredPurchaseOrders = computed(() => {\n      if (!startDate.value && !endDate.value) return purchaseOrders.value;\n      return purchaseOrders.value.filter(po => {\n        const poDate = new Date(po.created_at); // Sesuaikan dengan field waktu dari API\n        const start = startDate.value ? new Date(startDate.value) : null;\n        const end = endDate.value ? new Date(endDate.value) : null;\n        if (start && end) {\n          return poDate >= start && poDate <= end;\n        } else if (start) {\n          return poDate >= start;\n        } else if (end) {\n          return poDate <= end;\n        }\n        return true;\n      });\n    });\n\n    // View details\n    const viewDetails = async id => {\n      if (!id) {\n        alert(\"Invalid purchase ID.\");\n        return;\n      }\n      try {\n        const res = await axios.get(`http://localhost:8081/api/v1/pembelian/purchases/${id}`, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        console.log(\"Purchase Details Response (View):\", res.data);\n        selectedPurchase.value = res.data.data;\n        poItems.value = (res.data.data.Items || []).map(item => ({\n          ...item,\n          returnQty: 0,\n          reason: \"\"\n        }));\n        showDetailsModal.value = true;\n      } catch (err) {\n        console.error(\"Failed to fetch purchase details:\", err);\n        alert(`Failed to fetch purchase details: ${err.response?.status || \"Unknown\"} - ${err.response?.data?.error || err.message || \"Network error\"}`);\n      }\n    };\n    const closeDetailsModal = () => {\n      showDetailsModal.value = false;\n      selectedPurchase.value = null;\n      poItems.value = [];\n    };\n\n    // Watch selectedPOs to auto-fetch details of the first selected PO\n    watch(selectedPOs, newSelectedPOs => {\n      if (newSelectedPOs.length > 0) {\n        viewDetails(newSelectedPOs[0]); // Auto-load details of the first selected PO\n      } else {\n        selectedPurchase.value = null;\n        poItems.value = [];\n      }\n    });\n\n    // Submit return request\n    const submitReturnRequest = async () => {\n      if (selectedPOs.value.length === 0) {\n        alert(\"Please select at least one purchase order.\");\n        return;\n      }\n      const returnItemsPayload = poItems.value.filter(item => item.returnQty > 0).map(item => ({\n        purchase_item_id: item.ID,\n        product_id: item.ProductID,\n        qty: item.returnQty,\n        reason: item.reason\n      }));\n      if (returnItemsPayload.length === 0) {\n        alert(\"Please select at least one item to return.\");\n        return;\n      }\n      try {\n        const payload = {\n          purchase_id: selectedPurchase.value.ID,\n          return_date: new Date().toISOString(),\n          notes: additionalNotes.value,\n          items: returnItemsPayload\n        };\n        const response = await axios.post(\"http://localhost:8081/api/v1/pembelian/purchase-returns\", payload, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        console.log(\"Return request submitted:\", response.data);\n        alert(\"Permintaan retur berhasil diajukan!\");\n        closeDetailsModal();\n        await fetchPurchaseOrders(); // Refresh list after submission\n        additionalNotes.value = \"\";\n        selectedPOs.value = []; // Reset selection\n      } catch (error) {\n        console.error(\"Failed to submit return request:\", error.response ? error.response.data : error.message);\n        alert(\"Gagal mengajukan permintaan retur.\");\n      }\n    };\n    onMounted(() => {\n      fetchPurchaseOrders();\n    });\n    const __returned__ = {\n      purchaseOrders,\n      startDate,\n      endDate,\n      selectedPurchase,\n      showDetailsModal,\n      poItems,\n      additionalNotes,\n      selectedPOs,\n      token,\n      formatPONumber,\n      formatDate,\n      formatCurrency,\n      getStatusText,\n      fetchPurchaseOrders,\n      filteredPurchaseOrders,\n      viewDetails,\n      closeDetailsModal,\n      submitReturnRequest,\n      ref,\n      computed,\n      onMounted,\n      watch,\n      get axios() {\n        return axios;\n      },\n      PurchasingSidebar\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","watch","axios","PurchasingSidebar","purchaseOrders","startDate","endDate","selectedPurchase","showDetailsModal","poItems","additionalNotes","selectedPOs","token","localStorage","getItem","formatPONumber","id","String","padStart","formatDate","dateStr","Date","toLocaleDateString","day","month","year","formatCurrency","val","undefined","Intl","NumberFormat","style","currency","minimumFractionDigits","format","getStatusText","status","fetchPurchaseOrders","console","error","response","get","headers","Authorization","log","data","value","filteredPurchaseOrders","filter","po","poDate","created_at","start","end","viewDetails","alert","res","Items","map","item","returnQty","reason","err","message","closeDetailsModal","newSelectedPOs","length","submitReturnRequest","returnItemsPayload","purchase_item_id","ID","product_id","ProductID","qty","payload","purchase_id","return_date","toISOString","notes","items","post"],"sources":["C:/Users/Personal/Documents/PKL/aplikasi/aplikasi/src/views/PurchaseReturn.vue"],"sourcesContent":["<template>\n  <div\n    class=\"relative flex size-full min-h-screen flex-col bg-white group/design-root overflow-x-hidden\"\n    style=\"\n      --select-button-svg: url('data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2724px%27 height=%2724px%27 fill=%27rgb(96,117,138)%27 viewBox=%270 0 256 256%27%3e%3cpath d=%27M181.66,170.34a8,8,0,0,1,0,11.32l-48,48a8,8,0,0,1-11.32,0l-48-48a8,8,0,0,1,11.32-11.32L128,212.69l42.34-42.35A8,8,0,0,1,181.66,170.34Zm-96-84.68L128,43.31l42.34,42.35a8,8,0,0,0,11.32-11.32l-48-48a8,8,0,0,0-11.32,0l-48,48A8,8,0,0,0,85.66,85.66Z%27%3e%3c/path%3e%3c/svg%3e');\n      font-family: Manrope, 'Noto Sans', sans-serif;\n    \"\n  >\n    <div class=\"layout-container flex h-full grow\">\n      <PurchasingSidebar />\n\n      <div class=\"layout-content-container flex flex-col flex-1\">\n        <div class=\"flex flex-wrap justify-between gap-3 p-4\">\n          <p\n            class=\"text-[#111418] tracking-light text-[32px] font-bold leading-tight min-w-72\"\n          >\n            Create Return Request\n          </p>\n        </div>\n\n        <!-- Filter Tanggal -->\n        <div class=\"flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3\">\n          <label class=\"flex flex-col min-w-40 flex-1\">\n            <p class=\"text-[#111418] text-base font-medium leading-normal pb-2\">\n              Start Date\n            </p>\n            <input\n              type=\"date\"\n              v-model=\"startDate\"\n              class=\"form-input rounded-lg border border-[#dbe0e6] p-2 text-sm\"\n              @change=\"filterPurchaseOrders\"\n            />\n          </label>\n          <label class=\"flex flex-col min-w-40 flex-1\">\n            <p class=\"text-[#111418] text-base font-medium leading-normal pb-2\">\n              End Date\n            </p>\n            <input\n              type=\"date\"\n              v-model=\"endDate\"\n              class=\"form-input rounded-lg border border-[#dbe0e6] p-2 text-sm\"\n              @change=\"filterPurchaseOrders\"\n            />\n          </label>\n        </div>\n\n        <!-- Tabel Purchase Orders -->\n        <h3\n          class=\"text-[#111418] text-lg font-bold leading-tight tracking-[-0.015em] px-4 pb-2 pt-4\"\n        >\n          Approved Purchase Orders\n        </h3>\n        <div class=\"px-4 py-3 @container\">\n          <div\n            class=\"flex overflow-hidden rounded-lg border border-[#dbe0e6] bg-white\"\n          >\n            <table class=\"flex-1 w-full\">\n              <thead>\n                <tr class=\"bg-white\">\n                  <th\n                    class=\"px-4 py-3 text-left text-[#111418] w-[80px] text-sm font-medium leading-normal\"\n                  >\n                    Select\n                  </th>\n                  <th\n                    class=\"px-4 py-3 text-left text-[#111418] w-[120px] text-sm font-medium leading-normal\"\n                  >\n                    PO Number\n                  </th>\n                  <th\n                    class=\"px-4 py-3 text-left text-[#111418] w-[200px] text-sm font-medium leading-normal\"\n                  >\n                    Supplier\n                  </th>\n                  <th\n                    class=\"px-4 py-3 text-left text-[#111418] w-[150px] text-sm font-medium leading-normal\"\n                  >\n                    Date\n                  </th>\n                  <th\n                    class=\"px-4 py-3 text-left text-[#111418] w-[150px] text-sm font-medium leading-normal\"\n                  >\n                    Total\n                  </th>\n                  <th\n                    class=\"px-4 py-3 text-left text-[#111418] w-[120px] text-sm font-medium leading-normal\"\n                  >\n                    Actions\n                  </th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr\n                  v-for=\"po in filteredPurchaseOrders\"\n                  :key=\"po.ID\"\n                  class=\"border-t border-t-[#dbe0e6]\"\n                >\n                  <td class=\"h-[72px] px-4 py-2 text-[#60758a] text-sm\">\n                    <input\n                      type=\"checkbox\"\n                      v-model=\"selectedPOs\"\n                      :value=\"po.ID\"\n                      class=\"form-checkbox rounded border-[#dbe0e6]\"\n                    />\n                  </td>\n                  <td class=\"h-[72px] px-4 py-2 text-[#111418] text-sm\">\n                    {{ formatPONumber(po.ID) }}\n                  </td>\n                  <td class=\"h-[72px] px-4 py-2 text-[#60758a] text-sm\">\n                    {{ po.Supplier?.name || \"-\" }}\n                  </td>\n                  <td class=\"h-[72px] px-4 py-2 text-[#60758a] text-sm\">\n                    {{ formatDate(po.created_at) }}\n                  </td>\n                  <td class=\"h-[72px] px-4 py-2 text-[#60758a] text-sm\">\n                    {{ formatCurrency(po.Total) }}\n                  </td>\n                  <td class=\"h-[72px] px-4 py-2 text-sm font-bold\">\n                    <button\n                      @click=\"viewDetails(po.ID)\"\n                      class=\"px-3 py-1 bg-blue-500 text-white rounded text-xs hover:bg-blue-600\"\n                    >\n                      View Details\n                    </button>\n                  </td>\n                </tr>\n                <tr v-if=\"filteredPurchaseOrders.length === 0\">\n                  <td\n                    colspan=\"6\"\n                    class=\"text-center py-4 text-[#60758a] text-sm\"\n                  >\n                    No purchase orders found\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n\n        <!-- View Details Modal -->\n        <div\n          v-if=\"showDetailsModal\"\n          class=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\"\n        >\n          <div\n            class=\"bg-white rounded-lg p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto\"\n          >\n            <div class=\"flex justify-between items-center mb-4\">\n              <h2 class=\"text-xl font-bold\">Purchase Order Details</h2>\n              <button\n                @click=\"closeDetailsModal\"\n                class=\"text-gray-500 hover:text-gray-700 text-xl\"\n              >\n                &times;\n              </button>\n            </div>\n            <div v-if=\"selectedPurchase\" class=\"space-y-4\">\n              <p>\n                <strong>PO Number:</strong>\n                {{ formatPONumber(selectedPurchase.ID) }}\n              </p>\n              <p>\n                <strong>Supplier:</strong>\n                {{ selectedPurchase.Supplier?.name || \"-\" }}\n              </p>\n              <p>\n                <strong>Date:</strong>\n                {{ formatDate(selectedPurchase.created_at) }}\n              </p>\n              <p>\n                <strong>Total:</strong>\n                {{ formatCurrency(selectedPurchase.Total) }}\n              </p>\n              <p>\n                <strong>Status:</strong>\n                {{ getStatusText(selectedPurchase.Status) }}\n              </p>\n              <p>\n                <strong>Requested By:</strong> User ID\n                {{ selectedPurchase.UserID || \"-\" }}\n              </p>\n              <p v-if=\"selectedPurchase.ApprovedBy\">\n                <strong>Approved By:</strong> User ID\n                {{ selectedPurchase.ApprovedBy }}\n              </p>\n              <p v-if=\"selectedPurchase.ApprovedAt\">\n                <strong>Approved At:</strong>\n                {{ formatDate(selectedPurchase.ApprovedAt) }}\n              </p>\n\n              <h3 class=\"text-lg font-semibold mt-4\">Purchase Items</h3>\n              <div class=\"overflow-x-auto\">\n                <table class=\"min-w-full bg-white border border-gray-300\">\n                  <thead>\n                    <tr class=\"bg-gray-100\">\n                      <th class=\"px-4 py-2 text-left text-gray-600\">Product</th>\n                      <th class=\"px-4 py-2 text-left text-gray-600\">\n                        Quantity\n                      </th>\n                      <th class=\"px-4 py-2 text-left text-gray-600\">Price</th>\n                      <th class=\"px-4 py-2 text-left text-gray-600\">\n                        Subtotal\n                      </th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    <tr\n                      v-for=\"(item, index) in selectedPurchase.Items\"\n                      :key=\"index\"\n                      class=\"border-t border-gray-300\"\n                    >\n                      <td class=\"px-4 py-2 text-gray-700\">\n                        {{ item.Product?.name || \"-\" }}\n                      </td>\n                      <td class=\"px-4 py-2 text-gray-700\">\n                        {{ item.Qty || \"-\" }}\n                      </td>\n                      <td class=\"px-4 py-2 text-gray-700\">\n                        {{ formatCurrency(item.Price) }}\n                      </td>\n                      <td class=\"px-4 py-2 text-gray-700\">\n                        {{ formatCurrency(item.Subtotal) }}\n                      </td>\n                    </tr>\n                    <tr\n                      v-if=\"\n                        !selectedPurchase.Items ||\n                        selectedPurchase.Items.length === 0\n                      \"\n                    >\n                      <td\n                        colspan=\"4\"\n                        class=\"px-4 py-2 text-center text-gray-700\"\n                      >\n                        No items found\n                      </td>\n                    </tr>\n                  </tbody>\n                </table>\n              </div>\n            </div>\n            <div v-else class=\"text-red-500\">\n              No data available for this purchase.\n            </div>\n          </div>\n        </div>\n\n        <!-- Tabel Return Items -->\n        <h3\n          class=\"text-[#111418] text-lg font-bold leading-tight tracking-[-0.015em] px-4 pb-2 pt-4\"\n        >\n          Return Items\n        </h3>\n        <div class=\"px-4 py-3 @container\">\n          <div\n            class=\"flex overflow-hidden rounded-lg border border-[#dbe0e6] bg-white\"\n          >\n            <table class=\"flex-1\">\n              <thead>\n                <tr class=\"bg-white\">\n                  <th\n                    class=\"table-fdf173fd-e234-463e-aee5-60e5b04a682e-column-120 px-4 py-3 text-left text-[#111418] w-[400px] text-sm font-medium leading-normal\"\n                  >\n                    Product\n                  </th>\n                  <th\n                    class=\"table-fdf173fd-e234-463e-aee5-60e5b04a682e-column-240 px-4 py-3 text-left text-[#111414] w-[400px] text-sm font-medium leading-normal\"\n                  >\n                    Quantity\n                  </th>\n                  <th\n                    class=\"table-fdf173fd-e234-463e-aee5-60e5b04a682e-column-360 px-4 py-3 text-left text-[#111418] w-[400px] text-sm font-medium leading-normal\"\n                  >\n                    Return Quantity\n                  </th>\n                  <th\n                    class=\"table-fdf173fd-e234-463e-aee5-60e5b04a682e-column-480 px-4 py-3 text-left text-[#111418] w-[400px] text-sm font-medium leading-normal\"\n                  >\n                    Reason\n                  </th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr\n                  v-for=\"item in poItems\"\n                  :key=\"item.ID\"\n                  class=\"border-t border-t-[#dbe0e6]\"\n                >\n                  <td\n                    class=\"table-fdf173fd-e234-463e-aee5-60e5b04a682e-column-120 h-[72px] px-4 py-2 w-[400px] text-[#111418] text-sm font-normal leading-normal\"\n                  >\n                    {{ item.Product?.name || \"-\" }}\n                  </td>\n                  <td\n                    class=\"table-fdf173fd-e234-463e-aee5-60e5b04a682e-column-240 h-[72px] px-4 py-2 w-[400px] text-[#60758a] text-sm font-normal leading-normal\"\n                  >\n                    {{ item.Qty }}\n                  </td>\n                  <td\n                    class=\"table-fdf173fd-e234-463e-aee5-60e5b04a682e-column-360 h-[72px] px-4 py-2 w-[400px] text-[#60758a] text-sm font-normal leading-normal\"\n                  >\n                    <input\n                      type=\"number\"\n                      v-model.number=\"item.returnQty\"\n                      min=\"0\"\n                      :max=\"item.Qty\"\n                      class=\"form-input rounded-lg border border-[#dbe0e6] p-2 text-sm\"\n                    />\n                  </td>\n                  <td\n                    class=\"table-fdf173fd-e234-463e-aee5-60e5b04a682e-column-480 h-[72px] px-4 py-2 w-[400px] text-[#60758a] text-sm font-normal leading-normal\"\n                  >\n                    <input\n                      type=\"text\"\n                      v-model=\"item.reason\"\n                      placeholder=\"Reason for return\"\n                      class=\"form-input rounded-lg border border-[#dbe0e6] p-2 text-sm\"\n                    />\n                  </td>\n                </tr>\n                <tr v-if=\"poItems.length === 0\">\n                  <td\n                    colspan=\"4\"\n                    class=\"text-center py-4 text-[#60758a] text-sm\"\n                  >\n                    No return items available\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n\n        <div class=\"flex max-w-[480px] flex-wrap items-end gap-4 px-4 py-3\">\n          <label class=\"flex flex-col min-w-40 flex-1\">\n            <p class=\"text-[#111418] text-base font-medium leading-normal pb-2\">\n              Additional Notes\n            </p>\n            <textarea\n              placeholder=\"Enter any additional notes\"\n              class=\"form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-[#111418] focus:outline-0 focus:ring-0 border border-[#dbe0e6] bg-white focus:border-[#dbe0e6] min-h-36 placeholder:text-[#60758a] p-[15px] text-base font-normal leading-normal\"\n              v-model=\"additionalNotes\"\n            ></textarea>\n          </label>\n        </div>\n\n        <div class=\"flex px-4 py-3 justify-end\">\n          <button\n            class=\"flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-[#0d80f2] text-white text-sm font-bold leading-normal tracking-[0.015em]\"\n            @click=\"submitReturnRequest\"\n            :disabled=\"selectedPOs.length === 0 || poItems.length === 0\"\n          >\n            <span class=\"truncate\">Submit Return Request</span>\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted, watch } from \"vue\";\nimport axios from \"axios\";\nimport PurchasingSidebar from \"@/components/PurchasingSidebar.vue\";\n\n// State\nconst purchaseOrders = ref([]);\nconst startDate = ref(\"\");\nconst endDate = ref(\"\");\nconst selectedPurchase = ref(null);\nconst showDetailsModal = ref(false);\nconst poItems = ref([]);\nconst additionalNotes = ref(\"\");\nconst selectedPOs = ref([]);\nconst token = localStorage.getItem(\"token\");\n\n// Format functions\nconst formatPONumber = (id) => `PO-${String(id).padStart(3, \"0\")}`;\nconst formatDate = (dateStr) => {\n  if (!dateStr) return \"-\";\n  return new Date(dateStr).toLocaleDateString(\"id-ID\", {\n    day: \"2-digit\",\n    month: \"short\",\n    year: \"numeric\",\n  });\n};\nconst formatCurrency = (val) => {\n  if (val === null || val === undefined) return \"-\";\n  return new Intl.NumberFormat(\"id-ID\", {\n    style: \"currency\",\n    currency: \"IDR\",\n    minimumFractionDigits: 0,\n  }).format(val);\n};\nconst getStatusText = (status) => {\n  switch (status) {\n    case \"SUBMITTED\":\n      return \"Submitted\";\n    case \"APPROVED\":\n      return \"Approved\";\n    case \"REJECTED\":\n      return \"Rejected\";\n    case \"DRAFT\":\n      return \"Draft\";\n    default:\n      return status || \"-\";\n  }\n};\n\n// Fetch purchase orders\nconst fetchPurchaseOrders = async () => {\n  if (!token) {\n    console.error(\"Token not found. Please log in.\");\n    return;\n  }\n\n  try {\n    const response = await axios.get(\n      \"http://localhost:8081/api/v1/pembelian/purchases?status=APPROVED\",\n      {\n        headers: { Authorization: `Bearer ${token}` },\n      }\n    );\n    console.log(\"API Response (fetchPurchaseOrders):\", response.data);\n    purchaseOrders.value = response.data.data.data || [];\n    selectedPOs.value = []; // Reset selected POs when fetching new data\n  } catch (error) {\n    console.error(\"Failed to fetch purchase orders:\", error);\n  }\n};\n\n// Filter berdasarkan tanggal\nconst filteredPurchaseOrders = computed(() => {\n  if (!startDate.value && !endDate.value) return purchaseOrders.value;\n\n  return purchaseOrders.value.filter((po) => {\n    const poDate = new Date(po.created_at); // Sesuaikan dengan field waktu dari API\n    const start = startDate.value ? new Date(startDate.value) : null;\n    const end = endDate.value ? new Date(endDate.value) : null;\n\n    if (start && end) {\n      return poDate >= start && poDate <= end;\n    } else if (start) {\n      return poDate >= start;\n    } else if (end) {\n      return poDate <= end;\n    }\n    return true;\n  });\n});\n\n// View details\nconst viewDetails = async (id) => {\n  if (!id) {\n    alert(\"Invalid purchase ID.\");\n    return;\n  }\n  try {\n    const res = await axios.get(\n      `http://localhost:8081/api/v1/pembelian/purchases/${id}`,\n      { headers: { Authorization: `Bearer ${token}` } }\n    );\n    console.log(\"Purchase Details Response (View):\", res.data);\n    selectedPurchase.value = res.data.data;\n    poItems.value = (res.data.data.Items || []).map((item) => ({\n      ...item,\n      returnQty: 0,\n      reason: \"\",\n    }));\n    showDetailsModal.value = true;\n  } catch (err) {\n    console.error(\"Failed to fetch purchase details:\", err);\n    alert(\n      `Failed to fetch purchase details: ${\n        err.response?.status || \"Unknown\"\n      } - ${err.response?.data?.error || err.message || \"Network error\"}`\n    );\n  }\n};\n\nconst closeDetailsModal = () => {\n  showDetailsModal.value = false;\n  selectedPurchase.value = null;\n  poItems.value = [];\n};\n\n// Watch selectedPOs to auto-fetch details of the first selected PO\nwatch(selectedPOs, (newSelectedPOs) => {\n  if (newSelectedPOs.length > 0) {\n    viewDetails(newSelectedPOs[0]); // Auto-load details of the first selected PO\n  } else {\n    selectedPurchase.value = null;\n    poItems.value = [];\n  }\n});\n\n// Submit return request\nconst submitReturnRequest = async () => {\n  if (selectedPOs.value.length === 0) {\n    alert(\"Please select at least one purchase order.\");\n    return;\n  }\n\n  const returnItemsPayload = poItems.value\n    .filter((item) => item.returnQty > 0)\n    .map((item) => ({\n      purchase_item_id: item.ID,\n      product_id: item.ProductID,\n      qty: item.returnQty,\n      reason: item.reason,\n    }));\n\n  if (returnItemsPayload.length === 0) {\n    alert(\"Please select at least one item to return.\");\n    return;\n  }\n\n  try {\n    const payload = {\n      purchase_id: selectedPurchase.value.ID,\n      return_date: new Date().toISOString(),\n      notes: additionalNotes.value,\n      items: returnItemsPayload,\n    };\n\n    const response = await axios.post(\n      \"http://localhost:8081/api/v1/pembelian/purchase-returns\",\n      payload,\n      {\n        headers: { Authorization: `Bearer ${token}` },\n      }\n    );\n\n    console.log(\"Return request submitted:\", response.data);\n    alert(\"Permintaan retur berhasil diajukan!\");\n    closeDetailsModal();\n    await fetchPurchaseOrders(); // Refresh list after submission\n    additionalNotes.value = \"\";\n    selectedPOs.value = []; // Reset selection\n  } catch (error) {\n    console.error(\n      \"Failed to submit return request:\",\n      error.response ? error.response.data : error.message\n    );\n    alert(\"Gagal mengajukan permintaan retur.\");\n  }\n};\n\nonMounted(() => {\n  fetchPurchaseOrders();\n});\n</script>\n\n<style scoped>\n@import url(\"https://fonts.googleapis.com/css2?display=swap&family=Manrope%3Awght%40400%3B500%3B700%3B800&family=Noto+Sans%3Awght%40400%3B500%3B700%3B900\");\n\n.custom-select {\n  -webkit-appearance: none;\n  -moz-appearance: none;\n  appearance: none;\n  background-image: var(--select-button-svg);\n  background-repeat: no-repeat;\n  background-position: right 1rem center;\n  background-size: 1.5em;\n  padding-right: 2.5rem;\n}\n\n@container (max-width: 120px) {\n  .table-fdf173fd-e234-463e-aee5-60e5b04a682e-column-120 {\n    display: none;\n  }\n}\n\n@container (max-width: 240px) {\n  .table-fdf173fd-e234-463e-aee5-60e5b04a682e-column-240 {\n    display: none;\n  }\n}\n\n@container (max-width: 360px) {\n  .table-fdf173fd-e234-463e-aee5-60e5b04a682e-column-360 {\n    display: none;\n  }\n}\n\n@container (max-width: 480px) {\n  .table-fdf173fd-e234-463e-aee5-60e5b04a682e-column-480 {\n    display: none;\n  }\n}\n\n.layout-content-container {\n  max-width: 960px;\n  width: 100%;\n}\n\n.form-checkbox {\n  width: 16px;\n  height: 16px;\n  accent-color: #0d80f2;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}