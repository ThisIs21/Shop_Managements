{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.every.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport { ref, computed, onMounted } from 'vue';\nimport GudangLayouts from '@/components/GudangLayouts.vue';\nimport axios from 'axios';\nexport default {\n  __name: 'DashboardGudang',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const stockOpnames = ref([]);\n    const loading = ref(false);\n    const products = ref([]);\n    const form = ref({\n      date: '2025-10-02',\n      note: '',\n      items: [{\n        product_id: null,\n        qty_fisik: 0\n      }]\n    });\n    const submitting = ref(false);\n    const error = ref('');\n    const api = axios.create({\n      baseURL: 'http://localhost:8081/api/v1'\n    });\n    if (localStorage.getItem('token')) api.defaults.headers.Authorization = `Bearer ${localStorage.getItem('token')}`;\n    const today = computed(() => new Date().toISOString().split('T')[0]);\n    const fetchData = async () => {\n      loading.value = true;\n      try {\n        const res = await api.get('/gudang/stock-opnames', {\n          params: {\n            limit: 3,\n            sort: 'date_desc'\n          }\n        });\n        stockOpnames.value = res.data.data.map(op => ({\n          ID: op.ID,\n          Date: op.Date,\n          Status: op.Status || 'Pending',\n          ProductsCount: op.Items?.length || 0,\n          StaffName: op.User?.Name || 'Unknown'\n        }));\n      } catch (e) {\n        error.value = 'Gagal muat data';\n        console.error(e);\n      } finally {\n        loading.value = false;\n      }\n    };\n    const fetchProducts = async () => {\n      try {\n        const res = await api.get('/products');\n        products.value = res.data.data;\n      } catch (e) {\n        error.value = 'Gagal muat produk';\n        console.error(e);\n      }\n    };\n    const addItem = () => form.value.items.push({\n      product_id: null,\n      qty_fisik: 0\n    });\n    const submitOpname = async () => {\n      if (!form.value.items.every(i => i.product_id && i.qty_fisik >= 0)) {\n        error.value = 'Isi semua field dengan benar';\n        return;\n      }\n      submitting.value = true;\n      error.value = '';\n      try {\n        await api.post('/gudang/stock-opnames', {\n          date: form.value.date,\n          note: form.value.note,\n          items: form.value.items.filter(i => i.product_id && i.qty_fisik >= 0)\n        });\n        alert('Opname berhasil!');\n        form.value = {\n          date: '2025-10-02',\n          note: '',\n          items: [{\n            product_id: null,\n            qty_fisik: 0\n          }]\n        };\n        fetchData();\n      } catch (e) {\n        error.value = 'Gagal submit opname';\n        console.error(e);\n      } finally {\n        submitting.value = false;\n      }\n    };\n    const formatDate = d => !d ? 'N/A' : new Date(d).toLocaleDateString('id-ID', {\n      day: '2-digit',\n      month: '2-digit',\n      year: 'numeric'\n    });\n    onMounted(() => {\n      fetchData();\n      fetchProducts();\n    });\n    const __returned__ = {\n      stockOpnames,\n      loading,\n      products,\n      form,\n      submitting,\n      error,\n      api,\n      today,\n      fetchData,\n      fetchProducts,\n      addItem,\n      submitOpname,\n      formatDate,\n      ref,\n      computed,\n      onMounted,\n      GudangLayouts,\n      get axios() {\n        return axios;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","GudangLayouts","axios","stockOpnames","loading","products","form","date","note","items","product_id","qty_fisik","submitting","error","api","create","baseURL","localStorage","getItem","defaults","headers","Authorization","today","Date","toISOString","split","fetchData","value","res","get","params","limit","sort","data","map","op","ID","Status","ProductsCount","Items","length","StaffName","User","Name","e","console","fetchProducts","addItem","push","submitOpname","every","i","post","filter","alert","formatDate","d","toLocaleDateString","day","month","year"],"sources":["C:/Users/Personal/Documents/PKL/aplikasi/aplikasi/src/views/DashboardGudang.vue"],"sourcesContent":["<template>\n  <GudangLayouts>\n    <div class=\"space-y-4\">\n      <div>\n        <h1 class=\"text-2xl font-bold text-gray-900\">Warehouse Dashboard</h1>\n        <p class=\"text-gray-600\">Selamat datang! Lihat aktivitas gudang.</p>\n      </div>\n\n      <!-- Stock Opname Terbaru -->\n      <div class=\"bg-white p-4 rounded shadow\">\n        <div class=\"flex justify-between mb-2\">\n          <h2 class=\"text-lg font-semibold\">Stock Opname Terbaru</h2>\n          <button @click=\"fetchData\" :disabled=\"loading\" class=\"px-2 py-1 bg-blue-500 text-white rounded\">Refresh</button>\n        </div>\n        <table class=\"w-full\">\n          <thead>\n            <tr class=\"bg-gray-50\">\n              <th class=\"p-2 text-left text-sm\">Tanggal</th>\n              <th class=\"p-2 text-left text-sm\">Status</th>\n              <th class=\"p-2 text-left text-sm\">Jml Produk</th>\n              <th class=\"p-2 text-left text-sm\">Staff</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-if=\"loading\"><td colspan=\"4\" class=\"p-2 text-center\">Loading...</td></tr>\n            <tr v-else-if=\"!stockOpnames.length\"><td colspan=\"4\" class=\"p-2 text-center\">Tidak ada data</td></tr>\n            <tr v-else v-for=\"op in stockOpnames\" :key=\"op.ID\">\n              <td class=\"p-2\">{{ formatDate(op.Date) }}</td>\n              <td class=\"p-2\">{{ op.Status || 'Pending' }}</td>\n              <td class=\"p-2\">{{ op.ProductsCount || 0 }}</td>\n              <td class=\"p-2\">{{ op.StaffName || 'Unknown' }}</td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n\n      <!-- Buat Stock Opname -->\n      <div class=\"bg-white p-4 rounded shadow\">\n        <h2 class=\"text-lg font-semibold mb-2\">Buat Stock Opname</h2>\n        <form @submit.prevent=\"submitOpname\" class=\"space-y-2\">\n          <div>\n            <label class=\"block text-sm\">Tanggal</label>\n            <input v-model=\"form.date\" type=\"date\" :min=\"today\" required class=\"w-full p-1 border rounded\">\n          </div>\n          <div>\n            <label class=\"block text-sm\">Catatan</label>\n            <textarea v-model=\"form.note\" class=\"w-full p-1 border rounded\" rows=\"2\"></textarea>\n          </div>\n          <div>\n            <label class=\"block text-sm\">Item</label>\n            <div v-for=\"(item, i) in form.items\" :key=\"i\" class=\"flex space-x-2 mb-1\">\n              <select v-model=\"item.product_id\" required class=\"w-1/3 p-1 border rounded\">\n                <option value=\"\">Pilih Produk</option>\n                <option v-for=\"p in products\" :key=\"p.id\" :value=\"p.id\">{{ p.name }}</option>\n              </select>\n              <input v-model.number=\"item.qty_fisik\" type=\"number\" min=\"0\" required class=\"w-1/3 p-1 border rounded\">\n              <button @click.prevent=\"form.items.splice(i, 1)\" type=\"button\" class=\"text-red-500\">Hapus</button>\n            </div>\n            <button @click.prevent=\"addItem\" type=\"button\" class=\"text-blue-500\">Tambah Item</button>\n          </div>\n          <button :disabled=\"submitting\" class=\"w-full py-1 bg-blue-500 text-white rounded\">Submit</button>\n          <p v-if=\"error\" class=\"text-red-500 text-sm\">{{ error }}</p>\n        </form>\n      </div>\n    </div>\n  </GudangLayouts>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted } from 'vue';\nimport GudangLayouts from '@/components/GudangLayouts.vue';\nimport axios from 'axios';\n\nconst stockOpnames = ref([]);\nconst loading = ref(false);\nconst products = ref([]);\nconst form = ref({ date: '2025-10-02', note: '', items: [{ product_id: null, qty_fisik: 0 }] });\nconst submitting = ref(false);\nconst error = ref('');\n\nconst api = axios.create({ baseURL: 'http://localhost:8081/api/v1' });\nif (localStorage.getItem('token')) api.defaults.headers.Authorization = `Bearer ${localStorage.getItem('token')}`;\n\nconst today = computed(() => new Date().toISOString().split('T')[0]);\n\nconst fetchData = async () => {\n  loading.value = true;\n  try {\n    const res = await api.get('/gudang/stock-opnames', { params: { limit: 3, sort: 'date_desc' } });\n    stockOpnames.value = res.data.data.map(op => ({\n      ID: op.ID, Date: op.Date, Status: op.Status || 'Pending',\n      ProductsCount: op.Items?.length || 0, StaffName: op.User?.Name || 'Unknown'\n    }));\n  } catch (e) {\n    error.value = 'Gagal muat data';\n    console.error(e);\n  } finally {\n    loading.value = false;\n  }\n};\n\nconst fetchProducts = async () => {\n  try {\n    const res = await api.get('/products');\n    products.value = res.data.data;\n  } catch (e) {\n    error.value = 'Gagal muat produk';\n    console.error(e);\n  }\n};\n\nconst addItem = () => form.value.items.push({ product_id: null, qty_fisik: 0 });\n\nconst submitOpname = async () => {\n  if (!form.value.items.every(i => i.product_id && i.qty_fisik >= 0)) {\n    error.value = 'Isi semua field dengan benar';\n    return;\n  }\n  submitting.value = true;\n  error.value = '';\n  try {\n    await api.post('/gudang/stock-opnames', {\n      date: form.value.date, note: form.value.note,\n      items: form.value.items.filter(i => i.product_id && i.qty_fisik >= 0)\n    });\n    alert('Opname berhasil!');\n    form.value = { date: '2025-10-02', note: '', items: [{ product_id: null, qty_fisik: 0 }] };\n    fetchData();\n  } catch (e) {\n    error.value = 'Gagal submit opname';\n    console.error(e);\n  } finally {\n    submitting.value = false;\n  }\n};\n\nconst formatDate = (d) => !d ? 'N/A' : new Date(d).toLocaleDateString('id-ID', { day: '2-digit', month: '2-digit', year: 'numeric' });\n\nonMounted(() => {\n  fetchData();\n  fetchProducts();\n});\n</script>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}