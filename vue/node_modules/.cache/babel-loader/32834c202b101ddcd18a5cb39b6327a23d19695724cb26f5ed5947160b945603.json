{"ast":null,"code":"import { ref, onMounted } from \"vue\";\nimport axios from \"axios\";\n\n// === Axios instance lokal ===\n\nexport default {\n  __name: 'ReturnApprovalOwners',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const api = axios.create({\n      baseURL: \"http://localhost:8081/api/v1\",\n      timeout: 10000\n    });\n    const savedToken = localStorage.getItem(\"token\");\n    if (savedToken) {\n      api.defaults.headers.common[\"Authorization\"] = `Bearer ${savedToken}`;\n    }\n\n    // State\n    const returns = ref([]);\n    const loading = ref(true);\n    const showRejectModal = ref(false);\n    const selectedReturnId = ref(null);\n    const rejectReason = ref(\"\");\n\n    // Fetch data retur\n    const fetchReturns = async () => {\n      loading.value = true;\n      try {\n        const res = await api.get(\"/owner/sale-returns\");\n        returns.value = res.data || [];\n      } catch (err) {\n        console.error(err);\n        alert(\"Gagal memuat data retur\");\n      } finally {\n        loading.value = false;\n      }\n    };\n\n    // Approve retur\n    const approveReturn = async id => {\n      try {\n        await api.post(`/owner/sale-returns/${id}/approve`);\n        await fetchReturns();\n        alert(\"Retur berhasil disetujui\");\n      } catch (err) {\n        console.error(err);\n        alert(\"Gagal menyetujui retur\");\n      }\n    };\n\n    // Buka modal penolakan\n    const openRejectModal = id => {\n      selectedReturnId.value = id;\n      rejectReason.value = \"\";\n      showRejectModal.value = true;\n    };\n\n    // Submit penolakan\n    const submitReject = async () => {\n      if (!rejectReason.value) {\n        alert(\"Alasan penolakan wajib diisi\");\n        return;\n      }\n      try {\n        await api.post(`/owner/sale-returns/${selectedReturnId.value}/reject`, {\n          reason: rejectReason.value\n        });\n        await fetchReturns();\n        showRejectModal.value = false;\n        alert(\"Retur berhasil ditolak\");\n      } catch (err) {\n        console.error(err);\n        alert(\"Gagal menolak retur\");\n      }\n    };\n    onMounted(() => {\n      fetchReturns();\n    });\n    const __returned__ = {\n      api,\n      savedToken,\n      returns,\n      loading,\n      showRejectModal,\n      selectedReturnId,\n      rejectReason,\n      fetchReturns,\n      approveReturn,\n      openRejectModal,\n      submitReject,\n      ref,\n      onMounted,\n      get axios() {\n        return axios;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","axios","api","create","baseURL","timeout","savedToken","localStorage","getItem","defaults","headers","common","returns","loading","showRejectModal","selectedReturnId","rejectReason","fetchReturns","value","res","get","data","err","console","error","alert","approveReturn","id","post","openRejectModal","submitReject","reason"],"sources":["C:/Users/Personal/Documents/PKL/aplikasi/aplikasi/src/views/ReturnApprovalOwners.vue"],"sourcesContent":["<template>\n  <div class=\"p-6\">\n    <h1 class=\"text-2xl font-bold mb-4\">Daftar Pengajuan Retur</h1>\n\n    <!-- Loading -->\n    <div v-if=\"loading\" class=\"text-gray-600\">Memuat data retur...</div>\n\n    <!-- Tabel Retur -->\n    <table\n      v-else\n      class=\"min-w-full bg-white border border-gray-200 shadow rounded\"\n    >\n      <thead>\n        <tr class=\"bg-gray-100\">\n          <th class=\"px-4 py-2 border\">ID</th>\n          <th class=\"px-4 py-2 border\">Tanggal</th>\n          <th class=\"px-4 py-2 border\">Kasir</th>\n          <th class=\"px-4 py-2 border\">Status</th>\n          <th class=\"px-4 py-2 border\">Aksi</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr v-for=\"ret in returns\" :key=\"ret.id\">\n          <td class=\"px-4 py-2 border\">{{ ret.id }}</td>\n          <td class=\"px-4 py-2 border\">\n            {{ new Date(ret.created_at).toLocaleString() }}\n          </td>\n          <td class=\"px-4 py-2 border\">\n            {{ ret.created_by?.username || \"-\" }}\n          </td>\n          <td class=\"px-4 py-2 border\">\n            <span\n              :class=\"{\n                'text-yellow-600': ret.status === 'PENDING',\n                'text-green-600': ret.status === 'APPROVED',\n                'text-red-600': ret.status === 'REJECTED',\n              }\"\n            >\n              {{ ret.status }}\n            </span>\n          </td>\n          <td class=\"px-4 py-2 border\">\n            <button\n              v-if=\"ret.status === 'PENDING'\"\n              @click=\"approveReturn(ret.id)\"\n              class=\"bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded mr-2\"\n            >\n              Setujui\n            </button>\n            <button\n              v-if=\"ret.status === 'PENDING'\"\n              @click=\"openRejectModal(ret.id)\"\n              class=\"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded\"\n            >\n              Tolak\n            </button>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n\n    <!-- Modal Penolakan -->\n    <div\n      v-if=\"showRejectModal\"\n      class=\"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center\"\n    >\n      <div class=\"bg-white p-6 rounded shadow-md w-96\">\n        <h2 class=\"text-xl font-bold mb-4\">Alasan Penolakan</h2>\n        <textarea\n          v-model=\"rejectReason\"\n          placeholder=\"Masukkan alasan\"\n          class=\"w-full border p-2 rounded mb-4\"\n        ></textarea>\n        <div class=\"flex justify-end\">\n          <button\n            @click=\"showRejectModal = false\"\n            class=\"bg-gray-300 hover:bg-gray-400 text-black px-3 py-1 rounded mr-2\"\n          >\n            Batal\n          </button>\n          <button\n            @click=\"submitReject\"\n            class=\"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded\"\n          >\n            Tolak Retur\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, onMounted } from \"vue\";\nimport axios from \"axios\";\n\n// === Axios instance lokal ===\nconst api = axios.create({\n  baseURL: \"http://localhost:8081/api/v1\",\n  timeout: 10000,\n});\nconst savedToken = localStorage.getItem(\"token\");\nif (savedToken) {\n  api.defaults.headers.common[\"Authorization\"] = `Bearer ${savedToken}`;\n}\n\n// State\nconst returns = ref([]);\nconst loading = ref(true);\nconst showRejectModal = ref(false);\nconst selectedReturnId = ref(null);\nconst rejectReason = ref(\"\");\n\n// Fetch data retur\nconst fetchReturns = async () => {\n  loading.value = true;\n  try {\n    const res = await api.get(\"/owner/sale-returns\");\n    returns.value = res.data || [];\n  } catch (err) {\n    console.error(err);\n    alert(\"Gagal memuat data retur\");\n  } finally {\n    loading.value = false;\n  }\n};\n\n// Approve retur\nconst approveReturn = async (id) => {\n  try {\n    await api.post(`/owner/sale-returns/${id}/approve`);\n    await fetchReturns();\n    alert(\"Retur berhasil disetujui\");\n  } catch (err) {\n    console.error(err);\n    alert(\"Gagal menyetujui retur\");\n  }\n};\n\n// Buka modal penolakan\nconst openRejectModal = (id) => {\n  selectedReturnId.value = id;\n  rejectReason.value = \"\";\n  showRejectModal.value = true;\n};\n\n// Submit penolakan\nconst submitReject = async () => {\n  if (!rejectReason.value) {\n    alert(\"Alasan penolakan wajib diisi\");\n    return;\n  }\n  try {\n    await api.post(`/owner/sale-returns/${selectedReturnId.value}/reject`, {\n      reason: rejectReason.value,\n    });\n    await fetchReturns();\n    showRejectModal.value = false;\n    alert(\"Retur berhasil ditolak\");\n  } catch (err) {\n    console.error(err);\n    alert(\"Gagal menolak retur\");\n  }\n};\n\nonMounted(() => {\n  fetchReturns();\n});\n</script>\n\n<style scoped>\n/* opsional: style tambahan */\n</style>\n"],"mappings":"AA6FA,SAASA,GAAG,EAAEC,SAAS,QAAQ,KAAK;AACpC,OAAOC,KAAK,MAAM,OAAO;;AAEzB;;;;;;;;IACA,MAAMC,GAAG,GAAGD,KAAK,CAACE,MAAM,CAAC;MACvBC,OAAO,EAAE,8BAA8B;MACvCC,OAAO,EAAE;IACX,CAAC,CAAC;IACF,MAAMC,UAAU,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;IAChD,IAAIF,UAAU,EAAE;MACdJ,GAAG,CAACO,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC,GAAG,UAAUL,UAAU,EAAE;IACvE;;IAEA;IACA,MAAMM,OAAO,GAAGb,GAAG,CAAC,EAAE,CAAC;IACvB,MAAMc,OAAO,GAAGd,GAAG,CAAC,IAAI,CAAC;IACzB,MAAMe,eAAe,GAAGf,GAAG,CAAC,KAAK,CAAC;IAClC,MAAMgB,gBAAgB,GAAGhB,GAAG,CAAC,IAAI,CAAC;IAClC,MAAMiB,YAAY,GAAGjB,GAAG,CAAC,EAAE,CAAC;;IAE5B;IACA,MAAMkB,YAAY,GAAG,MAAAA,CAAA,KAAY;MAC/BJ,OAAO,CAACK,KAAK,GAAG,IAAI;MACpB,IAAI;QACF,MAAMC,GAAG,GAAG,MAAMjB,GAAG,CAACkB,GAAG,CAAC,qBAAqB,CAAC;QAChDR,OAAO,CAACM,KAAK,GAAGC,GAAG,CAACE,IAAI,IAAI,EAAE;MAChC,CAAC,CAAC,OAAOC,GAAG,EAAE;QACZC,OAAO,CAACC,KAAK,CAACF,GAAG,CAAC;QAClBG,KAAK,CAAC,yBAAyB,CAAC;MAClC,CAAC,SAAS;QACRZ,OAAO,CAACK,KAAK,GAAG,KAAK;MACvB;IACF,CAAC;;IAED;IACA,MAAMQ,aAAa,GAAG,MAAOC,EAAE,IAAK;MAClC,IAAI;QACF,MAAMzB,GAAG,CAAC0B,IAAI,CAAC,uBAAuBD,EAAE,UAAU,CAAC;QACnD,MAAMV,YAAY,CAAC,CAAC;QACpBQ,KAAK,CAAC,0BAA0B,CAAC;MACnC,CAAC,CAAC,OAAOH,GAAG,EAAE;QACZC,OAAO,CAACC,KAAK,CAACF,GAAG,CAAC;QAClBG,KAAK,CAAC,wBAAwB,CAAC;MACjC;IACF,CAAC;;IAED;IACA,MAAMI,eAAe,GAAIF,EAAE,IAAK;MAC9BZ,gBAAgB,CAACG,KAAK,GAAGS,EAAE;MAC3BX,YAAY,CAACE,KAAK,GAAG,EAAE;MACvBJ,eAAe,CAACI,KAAK,GAAG,IAAI;IAC9B,CAAC;;IAED;IACA,MAAMY,YAAY,GAAG,MAAAA,CAAA,KAAY;MAC/B,IAAI,CAACd,YAAY,CAACE,KAAK,EAAE;QACvBO,KAAK,CAAC,8BAA8B,CAAC;QACrC;MACF;MACA,IAAI;QACF,MAAMvB,GAAG,CAAC0B,IAAI,CAAC,uBAAuBb,gBAAgB,CAACG,KAAK,SAAS,EAAE;UACrEa,MAAM,EAAEf,YAAY,CAACE;QACvB,CAAC,CAAC;QACF,MAAMD,YAAY,CAAC,CAAC;QACpBH,eAAe,CAACI,KAAK,GAAG,KAAK;QAC7BO,KAAK,CAAC,wBAAwB,CAAC;MACjC,CAAC,CAAC,OAAOH,GAAG,EAAE;QACZC,OAAO,CAACC,KAAK,CAACF,GAAG,CAAC;QAClBG,KAAK,CAAC,qBAAqB,CAAC;MAC9B;IACF,CAAC;IAEDzB,SAAS,CAAC,MAAM;MACdiB,YAAY,CAAC,CAAC;IAChB,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}