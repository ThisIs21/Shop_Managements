{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport { ref, onMounted } from \"vue\";\nimport axios from \"axios\";\nimport KepalaGudangSidebar from \"@/components/KepalaGudangSidebar.vue\";\nexport default {\n  __name: 'PurchaseOrderKepalaGudang',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const purchases = ref([]);\n    const token = localStorage.getItem(\"token\"); // ambil token login\n\n    // Ambil data dari backend\n    const fetchPurchases = async () => {\n      try {\n        const res = await axios.get(\"http://localhost:8081/api/v1/kepala-gudang/history/purchases\", {\n          params: {\n            page: 1,\n            size: 20,\n            q: \"\"\n          },\n          // paging & search kalau ada\n          headers: {\n            Authorization: `Bearer ${token}` // kirim token ke backend\n          }\n        });\n\n        // Backend return array langsung atau dibungkus\n        purchases.value = Array.isArray(res.data) ? res.data : res.data.data || [];\n      } catch (err) {\n        console.error(\"Failed to fetch purchases:\", err);\n      }\n    };\n\n    // Approve PO\n    const approvePO = async id => {\n      try {\n        await axios.post(`http://localhost:8081/api/v1/purchases/${id}/approve`, {}, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        // Hapus dari list setelah approve\n        purchases.value = purchases.value.filter(po => po.id !== id);\n      } catch (err) {\n        console.error(\"Failed to approve:\", err);\n      }\n    };\n\n    // Reject PO\n    const rejectPO = async id => {\n      try {\n        await axios.post(`http://localhost:8081/api/v1/purchases/${id}/reject`, {}, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        // Hapus dari list setelah reject\n        purchases.value = purchases.value.filter(po => po.id !== id);\n      } catch (err) {\n        console.error(\"Failed to reject:\", err);\n      }\n    };\n\n    // Format tanggal\n    const formatDate = dateStr => {\n      if (!dateStr) return \"-\";\n      return new Date(dateStr).toLocaleDateString();\n    };\n\n    // Format mata uang\n    const formatCurrency = val => {\n      if (val === null || val === undefined) return \"-\";\n      return new Intl.NumberFormat(\"en-US\", {\n        style: \"currency\",\n        currency: \"USD\"\n      }).format(val);\n    };\n    onMounted(() => {\n      fetchPurchases();\n    });\n    const __returned__ = {\n      purchases,\n      token,\n      fetchPurchases,\n      approvePO,\n      rejectPO,\n      formatDate,\n      formatCurrency,\n      ref,\n      onMounted,\n      get axios() {\n        return axios;\n      },\n      KepalaGudangSidebar\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","axios","KepalaGudangSidebar","purchases","token","localStorage","getItem","fetchPurchases","res","get","params","page","size","q","headers","Authorization","value","Array","isArray","data","err","console","error","approvePO","id","post","filter","po","rejectPO","formatDate","dateStr","Date","toLocaleDateString","formatCurrency","val","undefined","Intl","NumberFormat","style","currency","format"],"sources":["C:/Users/Personal/Documents/PKL/aplikasi/aplikasi/src/views/PurchaseOrderKepalaGudang.vue"],"sourcesContent":["<script setup>\nimport { ref, onMounted } from \"vue\";\nimport axios from \"axios\";\nimport KepalaGudangSidebar from \"@/components/KepalaGudangSidebar.vue\";\n\nconst purchases = ref([]);\nconst token = localStorage.getItem(\"token\"); // ambil token login\n\n// Ambil data dari backend\nconst fetchPurchases = async () => {\n  try {\n    const res = await axios.get(\n      \"http://localhost:8081/api/v1/kepala-gudang/history/purchases\",\n      {\n        params: { page: 1, size: 20, q: \"\" }, // paging & search kalau ada\n        headers: {\n          Authorization: `Bearer ${token}`, // kirim token ke backend\n        },\n      }\n    );\n\n    // Backend return array langsung atau dibungkus\n    purchases.value = Array.isArray(res.data) ? res.data : res.data.data || [];\n  } catch (err) {\n    console.error(\"Failed to fetch purchases:\", err);\n  }\n};\n\n// Approve PO\nconst approvePO = async (id) => {\n  try {\n    await axios.post(\n      `http://localhost:8081/api/v1/purchases/${id}/approve`,\n      {},\n      {\n        headers: { Authorization: `Bearer ${token}` },\n      }\n    );\n    // Hapus dari list setelah approve\n    purchases.value = purchases.value.filter((po) => po.id !== id);\n  } catch (err) {\n    console.error(\"Failed to approve:\", err);\n  }\n};\n\n// Reject PO\nconst rejectPO = async (id) => {\n  try {\n    await axios.post(\n      `http://localhost:8081/api/v1/purchases/${id}/reject`,\n      {},\n      {\n        headers: { Authorization: `Bearer ${token}` },\n      }\n    );\n    // Hapus dari list setelah reject\n    purchases.value = purchases.value.filter((po) => po.id !== id);\n  } catch (err) {\n    console.error(\"Failed to reject:\", err);\n  }\n};\n\n// Format tanggal\nconst formatDate = (dateStr) => {\n  if (!dateStr) return \"-\";\n  return new Date(dateStr).toLocaleDateString();\n};\n\n// Format mata uang\nconst formatCurrency = (val) => {\n  if (val === null || val === undefined) return \"-\";\n  return new Intl.NumberFormat(\"en-US\", {\n    style: \"currency\",\n    currency: \"USD\",\n  }).format(val);\n};\n\nonMounted(() => {\n  fetchPurchases();\n});\n</script>\n\n<template>\n  <div class=\"flex size-full min-h-screen flex-col bg-white font-manrope lg:flex-row\">\n    <KepalaGudangSidebar />\n\n    <div class=\"flex flex-1 flex-col\">\n      <main class=\"flex-1 p-8\">\n        <div class=\"layout-content-container flex flex-col flex-1\">\n          <div class=\"mb-6\">\n            <p class=\"text-[#111418] tracking-light text-[32px] font-bold leading-tight\">\n              Purchase Orders Pending Approval\n            </p>\n          </div>\n\n          <div class=\"px-4 py-3 @container\">\n            <div class=\"flex overflow-hidden rounded-lg border border-[#dbe0e6] bg-white\">\n              <table class=\"flex-1\">\n                <thead>\n                  <tr class=\"bg-white\">\n                    <th class=\"px-4 py-3 text-left text-[#111418] text-sm font-medium\">\n                      PO Number\n                    </th>\n                    <th class=\"px-4 py-3 text-left text-[#111418] text-sm font-medium\">\n                      Supplier\n                    </th>\n                    <th class=\"px-4 py-3 text-left text-[#111418] text-sm font-medium\">\n                      Date\n                    </th>\n                    <th class=\"px-4 py-3 text-left text-[#111418] text-sm font-medium\">\n                      Total\n                    </th>\n                    <th class=\"px-4 py-3 text-left text-[#60758a] text-sm font-medium\">\n                      Action\n                    </th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <tr\n                    v-for=\"po in purchases\"\n                    :key=\"po.id\"\n                    class=\"border-t border-t-[#dbe0e6]\"\n                  >\n                    <td class=\"h-[72px] px-4 py-2 text-[#111418] text-sm\">\n                      {{ po.id }}\n                    </td>\n                    <td class=\"h-[72px] px-4 py-2 text-[#60758a] text-sm\">\n                      {{ po.supplier?.name || \"-\" }}\n                    </td>\n                    <td class=\"h-[72px] px-4 py-2 text-[#60758a] text-sm\">\n                      {{ formatDate(po.date) }}\n                    </td>\n                    <td class=\"h-[72px] px-4 py-2 text-[#60758a] text-sm\">\n                      {{ formatCurrency(po.total) }}\n                    </td>\n                    <td class=\"h-[72px] px-4 py-2 text-sm font-bold flex gap-2\">\n                      <button\n                        @click=\"approvePO(po.id)\"\n                        class=\"px-3 py-1 rounded bg-green-500 text-white hover:bg-green-600\"\n                      >\n                        Approve\n                      </button>\n                      <button\n                        @click=\"rejectPO(po.id)\"\n                        class=\"px-3 py-1 rounded bg-red-500 text-white hover:bg-red-600\"\n                      >\n                        Reject\n                      </button>\n                    </td>\n                  </tr>\n                  <tr v-if=\"purchases.length === 0\">\n                    <td colspan=\"5\" class=\"text-center py-4 text-[#60758a] text-sm\">\n                      No pending purchase orders\n                    </td>\n                  </tr>\n                </tbody>\n              </table>\n            </div>\n          </div>\n        </div>\n      </main>\n    </div>\n  </div>\n</template>\n"],"mappings":";;AACA,SAASA,GAAG,EAAEC,SAAS,QAAQ,KAAK;AACpC,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAOC,mBAAmB,MAAM,sCAAsC;;;;;;;IAEtE,MAAMC,SAAS,GAAGJ,GAAG,CAAC,EAAE,CAAC;IACzB,MAAMK,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC;;IAE7C;IACA,MAAMC,cAAc,GAAG,MAAAA,CAAA,KAAY;MACjC,IAAI;QACF,MAAMC,GAAG,GAAG,MAAMP,KAAK,CAACQ,GAAG,CACzB,8DAA8D,EAC9D;UACEC,MAAM,EAAE;YAAEC,IAAI,EAAE,CAAC;YAAEC,IAAI,EAAE,EAAE;YAAEC,CAAC,EAAE;UAAG,CAAC;UAAE;UACtCC,OAAO,EAAE;YACPC,aAAa,EAAE,UAAUX,KAAK,EAAE,CAAE;UACpC;QACF,CACF,CAAC;;QAED;QACAD,SAAS,CAACa,KAAK,GAAGC,KAAK,CAACC,OAAO,CAACV,GAAG,CAACW,IAAI,CAAC,GAAGX,GAAG,CAACW,IAAI,GAAGX,GAAG,CAACW,IAAI,CAACA,IAAI,IAAI,EAAE;MAC5E,CAAC,CAAC,OAAOC,GAAG,EAAE;QACZC,OAAO,CAACC,KAAK,CAAC,4BAA4B,EAAEF,GAAG,CAAC;MAClD;IACF,CAAC;;IAED;IACA,MAAMG,SAAS,GAAG,MAAOC,EAAE,IAAK;MAC9B,IAAI;QACF,MAAMvB,KAAK,CAACwB,IAAI,CACd,0CAA0CD,EAAE,UAAU,EACtD,CAAC,CAAC,EACF;UACEV,OAAO,EAAE;YAAEC,aAAa,EAAE,UAAUX,KAAK;UAAG;QAC9C,CACF,CAAC;QACD;QACAD,SAAS,CAACa,KAAK,GAAGb,SAAS,CAACa,KAAK,CAACU,MAAM,CAAEC,EAAE,IAAKA,EAAE,CAACH,EAAE,KAAKA,EAAE,CAAC;MAChE,CAAC,CAAC,OAAOJ,GAAG,EAAE;QACZC,OAAO,CAACC,KAAK,CAAC,oBAAoB,EAAEF,GAAG,CAAC;MAC1C;IACF,CAAC;;IAED;IACA,MAAMQ,QAAQ,GAAG,MAAOJ,EAAE,IAAK;MAC7B,IAAI;QACF,MAAMvB,KAAK,CAACwB,IAAI,CACd,0CAA0CD,EAAE,SAAS,EACrD,CAAC,CAAC,EACF;UACEV,OAAO,EAAE;YAAEC,aAAa,EAAE,UAAUX,KAAK;UAAG;QAC9C,CACF,CAAC;QACD;QACAD,SAAS,CAACa,KAAK,GAAGb,SAAS,CAACa,KAAK,CAACU,MAAM,CAAEC,EAAE,IAAKA,EAAE,CAACH,EAAE,KAAKA,EAAE,CAAC;MAChE,CAAC,CAAC,OAAOJ,GAAG,EAAE;QACZC,OAAO,CAACC,KAAK,CAAC,mBAAmB,EAAEF,GAAG,CAAC;MACzC;IACF,CAAC;;IAED;IACA,MAAMS,UAAU,GAAIC,OAAO,IAAK;MAC9B,IAAI,CAACA,OAAO,EAAE,OAAO,GAAG;MACxB,OAAO,IAAIC,IAAI,CAACD,OAAO,CAAC,CAACE,kBAAkB,CAAC,CAAC;IAC/C,CAAC;;IAED;IACA,MAAMC,cAAc,GAAIC,GAAG,IAAK;MAC9B,IAAIA,GAAG,KAAK,IAAI,IAAIA,GAAG,KAAKC,SAAS,EAAE,OAAO,GAAG;MACjD,OAAO,IAAIC,IAAI,CAACC,YAAY,CAAC,OAAO,EAAE;QACpCC,KAAK,EAAE,UAAU;QACjBC,QAAQ,EAAE;MACZ,CAAC,CAAC,CAACC,MAAM,CAACN,GAAG,CAAC;IAChB,CAAC;IAEDlC,SAAS,CAAC,MAAM;MACdO,cAAc,CAAC,CAAC;IAClB,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}