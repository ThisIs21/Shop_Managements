{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref } from \"vue\";\nimport router from \"@/router\"; // Asumsikan Anda menggunakan Vue Router\nimport apiClient from \"@/api/axios\"; // Import instance Axios yang sudah dibuat\n\n// State untuk formulir\n\nexport default {\n  __name: 'AppLogin',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const email = ref(\"\");\n    const password = ref(\"\");\n\n    // State untuk UI dan Error Handling\n    const isLoading = ref(false);\n    const generalError = ref(\"\");\n    const errors = ref({\n      email: \"\",\n      password: \"\"\n    });\n\n    /**\n     * Validasi sisi klien sederhana\n     */\n    const validateForm = () => {\n      let isValid = true;\n      errors.value = {\n        email: \"\",\n        password: \"\"\n      };\n      if (!email.value) {\n        errors.value.email = \"Email wajib diisi.\";\n        isValid = false;\n      }\n      // Tidak perlu validasi email yang kompleks di sini, biarkan backend yang mengurus\n\n      if (!password.value) {\n        errors.value.password = \"Password wajib diisi.\";\n        isValid = false;\n      } else if (password.value.length < 6) {\n        errors.value.password = \"Password minimal 6 karakter.\";\n        isValid = false;\n      }\n      return isValid;\n    };\n\n    /**\n     * Menangani proses login\n     */\n    const handleLogin = async () => {\n      generalError.value = \"\"; // Reset error\n\n      if (!validateForm()) {\n        return;\n      }\n      isLoading.value = true;\n      try {\n        const response = await apiClient.post(\"/auth/login\", {\n          email: email.value,\n          password: password.value\n        });\n\n        // Asumsi: Backend mengembalikan { token: \"...\", name: \"...\", role: \"...\" }\n        const {\n          token,\n          name,\n          role\n        } = response.data;\n\n        // 1. Simpan token di Local Storage atau Vuex/Pinia (disarankan untuk manajemen state)\n        localStorage.setItem(\"userToken\", token);\n\n        // 2. Simpan detail user lainnya\n        localStorage.setItem(\"userName\", name);\n        localStorage.setItem(\"userRole\", role);\n\n        // 3. Konfigurasi Axios untuk menyertakan token di setiap request berikutnya\n        apiClient.defaults.headers.common[\"Authorization\"] = `Bearer ${token}`;\n\n        // 4. Redirect pengguna ke halaman dashboard berdasarkan role\n        if (role === \"OWNER\") {\n          router.push(\"/owner/dashboard\");\n        } else if (role === \"KASIR\") {\n          router.push(\"/kasir/dashboard\");\n        } else {\n          // Role lain atau default\n          router.push(\"/dashboard\");\n        }\n      } catch (error) {\n        // Tangani error dari API\n        if (error.response) {\n          // Error 400 (Bad Request) atau 401 (Unauthorized) dari backend Go Anda\n          // Pesan error dari backend akan ada di error.response.data.message atau serupa\n          const message = error.response.data.message || \"Email atau password salah. Silakan coba lagi.\";\n          generalError.value = message;\n        } else if (error.request) {\n          // Permintaan dikirim tetapi tidak ada respons (mis. server down)\n          generalError.value = \"Tidak dapat terhubung ke server. Silakan cek koneksi Anda.\";\n        } else {\n          // Kesalahan lain\n          generalError.value = \"Terjadi kesalahan tak terduga saat login.\";\n          console.error(error);\n        }\n      } finally {\n        isLoading.value = false;\n      }\n    };\n    const __returned__ = {\n      email,\n      password,\n      isLoading,\n      generalError,\n      errors,\n      validateForm,\n      handleLogin,\n      ref,\n      get router() {\n        return router;\n      },\n      get apiClient() {\n        return apiClient;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","router","apiClient","email","password","isLoading","generalError","errors","validateForm","isValid","value","length","handleLogin","response","post","token","name","role","data","localStorage","setItem","defaults","headers","common","push","error","message","request","console"],"sources":["C:/Users/Personal/Documents/PKL/aplikasi/aplikasi/src/views/AppLogin.vue"],"sourcesContent":["<template>\n  <div class=\"login-container\">\n    <form @submit.prevent=\"handleLogin\" class=\"login-form\">\n      <h2>Sistem Penjualan - Login</h2>\n\n      <div class=\"form-group\">\n        <label for=\"email\">Email</label>\n        <input\n          type=\"email\"\n          id=\"email\"\n          v-model=\"email\"\n          required\n          :disabled=\"isLoading\"\n        />\n        <p v-if=\"errors.email\" class=\"error-message\">{{ errors.email }}</p>\n      </div>\n\n      <div class=\"form-group\">\n        <label for=\"password\">Password</label>\n        <input\n          type=\"password\"\n          id=\"password\"\n          v-model=\"password\"\n          required\n          minlength=\"6\"\n          :disabled=\"isLoading\"\n        />\n        <p v-if=\"errors.password\" class=\"error-message\">\n          {{ errors.password }}\n        </p>\n      </div>\n\n      <p v-if=\"generalError\" class=\"error-message general-error\">\n        {{ generalError }}\n      </p>\n\n      <button type=\"submit\" :disabled=\"isLoading\">\n        <span v-if=\"isLoading\">Loading...</span>\n        <span v-else>Login</span>\n      </button>\n    </form>\n  </div>\n</template>\n\n<script setup>\nimport { ref } from \"vue\";\nimport router from \"@/router\"; // Asumsikan Anda menggunakan Vue Router\nimport apiClient from \"@/api/axios\"; // Import instance Axios yang sudah dibuat\n\n// State untuk formulir\nconst email = ref(\"\");\nconst password = ref(\"\");\n\n// State untuk UI dan Error Handling\nconst isLoading = ref(false);\nconst generalError = ref(\"\");\nconst errors = ref({\n  email: \"\",\n  password: \"\",\n});\n\n/**\n * Validasi sisi klien sederhana\n */\nconst validateForm = () => {\n  let isValid = true;\n  errors.value = { email: \"\", password: \"\" };\n\n  if (!email.value) {\n    errors.value.email = \"Email wajib diisi.\";\n    isValid = false;\n  }\n  // Tidak perlu validasi email yang kompleks di sini, biarkan backend yang mengurus\n\n  if (!password.value) {\n    errors.value.password = \"Password wajib diisi.\";\n    isValid = false;\n  } else if (password.value.length < 6) {\n    errors.value.password = \"Password minimal 6 karakter.\";\n    isValid = false;\n  }\n\n  return isValid;\n};\n\n/**\n * Menangani proses login\n */\nconst handleLogin = async () => {\n  generalError.value = \"\"; // Reset error\n\n  if (!validateForm()) {\n    return;\n  }\n\n  isLoading.value = true;\n\n  try {\n    const response = await apiClient.post(\"/auth/login\", {\n      email: email.value,\n      password: password.value,\n    });\n\n    // Asumsi: Backend mengembalikan { token: \"...\", name: \"...\", role: \"...\" }\n    const { token, name, role } = response.data;\n\n    // 1. Simpan token di Local Storage atau Vuex/Pinia (disarankan untuk manajemen state)\n    localStorage.setItem(\"userToken\", token);\n\n    // 2. Simpan detail user lainnya\n    localStorage.setItem(\"userName\", name);\n    localStorage.setItem(\"userRole\", role);\n\n    // 3. Konfigurasi Axios untuk menyertakan token di setiap request berikutnya\n    apiClient.defaults.headers.common[\"Authorization\"] = `Bearer ${token}`;\n\n    // 4. Redirect pengguna ke halaman dashboard berdasarkan role\n    if (role === \"OWNER\") {\n      router.push(\"/owner/dashboard\");\n    } else if (role === \"KASIR\") {\n      router.push(\"/kasir/dashboard\");\n    } else {\n      // Role lain atau default\n      router.push(\"/dashboard\");\n    }\n  } catch (error) {\n    // Tangani error dari API\n    if (error.response) {\n      // Error 400 (Bad Request) atau 401 (Unauthorized) dari backend Go Anda\n      // Pesan error dari backend akan ada di error.response.data.message atau serupa\n      const message =\n        error.response.data.message ||\n        \"Email atau password salah. Silakan coba lagi.\";\n      generalError.value = message;\n    } else if (error.request) {\n      // Permintaan dikirim tetapi tidak ada respons (mis. server down)\n      generalError.value =\n        \"Tidak dapat terhubung ke server. Silakan cek koneksi Anda.\";\n    } else {\n      // Kesalahan lain\n      generalError.value = \"Terjadi kesalahan tak terduga saat login.\";\n      console.error(error);\n    }\n  } finally {\n    isLoading.value = false;\n  }\n};\n</script>\n\n<style scoped>\n.login-container {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  min-height: 100vh;\n  background-color: #f4f7f6;\n}\n\n.login-form {\n  background: white;\n  padding: 40px;\n  border-radius: 8px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n  width: 100%;\n  max-width: 400px;\n}\n\nh2 {\n  text-align: center;\n  margin-bottom: 30px;\n  color: #333;\n}\n\n.form-group {\n  margin-bottom: 20px;\n}\n\nlabel {\n  display: block;\n  margin-bottom: 5px;\n  font-weight: bold;\n  color: #555;\n}\n\ninput {\n  width: 100%;\n  padding: 10px;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  box-sizing: border-box;\n}\n\ninput:focus {\n  border-color: #007bff;\n  outline: none;\n  box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);\n}\n\nbutton {\n  width: 100%;\n  padding: 12px;\n  background-color: #007bff;\n  color: white;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 16px;\n  transition: background-color 0.3s;\n}\n\nbutton:hover:not(:disabled) {\n  background-color: #0056b3;\n}\n\nbutton:disabled {\n  background-color: #a0c3e1;\n  cursor: not-allowed;\n}\n\n.error-message {\n  color: #dc3545;\n  font-size: 0.875em;\n  margin-top: 5px;\n}\n\n.general-error {\n  text-align: center;\n  font-weight: bold;\n  margin-bottom: 15px;\n  padding: 10px;\n  border: 1px solid #f5c6cb;\n  background-color: #f8d7da;\n  border-radius: 4px;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}