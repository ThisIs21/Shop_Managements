{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport { ref, onMounted } from 'vue';\nimport PurchasingLayouts from '../components/PurchasingLayouts.vue';\nimport axios from 'axios';\nimport { useToast } from 'vue-toastification'; // Untuk notifikasi error\n\n// State untuk menyimpan data dashboard\n\nexport default {\n  __name: 'DashboardPembelian',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const dashboardData = ref({\n      purchase_orders_to_process: 0,\n      returns_to_review: 0,\n      products_in_stock: 0\n    });\n\n    // Inisialisasi toast untuk notifikasi\n    const toast = useToast();\n\n    // Fungsi untuk mengambil data dari backend\n    const fetchDashboardData = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        if (!token) {\n          throw new Error('Token autentikasi tidak ditemukan. Silakan login kembali.');\n        }\n\n        // Ambil jumlah purchase orders dengan status SUBMITTED\n        const purchaseResponse = await axios.get('http://localhost:8080/api/v1/pembelian/purchases', {\n          params: {\n            status: 'SUBMITTED',\n            size: 1\n          },\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        dashboardData.value.purchase_orders_to_process = purchaseResponse.data.total || 0;\n\n        // Ambil jumlah purchase returns dengan status PENDING\n        const returnResponse = await axios.get('http://localhost:8080/api/v1/pembelian/purchase-returns', {\n          params: {\n            status: 'PENDING',\n            size: 1\n          },\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        dashboardData.value.returns_to_review = returnResponse.data.total || 0;\n\n        // Ambil jumlah produk dengan stok > 0\n        const productResponse = await axios.get('http://localhost:8080/api/v1/products', {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        dashboardData.value.products_in_stock = productResponse.data.filter(product => product.stock > 0).length;\n      } catch (error) {\n        console.error('Gagal mengambil data dashboard:', error);\n        if (error.response) {\n          if (error.response.status === 401) {\n            toast.error('Sesi Anda telah berakhir. Silakan login kembali.');\n          } else if (error.response.status === 404) {\n            toast.error('Endpoint tidak ditemukan. Periksa konfigurasi server.');\n          } else {\n            toast.error('Terjadi kesalahan saat memuat data.');\n          }\n        } else {\n          toast.error('Koneksi ke server gagal. Periksa jaringan Anda.');\n        }\n      }\n    };\n\n    // Panggil fungsi saat komponen dimuat\n    onMounted(fetchDashboardData);\n    const __returned__ = {\n      dashboardData,\n      toast,\n      fetchDashboardData,\n      ref,\n      onMounted,\n      PurchasingLayouts,\n      get axios() {\n        return axios;\n      },\n      get useToast() {\n        return useToast;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","PurchasingLayouts","axios","useToast","dashboardData","purchase_orders_to_process","returns_to_review","products_in_stock","toast","fetchDashboardData","token","localStorage","getItem","Error","purchaseResponse","get","params","status","size","headers","Authorization","value","data","total","returnResponse","productResponse","filter","product","stock","length","error","console","response"],"sources":["C:/Users/Personal/Documents/PKL/aplikasi/aplikasi/src/views/DashboardPembelian.vue"],"sourcesContent":["<template>\n  <PurchasingLayouts>\n    <div class=\"p-8\">\n      <div class=\"mb-6\">\n        <h1 class=\"text-[#111418] text-[32px] font-bold leading-tight tracking-[-0.015em]\">\n          Purchase Dashboard\n        </h1>\n        <p class=\"text-[#60758a] text-sm font-normal leading-normal mt-1\">\n          Welcome back, Sarah! Here's an overview of your purchase activities.\n        </p>\n      </div>\n\n      <div class=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8\">\n        <div class=\"flex flex-col gap-2 rounded-lg p-6 border border-[#dbe0e6]\">\n          <p class=\"text-[#111418] text-base font-medium leading-normal\">\n            Purchase Orders to Process\n          </p>\n          <p class=\"text-[#111418] text-2xl font-bold leading-tight\">\n            {{ dashboardData.purchase_orders_to_process || 0 }}\n          </p>\n        </div>\n        <div class=\"flex flex-col gap-2 rounded-lg p-6 border border-[#dbe0e6]\">\n          <p class=\"text-[#111418] text-base font-medium leading-normal\">\n            Returns to Review\n          </p>\n          <p class=\"text-[#111418] text-2xl font-bold leading-tight\">\n            {{ dashboardData.returns_to_review || 0 }}\n          </p>\n        </div>\n        <div class=\"flex flex-col gap-2 rounded-lg p-6 border border-[#dbe0e6]\">\n          <p class=\"text-[#111418] text-base font-medium leading-normal\">\n            Products in Stock\n          </p>\n          <p class=\"text-[#111418] text-2xl font-bold leading-tight\">\n            {{ dashboardData.products_in_stock || 0 }}\n          </p>\n        </div>\n      </div>\n    </div>\n  </PurchasingLayouts>\n</template>\n\n<script setup>\nimport { ref, onMounted } from 'vue';\nimport PurchasingLayouts from '../components/PurchasingLayouts.vue';\nimport axios from 'axios';\nimport { useToast } from 'vue-toastification'; // Untuk notifikasi error\n\n// State untuk menyimpan data dashboard\nconst dashboardData = ref({\n  purchase_orders_to_process: 0,\n  returns_to_review: 0,\n  products_in_stock: 0,\n});\n\n// Inisialisasi toast untuk notifikasi\nconst toast = useToast();\n\n// Fungsi untuk mengambil data dari backend\nconst fetchDashboardData = async () => {\n  try {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      throw new Error('Token autentikasi tidak ditemukan. Silakan login kembali.');\n    }\n\n    // Ambil jumlah purchase orders dengan status SUBMITTED\n    const purchaseResponse = await axios.get('http://localhost:8080/api/v1/pembelian/purchases', {\n      params: { status: 'SUBMITTED', size: 1 },\n      headers: { Authorization: `Bearer ${token}` },\n    });\n    dashboardData.value.purchase_orders_to_process = purchaseResponse.data.total || 0;\n\n    // Ambil jumlah purchase returns dengan status PENDING\n    const returnResponse = await axios.get('http://localhost:8080/api/v1/pembelian/purchase-returns', {\n      params: { status: 'PENDING', size: 1 },\n      headers: { Authorization: `Bearer ${token}` },\n    });\n    dashboardData.value.returns_to_review = returnResponse.data.total || 0;\n\n    // Ambil jumlah produk dengan stok > 0\n    const productResponse = await axios.get('http://localhost:8080/api/v1/products', {\n      headers: { Authorization: `Bearer ${token}` },\n    });\n    dashboardData.value.products_in_stock = productResponse.data.filter(product => product.stock > 0).length;\n\n  } catch (error) {\n    console.error('Gagal mengambil data dashboard:', error);\n    if (error.response) {\n      if (error.response.status === 401) {\n        toast.error('Sesi Anda telah berakhir. Silakan login kembali.');\n      } else if (error.response.status === 404) {\n        toast.error('Endpoint tidak ditemukan. Periksa konfigurasi server.');\n      } else {\n        toast.error('Terjadi kesalahan saat memuat data.');\n      }\n    } else {\n      toast.error('Koneksi ke server gagal. Periksa jaringan Anda.');\n    }\n  }\n};\n\n// Panggil fungsi saat komponen dimuat\nonMounted(fetchDashboardData);\n</script>"],"mappings":";;AA2CA,SAASA,GAAG,EAAEC,SAAS,QAAQ,KAAK;AACpC,OAAOC,iBAAiB,MAAM,qCAAqC;AACnE,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,QAAQ,QAAQ,oBAAoB,CAAC,CAAC;;AAE/C;;;;;;;;IACA,MAAMC,aAAa,GAAGL,GAAG,CAAC;MACxBM,0BAA0B,EAAE,CAAC;MAC7BC,iBAAiB,EAAE,CAAC;MACpBC,iBAAiB,EAAE;IACrB,CAAC,CAAC;;IAEF;IACA,MAAMC,KAAK,GAAGL,QAAQ,CAAC,CAAC;;IAExB;IACA,MAAMM,kBAAkB,GAAG,MAAAA,CAAA,KAAY;MACrC,IAAI;QACF,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;QAC3C,IAAI,CAACF,KAAK,EAAE;UACV,MAAM,IAAIG,KAAK,CAAC,2DAA2D,CAAC;QAC9E;;QAEA;QACA,MAAMC,gBAAgB,GAAG,MAAMZ,KAAK,CAACa,GAAG,CAAC,kDAAkD,EAAE;UAC3FC,MAAM,EAAE;YAAEC,MAAM,EAAE,WAAW;YAAEC,IAAI,EAAE;UAAE,CAAC;UACxCC,OAAO,EAAE;YAAEC,aAAa,EAAE,UAAUV,KAAK;UAAG;QAC9C,CAAC,CAAC;QACFN,aAAa,CAACiB,KAAK,CAAChB,0BAA0B,GAAGS,gBAAgB,CAACQ,IAAI,CAACC,KAAK,IAAI,CAAC;;QAEjF;QACA,MAAMC,cAAc,GAAG,MAAMtB,KAAK,CAACa,GAAG,CAAC,yDAAyD,EAAE;UAChGC,MAAM,EAAE;YAAEC,MAAM,EAAE,SAAS;YAAEC,IAAI,EAAE;UAAE,CAAC;UACtCC,OAAO,EAAE;YAAEC,aAAa,EAAE,UAAUV,KAAK;UAAG;QAC9C,CAAC,CAAC;QACFN,aAAa,CAACiB,KAAK,CAACf,iBAAiB,GAAGkB,cAAc,CAACF,IAAI,CAACC,KAAK,IAAI,CAAC;;QAEtE;QACA,MAAME,eAAe,GAAG,MAAMvB,KAAK,CAACa,GAAG,CAAC,uCAAuC,EAAE;UAC/EI,OAAO,EAAE;YAAEC,aAAa,EAAE,UAAUV,KAAK;UAAG;QAC9C,CAAC,CAAC;QACFN,aAAa,CAACiB,KAAK,CAACd,iBAAiB,GAAGkB,eAAe,CAACH,IAAI,CAACI,MAAM,CAACC,OAAO,IAAIA,OAAO,CAACC,KAAK,GAAG,CAAC,CAAC,CAACC,MAAM;MAE1G,CAAC,CAAC,OAAOC,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,iCAAiC,EAAEA,KAAK,CAAC;QACvD,IAAIA,KAAK,CAACE,QAAQ,EAAE;UAClB,IAAIF,KAAK,CAACE,QAAQ,CAACf,MAAM,KAAK,GAAG,EAAE;YACjCT,KAAK,CAACsB,KAAK,CAAC,kDAAkD,CAAC;UACjE,CAAC,MAAM,IAAIA,KAAK,CAACE,QAAQ,CAACf,MAAM,KAAK,GAAG,EAAE;YACxCT,KAAK,CAACsB,KAAK,CAAC,uDAAuD,CAAC;UACtE,CAAC,MAAM;YACLtB,KAAK,CAACsB,KAAK,CAAC,qCAAqC,CAAC;UACpD;QACF,CAAC,MAAM;UACLtB,KAAK,CAACsB,KAAK,CAAC,iDAAiD,CAAC;QAChE;MACF;IACF,CAAC;;IAED;IACA9B,SAAS,CAACS,kBAAkB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}