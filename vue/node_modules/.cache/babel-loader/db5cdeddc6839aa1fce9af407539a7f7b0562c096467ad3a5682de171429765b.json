{"ast":null,"code":"import { ref, onMounted, computed } from \"vue\";\nimport { initializeApp } from \"https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js\";\nimport { getFirestore, doc, getDoc, setDoc, collection } from \"https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js\";\nimport { getAuth, signInWithCustomToken, signInAnonymously } from \"https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js\";\n\n// CATATAN PENTING: File ini mengimpor komponen OwnerLayouts.vue yang tidak tersedia di sini.\n// Untuk menjalankan kode ini, Anda harus memiliki file OwnerLayouts.vue yang sesuai.\n// Jika tidak, Anda akan mendapatkan error.\n\n// --- KONFIGURASI FIREBASE (WAJIB) ---\n\nexport default {\n  __name: 'EditUnitOwner',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');\n    const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;\n    const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';\n\n    // Inisialisasi Firebase\n    const app = initializeApp(firebaseConfig);\n    const db = getFirestore(app);\n    const auth = getAuth(app);\n    const unit = ref({\n      Name: \"\"\n    });\n    const isEdit = ref(false);\n    const editingUnitId = ref(null);\n    const isSaving = ref(false);\n    const messageText = ref(null);\n    const messageType = ref('success');\n    const messageClass = computed(() => ({\n      'bg-green-500': messageType.value === 'success',\n      'bg-red-500': messageType.value === 'error'\n    }));\n\n    // Fungsi untuk menampilkan pesan kustom\n    const showMessage = (text, type = 'success', duration = 3000) => {\n      messageText.value = text;\n      messageType.value = type;\n      setTimeout(() => {\n        messageText.value = null;\n      }, duration);\n    };\n\n    // Fungsi untuk mengambil data unit dari Firestore\n    const fetchUnit = async id => {\n      const docRef = doc(db, `artifacts/${appId}/users/${auth.currentUser.uid}/units`, id);\n      try {\n        const docSnap = await getDoc(docRef);\n        if (docSnap.exists()) {\n          const data = docSnap.data();\n          unit.value.Name = data.Name;\n        } else {\n          showMessage(\"Dokumen unit tidak ditemukan.\", 'error');\n          resetFormAndNavigate();\n        }\n      } catch (error) {\n        console.error(\"Gagal mengambil data unit:\", error);\n        showMessage(\"Gagal mengambil data unit.\", 'error');\n      }\n    };\n\n    // Fungsi untuk menyimpan atau memperbarui data unit ke Firestore\n    const handleSubmit = async () => {\n      isSaving.value = true;\n      try {\n        if (!unit.value.Name) {\n          showMessage(\"Nama unit harus diisi.\", 'error');\n          return;\n        }\n        const userId = auth.currentUser.uid;\n        const collectionPath = `artifacts/${appId}/users/${userId}/units`;\n        if (isEdit.value && editingUnitId.value) {\n          const unitDocRef = doc(db, collectionPath, editingUnitId.value);\n          await setDoc(unitDocRef, {\n            ...unit.value\n          });\n          showMessage(\"Unit berhasil diperbarui!\");\n        } else {\n          const newUnitDocRef = doc(collection(db, collectionPath));\n          await setDoc(newUnitDocRef, {\n            ...unit.value\n          });\n          showMessage(\"Unit berhasil ditambahkan!\");\n        }\n        resetFormAndNavigate();\n      } catch (error) {\n        console.error(\"Gagal menyimpan unit:\", error);\n        showMessage(\"Gagal menyimpan unit. Lihat konsol untuk detail.\", 'error');\n      } finally {\n        isSaving.value = false;\n      }\n    };\n\n    // Fungsi untuk mengatur ulang formulir dan mensimulasikan navigasi\n    const resetFormAndNavigate = () => {\n      unit.value = {\n        Name: \"\"\n      };\n      isEdit.value = false;\n      editingUnitId.value = null;\n    };\n\n    // Simulasi inisiasi edit pada saat mount\n    // Dalam aplikasi nyata, ID akan didapat dari route.params.id\n    onMounted(async () => {\n      if (initialAuthToken) {\n        await signInWithCustomToken(auth, initialAuthToken);\n      } else {\n        await signInAnonymously(auth);\n      }\n\n      // Contoh: Jika Anda ingin mengedit, atur isEdit menjadi true dan berikan ID dokumen.\n      // Anda bisa mengganti 'contoh_id_unit' dengan ID dokumen dari Firestore.\n      // editingUnitId.value = 'contoh_id_unit';\n      // isEdit.value = true;\n      // if (isEdit.value) {\n      //   fetchUnit(editingUnitId.value);\n      // }\n    });\n    const __returned__ = {\n      firebaseConfig,\n      initialAuthToken,\n      appId,\n      app,\n      db,\n      auth,\n      unit,\n      isEdit,\n      editingUnitId,\n      isSaving,\n      messageText,\n      messageType,\n      messageClass,\n      showMessage,\n      fetchUnit,\n      handleSubmit,\n      resetFormAndNavigate,\n      ref,\n      onMounted,\n      computed,\n      get initializeApp() {\n        return initializeApp;\n      },\n      get getFirestore() {\n        return getFirestore;\n      },\n      get doc() {\n        return doc;\n      },\n      get getDoc() {\n        return getDoc;\n      },\n      get setDoc() {\n        return setDoc;\n      },\n      get collection() {\n        return collection;\n      },\n      get getAuth() {\n        return getAuth;\n      },\n      get signInWithCustomToken() {\n        return signInWithCustomToken;\n      },\n      get signInAnonymously() {\n        return signInAnonymously;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","computed","initializeApp","getFirestore","doc","getDoc","setDoc","collection","getAuth","signInWithCustomToken","signInAnonymously","firebaseConfig","JSON","parse","__firebase_config","initialAuthToken","__initial_auth_token","appId","__app_id","app","db","auth","unit","Name","isEdit","editingUnitId","isSaving","messageText","messageType","messageClass","value","showMessage","text","type","duration","setTimeout","fetchUnit","id","docRef","currentUser","uid","docSnap","exists","data","resetFormAndNavigate","error","console","handleSubmit","userId","collectionPath","unitDocRef","newUnitDocRef"],"sources":["C:/Users/SPC STYLE 5/aplikasi/src/views/EditUnitOwner.vue"],"sourcesContent":["<template>\r\n  <OwnerLayouts>\r\n    <div class=\"p-8\">\r\n      <!-- Judul dan tombol kembali -->\r\n      <div class=\"flex flex-wrap items-center justify-between gap-3 p-4\">\r\n        <p\r\n          class=\"text-[#111418] tracking-light text-[32px] font-bold leading-tight min-w-72\"\r\n        >\r\n          {{ isEdit ? \"Edit Unit\" : \"Add Unit\" }}\r\n        </p>\r\n        <button\r\n          @click=\"resetFormAndNavigate\"\r\n          class=\"flex items-center gap-2 text-[#60758a] text-base font-normal leading-normal\"\r\n        >\r\n          <svg\r\n            xmlns=\"http://www.w3.org/2000/svg\"\r\n            width=\"20px\"\r\n            height=\"20px\"\r\n            viewBox=\"0 0 24 24\"\r\n            fill=\"none\"\r\n            stroke=\"currentColor\"\r\n            stroke-width=\"2\"\r\n            stroke-linecap=\"round\"\r\n            stroke-linejoin=\"round\"\r\n          >\r\n            <path d=\"M19 12H5\"></path>\r\n            <path d=\"M12 19L5 12L12 5\"></path>\r\n          </svg>\r\n          <span class=\"truncate\">Kembali</span>\r\n        </button>\r\n      </div>\r\n\r\n      <!-- Kotak pesan/alert kustom -->\r\n      <div v-if=\"messageText\" :class=\"messageClass\" class=\"p-4 rounded-lg mb-4 text-center text-white mx-4\">\r\n        {{ messageText }}\r\n      </div>\r\n\r\n      <!-- Formulir -->\r\n      <form\r\n        @submit.prevent=\"handleSubmit\"\r\n        class=\"flex flex-col w-[512px] max-w-[512px] py-5\"\r\n      >\r\n        <div class=\"flex flex-col flex-wrap items-end gap-4 px-4 py-3\">\r\n          <label class=\"flex flex-col min-w-40 flex-1 w-full\">\r\n            <p class=\"text-[#111418] text-base font-medium leading-normal pb-2\">\r\n              Name\r\n            </p>\r\n            <input\r\n              v-model=\"unit.Name\"\r\n              placeholder=\"Enter unit name\"\r\n              class=\"form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-[#111418] focus:outline-0 focus:ring-0 border border-[#dbe0e6] bg-white focus:border-[#dbe0e6] h-14 placeholder:text-[#60758a] p-[15px] text-base font-normal leading-normal\"\r\n            />\r\n          </label>\r\n        </div>\r\n        <div class=\"flex justify-stretch\">\r\n          <div class=\"flex flex-1 gap-3 flex-wrap px-4 py-3 justify-end\">\r\n            <!-- Tombol \"Cancel\" -->\r\n            <button\r\n              type=\"button\"\r\n              @click=\"resetFormAndNavigate\"\r\n              class=\"flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-[#f0f2f5] text-[#111418] text-sm font-bold leading-normal tracking-[0.015em]\"\r\n            >\r\n              <span class=\"truncate\">Cancel</span>\r\n            </button>\r\n            <!-- Tombol \"Save\" -->\r\n            <button\r\n              type=\"submit\"\r\n              :disabled=\"isSaving\"\r\n              class=\"flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-[#0d80f2] text-white text-sm font-bold leading-normal tracking-[0.015em] disabled:opacity-50\"\r\n            >\r\n              <span class=\"truncate\">{{ isSaving ? \"Saving...\" : \"Save\" }}</span>\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  </OwnerLayouts>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, computed } from \"vue\";\r\nimport { initializeApp } from \"https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js\";\r\nimport { getFirestore, doc, getDoc, setDoc, collection } from \"https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js\";\r\nimport { getAuth, signInWithCustomToken, signInAnonymously } from \"https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js\";\r\n\r\n// CATATAN PENTING: File ini mengimpor komponen OwnerLayouts.vue yang tidak tersedia di sini.\r\n// Untuk menjalankan kode ini, Anda harus memiliki file OwnerLayouts.vue yang sesuai.\r\n// Jika tidak, Anda akan mendapatkan error.\r\n\r\n// --- KONFIGURASI FIREBASE (WAJIB) ---\r\nconst firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');\r\nconst initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;\r\nconst appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';\r\n\r\n// Inisialisasi Firebase\r\nconst app = initializeApp(firebaseConfig);\r\nconst db = getFirestore(app);\r\nconst auth = getAuth(app);\r\n\r\nconst unit = ref({\r\n  Name: \"\",\r\n});\r\n\r\nconst isEdit = ref(false);\r\nconst editingUnitId = ref(null);\r\nconst isSaving = ref(false);\r\nconst messageText = ref(null);\r\nconst messageType = ref('success');\r\n\r\nconst messageClass = computed(() => ({\r\n  'bg-green-500': messageType.value === 'success',\r\n  'bg-red-500': messageType.value === 'error',\r\n}));\r\n\r\n// Fungsi untuk menampilkan pesan kustom\r\nconst showMessage = (text, type = 'success', duration = 3000) => {\r\n  messageText.value = text;\r\n  messageType.value = type;\r\n  setTimeout(() => {\r\n    messageText.value = null;\r\n  }, duration);\r\n};\r\n\r\n// Fungsi untuk mengambil data unit dari Firestore\r\nconst fetchUnit = async (id) => {\r\n  const docRef = doc(db, `artifacts/${appId}/users/${auth.currentUser.uid}/units`, id);\r\n  try {\r\n    const docSnap = await getDoc(docRef);\r\n    if (docSnap.exists()) {\r\n      const data = docSnap.data();\r\n      unit.value.Name = data.Name;\r\n    } else {\r\n      showMessage(\"Dokumen unit tidak ditemukan.\", 'error');\r\n      resetFormAndNavigate();\r\n    }\r\n  } catch (error) {\r\n    console.error(\"Gagal mengambil data unit:\", error);\r\n    showMessage(\"Gagal mengambil data unit.\", 'error');\r\n  }\r\n};\r\n\r\n// Fungsi untuk menyimpan atau memperbarui data unit ke Firestore\r\nconst handleSubmit = async () => {\r\n  isSaving.value = true;\r\n  try {\r\n    if (!unit.value.Name) {\r\n      showMessage(\"Nama unit harus diisi.\", 'error');\r\n      return;\r\n    }\r\n\r\n    const userId = auth.currentUser.uid;\r\n    const collectionPath = `artifacts/${appId}/users/${userId}/units`;\r\n\r\n    if (isEdit.value && editingUnitId.value) {\r\n      const unitDocRef = doc(db, collectionPath, editingUnitId.value);\r\n      await setDoc(unitDocRef, { ...unit.value });\r\n      showMessage(\"Unit berhasil diperbarui!\");\r\n    } else {\r\n      const newUnitDocRef = doc(collection(db, collectionPath));\r\n      await setDoc(newUnitDocRef, { ...unit.value });\r\n      showMessage(\"Unit berhasil ditambahkan!\");\r\n    }\r\n    resetFormAndNavigate();\r\n  } catch (error) {\r\n    console.error(\"Gagal menyimpan unit:\", error);\r\n    showMessage(\"Gagal menyimpan unit. Lihat konsol untuk detail.\", 'error');\r\n  } finally {\r\n    isSaving.value = false;\r\n  }\r\n};\r\n\r\n// Fungsi untuk mengatur ulang formulir dan mensimulasikan navigasi\r\nconst resetFormAndNavigate = () => {\r\n  unit.value = { Name: \"\" };\r\n  isEdit.value = false;\r\n  editingUnitId.value = null;\r\n};\r\n\r\n// Simulasi inisiasi edit pada saat mount\r\n// Dalam aplikasi nyata, ID akan didapat dari route.params.id\r\nonMounted(async () => {\r\n  if (initialAuthToken) {\r\n    await signInWithCustomToken(auth, initialAuthToken);\r\n  } else {\r\n    await signInAnonymously(auth);\r\n  }\r\n\r\n  // Contoh: Jika Anda ingin mengedit, atur isEdit menjadi true dan berikan ID dokumen.\r\n  // Anda bisa mengganti 'contoh_id_unit' dengan ID dokumen dari Firestore.\r\n  // editingUnitId.value = 'contoh_id_unit';\r\n  // isEdit.value = true;\r\n  // if (isEdit.value) {\r\n  //   fetchUnit(editingUnitId.value);\r\n  // }\r\n});\r\n</script>\r\n"],"mappings":"AAgFA,SAASA,GAAG,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,KAAK;AAC9C,SAASC,aAAa,QAAQ,2DAA2D;AACzF,SAASC,YAAY,EAAEC,GAAG,EAAEC,MAAM,EAAEC,MAAM,EAAEC,UAAU,QAAQ,iEAAiE;AAC/H,SAASC,OAAO,EAAEC,qBAAqB,EAAEC,iBAAiB,QAAQ,4DAA4D;;AAE9H;AACA;AACA;;AAEA;;;;;;;;IACA,MAAMC,cAAc,GAAGC,IAAI,CAACC,KAAK,CAAC,OAAOC,iBAAiB,KAAK,WAAW,GAAGA,iBAAiB,GAAG,IAAI,CAAC;IACtG,MAAMC,gBAAgB,GAAG,OAAOC,oBAAoB,KAAK,WAAW,GAAGA,oBAAoB,GAAG,IAAI;IAClG,MAAMC,KAAK,GAAG,OAAOC,QAAQ,KAAK,WAAW,GAAGA,QAAQ,GAAG,gBAAgB;;IAE3E;IACA,MAAMC,GAAG,GAAGjB,aAAa,CAACS,cAAc,CAAC;IACzC,MAAMS,EAAE,GAAGjB,YAAY,CAACgB,GAAG,CAAC;IAC5B,MAAME,IAAI,GAAGb,OAAO,CAACW,GAAG,CAAC;IAEzB,MAAMG,IAAI,GAAGvB,GAAG,CAAC;MACfwB,IAAI,EAAE;IACR,CAAC,CAAC;IAEF,MAAMC,MAAM,GAAGzB,GAAG,CAAC,KAAK,CAAC;IACzB,MAAM0B,aAAa,GAAG1B,GAAG,CAAC,IAAI,CAAC;IAC/B,MAAM2B,QAAQ,GAAG3B,GAAG,CAAC,KAAK,CAAC;IAC3B,MAAM4B,WAAW,GAAG5B,GAAG,CAAC,IAAI,CAAC;IAC7B,MAAM6B,WAAW,GAAG7B,GAAG,CAAC,SAAS,CAAC;IAElC,MAAM8B,YAAY,GAAG5B,QAAQ,CAAC,OAAO;MACnC,cAAc,EAAE2B,WAAW,CAACE,KAAK,KAAK,SAAS;MAC/C,YAAY,EAAEF,WAAW,CAACE,KAAK,KAAK;IACtC,CAAC,CAAC,CAAC;;IAEH;IACA,MAAMC,WAAW,GAAGA,CAACC,IAAI,EAAEC,IAAI,GAAG,SAAS,EAAEC,QAAQ,GAAG,IAAI,KAAK;MAC/DP,WAAW,CAACG,KAAK,GAAGE,IAAI;MACxBJ,WAAW,CAACE,KAAK,GAAGG,IAAI;MACxBE,UAAU,CAAC,MAAM;QACfR,WAAW,CAACG,KAAK,GAAG,IAAI;MAC1B,CAAC,EAAEI,QAAQ,CAAC;IACd,CAAC;;IAED;IACA,MAAME,SAAS,GAAG,MAAOC,EAAE,IAAK;MAC9B,MAAMC,MAAM,GAAGlC,GAAG,CAACgB,EAAE,EAAE,aAAaH,KAAK,UAAUI,IAAI,CAACkB,WAAW,CAACC,GAAG,QAAQ,EAAEH,EAAE,CAAC;MACpF,IAAI;QACF,MAAMI,OAAO,GAAG,MAAMpC,MAAM,CAACiC,MAAM,CAAC;QACpC,IAAIG,OAAO,CAACC,MAAM,CAAC,CAAC,EAAE;UACpB,MAAMC,IAAI,GAAGF,OAAO,CAACE,IAAI,CAAC,CAAC;UAC3BrB,IAAI,CAACQ,KAAK,CAACP,IAAI,GAAGoB,IAAI,CAACpB,IAAI;QAC7B,CAAC,MAAM;UACLQ,WAAW,CAAC,+BAA+B,EAAE,OAAO,CAAC;UACrDa,oBAAoB,CAAC,CAAC;QACxB;MACF,CAAC,CAAC,OAAOC,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;QAClDd,WAAW,CAAC,4BAA4B,EAAE,OAAO,CAAC;MACpD;IACF,CAAC;;IAED;IACA,MAAMgB,YAAY,GAAG,MAAAA,CAAA,KAAY;MAC/BrB,QAAQ,CAACI,KAAK,GAAG,IAAI;MACrB,IAAI;QACF,IAAI,CAACR,IAAI,CAACQ,KAAK,CAACP,IAAI,EAAE;UACpBQ,WAAW,CAAC,wBAAwB,EAAE,OAAO,CAAC;UAC9C;QACF;QAEA,MAAMiB,MAAM,GAAG3B,IAAI,CAACkB,WAAW,CAACC,GAAG;QACnC,MAAMS,cAAc,GAAG,aAAahC,KAAK,UAAU+B,MAAM,QAAQ;QAEjE,IAAIxB,MAAM,CAACM,KAAK,IAAIL,aAAa,CAACK,KAAK,EAAE;UACvC,MAAMoB,UAAU,GAAG9C,GAAG,CAACgB,EAAE,EAAE6B,cAAc,EAAExB,aAAa,CAACK,KAAK,CAAC;UAC/D,MAAMxB,MAAM,CAAC4C,UAAU,EAAE;YAAE,GAAG5B,IAAI,CAACQ;UAAM,CAAC,CAAC;UAC3CC,WAAW,CAAC,2BAA2B,CAAC;QAC1C,CAAC,MAAM;UACL,MAAMoB,aAAa,GAAG/C,GAAG,CAACG,UAAU,CAACa,EAAE,EAAE6B,cAAc,CAAC,CAAC;UACzD,MAAM3C,MAAM,CAAC6C,aAAa,EAAE;YAAE,GAAG7B,IAAI,CAACQ;UAAM,CAAC,CAAC;UAC9CC,WAAW,CAAC,4BAA4B,CAAC;QAC3C;QACAa,oBAAoB,CAAC,CAAC;MACxB,CAAC,CAAC,OAAOC,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAAC;QAC7Cd,WAAW,CAAC,kDAAkD,EAAE,OAAO,CAAC;MAC1E,CAAC,SAAS;QACRL,QAAQ,CAACI,KAAK,GAAG,KAAK;MACxB;IACF,CAAC;;IAED;IACA,MAAMc,oBAAoB,GAAGA,CAAA,KAAM;MACjCtB,IAAI,CAACQ,KAAK,GAAG;QAAEP,IAAI,EAAE;MAAG,CAAC;MACzBC,MAAM,CAACM,KAAK,GAAG,KAAK;MACpBL,aAAa,CAACK,KAAK,GAAG,IAAI;IAC5B,CAAC;;IAED;IACA;IACA9B,SAAS,CAAC,YAAY;MACpB,IAAIe,gBAAgB,EAAE;QACpB,MAAMN,qBAAqB,CAACY,IAAI,EAAEN,gBAAgB,CAAC;MACrD,CAAC,MAAM;QACL,MAAML,iBAAiB,CAACW,IAAI,CAAC;MAC/B;;MAEA;MACA;MACA;MACA;MACA;MACA;MACA;IACF,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}