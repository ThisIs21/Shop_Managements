{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.every.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport { ref, computed, onMounted } from \"vue\";\nimport GudangLayouts from \"@/components/GudangLayouts.vue\";\nimport axios from \"axios\";\nexport default {\n  __name: 'DashboardGudang',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const stockOpnames = ref([]);\n    const loading = ref(false);\n    const products = ref([]);\n    const opnameForm = ref({\n      date: new Date().toISOString().split(\"T\")[0],\n      // Default to current date: 2025-10-02\n      note: \"\",\n      items: [{\n        product_id: null,\n        qty_fisik: 0\n      }]\n    });\n    const submitting = ref(false);\n    const errorMessage = ref(\"\");\n    const api = axios.create({\n      baseURL: \"http://localhost:8081/api/v1\"\n    });\n    const savedToken = localStorage.getItem(\"token\");\n    if (savedToken) {\n      api.defaults.headers.common[\"Authorization\"] = `Bearer ${savedToken}`;\n    }\n\n    // Current date for input min attribute (02/10/2025)\n    const currentDate = computed(() => new Date().toISOString().split(\"T\")[0]);\n    const fetchStockOpnames = async () => {\n      loading.value = true;\n      try {\n        const response = await api.get(\"/gudang/stock-opnames\", {\n          params: {\n            limit: 3,\n            sort: \"date_desc\"\n          }\n        });\n        stockOpnames.value = response.data.data.map(op => ({\n          ID: op.ID,\n          Date: op.Date,\n          Status: op.Status || \"Pending\",\n          ProductsCount: op.Items.length,\n          StaffName: op.User.Name || \"Unknown\"\n        }));\n      } catch (error) {\n        console.error(\"Gagal fetch stock opnames:\", error);\n        alert(\"Gagal memuat data stock opname.\");\n      } finally {\n        loading.value = false;\n      }\n    };\n    const fetchProducts = async () => {\n      try {\n        const response = await api.get(\"/products\");\n        products.value = response.data.data;\n      } catch (error) {\n        console.error(\"Gagal fetch products:\", error);\n      }\n    };\n    const addItem = () => {\n      opnameForm.value.items.push({\n        product_id: null,\n        qty_fisik: 0\n      });\n    };\n    const removeItem = index => {\n      opnameForm.value.items.splice(index, 1);\n    };\n    const isFormValid = computed(() => {\n      return opnameForm.value.items.every(item => item.product_id && item.qty_fisik >= 0);\n    });\n    const submitOpname = async () => {\n      if (!isFormValid.value) {\n        errorMessage.value = \"Please fill all fields with valid data.\";\n        return;\n      }\n      submitting.value = true;\n      errorMessage.value = \"\";\n      try {\n        await api.post(\"/gudang/stock-opnames\", {\n          date: opnameForm.value.date,\n          note: opnameForm.value.note,\n          items: opnameForm.value.items.filter(item => item.product_id && item.qty_fisik >= 0)\n        });\n        alert(\"Stock opname berhasil dibuat!\");\n        opnameForm.value = {\n          date: new Date().toISOString().split(\"T\")[0],\n          note: \"\",\n          items: [{\n            product_id: null,\n            qty_fisik: 0\n          }]\n        };\n        fetchStockOpnames();\n      } catch (error) {\n        console.error(\"Gagal submit opname:\", error);\n        errorMessage.value = \"Gagal membuat stock opname: \" + (error.response?.data?.error || error.message);\n      } finally {\n        submitting.value = false;\n      }\n    };\n    const formatDate = dateStr => {\n      if (!dateStr) return \"N/A\";\n      const date = new Date(dateStr);\n      return date.toLocaleDateString(\"id-ID\", {\n        day: \"2-digit\",\n        month: \"2-digit\",\n        year: \"numeric\"\n      });\n    };\n    onMounted(() => {\n      fetchStockOpnames();\n      fetchProducts();\n    });\n    const __returned__ = {\n      stockOpnames,\n      loading,\n      products,\n      opnameForm,\n      submitting,\n      errorMessage,\n      api,\n      savedToken,\n      currentDate,\n      fetchStockOpnames,\n      fetchProducts,\n      addItem,\n      removeItem,\n      isFormValid,\n      submitOpname,\n      formatDate,\n      ref,\n      computed,\n      onMounted,\n      GudangLayouts,\n      get axios() {\n        return axios;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","GudangLayouts","axios","stockOpnames","loading","products","opnameForm","date","Date","toISOString","split","note","items","product_id","qty_fisik","submitting","errorMessage","api","create","baseURL","savedToken","localStorage","getItem","defaults","headers","common","currentDate","fetchStockOpnames","value","response","get","params","limit","sort","data","map","op","ID","Status","ProductsCount","Items","length","StaffName","User","Name","error","console","alert","fetchProducts","addItem","push","removeItem","index","splice","isFormValid","every","item","submitOpname","post","filter","message","formatDate","dateStr","toLocaleDateString","day","month","year"],"sources":["C:/Users/Personal/Documents/PKL/aplikasi/aplikasi/src/views/DashboardGudang.vue"],"sourcesContent":["<template>\n  <GudangLayouts>\n    <div class=\"space-y-6\">\n      <div>\n        <h1 class=\"text-3xl font-bold text-gray-900\">Warehouse Staff Dashboard</h1>\n        <p class=\"text-lg text-gray-600 mt-1\">Welcome back! Here's an overview of your warehouse activities.</p>\n      </div>\n\n      <!-- Section: Stock Opname Terbaru -->\n      <div class=\"bg-white rounded-lg shadow-sm p-6 border border-gray-200\">\n        <div class=\"flex justify-between items-center mb-4\">\n          <h2 class=\"text-xl font-semibold text-gray-800\">Stock Opname Terbaru</h2>\n          <button\n            @click=\"fetchStockOpnames\"\n            :disabled=\"loading\"\n            class=\"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:opacity-50\"\n          >\n            {{ loading ? \"Loading...\" : \"Refresh\" }}\n          </button>\n        </div>\n        <div class=\"overflow-x-auto\">\n          <table class=\"min-w-full divide-y divide-gray-200\">\n            <thead class=\"bg-gray-50\">\n              <tr>\n                <th\n                  class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\"\n                >\n                  Date\n                </th>\n                <th\n                  class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\"\n                >\n                  Status\n                </th>\n                <th\n                  class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\"\n                >\n                  Products Count\n                </th>\n                <th\n                  class=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\"\n                >\n                  Staff\n                </th>\n              </tr>\n            </thead>\n            <tbody class=\"bg-white divide-y divide-gray-200\">\n              <tr v-if=\"loading\">\n                <td colspan=\"4\" class=\"px-6 py-4 text-center text-sm text-gray-500\">Loading...</td>\n              </tr>\n              <tr v-else-if=\"stockOpnames.length === 0\">\n                <td colspan=\"4\" class=\"px-6 py-4 text-center text-sm text-gray-500\">No data available</td>\n              </tr>\n              <tr v-else v-for=\"opname in stockOpnames\" :key=\"opname.ID\">\n                <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">{{ formatDate(opname.Date) }}</td>\n                <td class=\"px-6 py-4 whitespace-nowrap text-sm\">\n                  <span\n                    class=\"inline-flex items-center rounded-full px-3 py-0.5 text-sm font-medium\"\n                    :class=\"{\n                      'bg-green-100 text-green-800': opname.Status === 'Completed',\n                      'bg-yellow-100 text-yellow-800': opname.Status === 'Pending'\n                    }\"\n                  >\n                    {{ opname.Status }}\n                  </span>\n                </td>\n                <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">{{ opname.ProductsCount }}</td>\n                <td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">{{ opname.StaffName }}</td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n\n      <!-- Section: Create New Stock Opname -->\n      <div class=\"bg-white rounded-lg shadow-sm p-6 border border-gray-200\">\n        <h2 class=\"text-xl font-semibold text-gray-800 mb-4\">Create New Stock Opname</h2>\n        <form @submit.prevent=\"submitOpname\" class=\"space-y-4\">\n          <div>\n            <label class=\"block text-sm font-medium text-gray-700\">Date</label>\n            <input\n              v-model=\"opnameForm.date\"\n              type=\"date\"\n              required\n              class=\"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500\"\n              :min=\"currentDate\"\n            >\n          </div>\n          <div>\n            <label class=\"block text-sm font-medium text-gray-700\">Note</label>\n            <textarea\n              v-model=\"opnameForm.note\"\n              class=\"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500\"\n              rows=\"3\"\n              placeholder=\"Enter any notes...\"\n            ></textarea>\n          </div>\n          <div>\n            <label class=\"block text-sm font-medium text-gray-700\">Items</label>\n            <div v-for=\"(item, index) in opnameForm.items\" :key=\"index\" class=\"flex space-x-2 mb-2 items-center\">\n              <select\n                v-model=\"item.product_id\"\n                required\n                class=\"w-1/3 border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500\"\n              >\n                <option value=\"\" disabled>Select Product</option>\n                <option v-for=\"product in products\" :key=\"product.id\" :value=\"product.id\">{{ product.name }}</option>\n              </select>\n              <input\n                v-model.number=\"item.qty_fisik\"\n                type=\"number\"\n                min=\"0\"\n                required\n                class=\"w-1/3 border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500\"\n                placeholder=\"Physical Qty\"\n              >\n              <button\n                @click.prevent=\"removeItem(index)\"\n                type=\"button\"\n                class=\"px-2 py-1 text-red-500 hover:text-red-700\"\n              >\n                Remove\n              </button>\n            </div>\n            <button\n              @click.prevent=\"addItem\"\n              type=\"button\"\n              class=\"mt-2 px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600\"\n            >\n              Add Item\n            </button>\n          </div>\n          <button\n            type=\"submit\"\n            :disabled=\"submitting || !isFormValid\"\n            class=\"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:opacity-50\"\n          >\n            {{ submitting ? \"Submitting...\" : \"Submit Opname\" }}\n          </button>\n          <p v-if=\"errorMessage\" class=\"text-red-500 text-sm mt-2\">{{ errorMessage }}</p>\n        </form>\n      </div>\n    </div>\n  </GudangLayouts>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted } from \"vue\";\nimport GudangLayouts from \"@/components/GudangLayouts.vue\";\nimport axios from \"axios\";\n\nconst stockOpnames = ref([]);\nconst loading = ref(false);\nconst products = ref([]);\nconst opnameForm = ref({\n  date: new Date().toISOString().split(\"T\")[0], // Default to current date: 2025-10-02\n  note: \"\",\n  items: [{ product_id: null, qty_fisik: 0 }],\n});\nconst submitting = ref(false);\nconst errorMessage = ref(\"\");\n\nconst api = axios.create({ baseURL: \"http://localhost:8081/api/v1\" });\nconst savedToken = localStorage.getItem(\"token\");\nif (savedToken) {\n  api.defaults.headers.common[\"Authorization\"] = `Bearer ${savedToken}`;\n}\n\n// Current date for input min attribute (02/10/2025)\nconst currentDate = computed(() => new Date().toISOString().split(\"T\")[0]);\n\nconst fetchStockOpnames = async () => {\n  loading.value = true;\n  try {\n    const response = await api.get(\"/gudang/stock-opnames\", {\n      params: { limit: 3, sort: \"date_desc\" },\n    });\n    stockOpnames.value = response.data.data.map(op => ({\n      ID: op.ID,\n      Date: op.Date,\n      Status: op.Status || \"Pending\",\n      ProductsCount: op.Items.length,\n      StaffName: op.User.Name || \"Unknown\",\n    }));\n  } catch (error) {\n    console.error(\"Gagal fetch stock opnames:\", error);\n    alert(\"Gagal memuat data stock opname.\");\n  } finally {\n    loading.value = false;\n  }\n};\n\nconst fetchProducts = async () => {\n  try {\n    const response = await api.get(\"/products\");\n    products.value = response.data.data;\n  } catch (error) {\n    console.error(\"Gagal fetch products:\", error);\n  }\n};\n\nconst addItem = () => {\n  opnameForm.value.items.push({ product_id: null, qty_fisik: 0 });\n};\n\nconst removeItem = (index) => {\n  opnameForm.value.items.splice(index, 1);\n};\n\nconst isFormValid = computed(() => {\n  return opnameForm.value.items.every(item => item.product_id && item.qty_fisik >= 0);\n});\n\nconst submitOpname = async () => {\n  if (!isFormValid.value) {\n    errorMessage.value = \"Please fill all fields with valid data.\";\n    return;\n  }\n\n  submitting.value = true;\n  errorMessage.value = \"\";\n  try {\n    await api.post(\"/gudang/stock-opnames\", {\n      date: opnameForm.value.date,\n      note: opnameForm.value.note,\n      items: opnameForm.value.items.filter(item => item.product_id && item.qty_fisik >= 0),\n    });\n    alert(\"Stock opname berhasil dibuat!\");\n    opnameForm.value = {\n      date: new Date().toISOString().split(\"T\")[0],\n      note: \"\",\n      items: [{ product_id: null, qty_fisik: 0 }],\n    };\n    fetchStockOpnames();\n  } catch (error) {\n    console.error(\"Gagal submit opname:\", error);\n    errorMessage.value = \"Gagal membuat stock opname: \" + (error.response?.data?.error || error.message);\n  } finally {\n    submitting.value = false;\n  }\n};\n\nconst formatDate = (dateStr) => {\n  if (!dateStr) return \"N/A\";\n  const date = new Date(dateStr);\n  return date.toLocaleDateString(\"id-ID\", {\n    day: \"2-digit\",\n    month: \"2-digit\",\n    year: \"numeric\",\n  });\n};\n\nonMounted(() => {\n  fetchStockOpnames();\n  fetchProducts();\n});\n</script>\n\n<style scoped>\n/* Gaya khusus untuk halaman ini jika ada */\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}