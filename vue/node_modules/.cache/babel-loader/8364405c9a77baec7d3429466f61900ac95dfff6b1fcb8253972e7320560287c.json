{"ast":null,"code":"import { ref, computed, onMounted } from \"vue\";\nimport axios from \"axios\";\n\n// STATE\n\nexport default {\n  __name: 'ReportStockOpnameOwners',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const stockOpnames = ref([]);\n    const page = ref(1);\n    const size = ref(10);\n    const total = ref(0);\n    const filters = ref({\n      startDate: \"\",\n      endDate: \"\",\n      search: \"\"\n    });\n\n    // COMPUTED\n    const totalPages = computed(() => Math.ceil(total.value / size.value));\n\n    // FUNCTION: fetch data dari backend\n    async function fetchStockOpnames() {\n      try {\n        const params = {\n          page: page.value,\n          size: size.value,\n          q: filters.value.search,\n          start_date: filters.value.startDate,\n          end_date: filters.value.endDate\n        };\n        const res = await axios.get(\"http://localhost:8081/api/v1/history/stock-opnames\", {\n          params\n        });\n        stockOpnames.value = res.data.data;\n        total.value = res.data.total;\n      } catch (err) {\n        console.error(\"Gagal ambil data:\", err);\n        stockOpnames.value = []; // fallback kosong\n      }\n    }\n\n    // FUNCTION: pagination\n    function nextPage() {\n      if (page.value < totalPages.value) {\n        page.value++;\n        fetchStockOpnames();\n      }\n    }\n    function prevPage() {\n      if (page.value > 1) {\n        page.value--;\n        fetchStockOpnames();\n      }\n    }\n\n    // FUNCTION: format tanggal\n    function formatDate(dt) {\n      if (!dt) return \"-\";\n      const d = new Date(dt);\n      return d.toLocaleDateString();\n    }\n\n    // FETCH saat mounted\n    onMounted(() => {\n      fetchStockOpnames();\n    });\n    const __returned__ = {\n      stockOpnames,\n      page,\n      size,\n      total,\n      filters,\n      totalPages,\n      fetchStockOpnames,\n      nextPage,\n      prevPage,\n      formatDate,\n      ref,\n      computed,\n      onMounted,\n      get axios() {\n        return axios;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","axios","stockOpnames","page","size","total","filters","startDate","endDate","search","totalPages","Math","ceil","value","fetchStockOpnames","params","q","start_date","end_date","res","get","data","err","console","error","nextPage","prevPage","formatDate","dt","d","Date","toLocaleDateString"],"sources":["C:/Users/Personal/Documents/PKL/aplikasi/aplikasi/src/views/ReportStockOpnameOwners.vue"],"sourcesContent":["<template>\n  <div class=\"p-4\">\n    <h2 class=\"text-xl font-bold mb-4\">Stock Opnames</h2>\n\n    <!-- FILTER -->\n    <div class=\"flex gap-4 mb-4\">\n      <input\n        type=\"date\"\n        v-model=\"filters.startDate\"\n        class=\"border p-2 rounded\"\n      />\n      <input type=\"date\" v-model=\"filters.endDate\" class=\"border p-2 rounded\" />\n      <input\n        type=\"text\"\n        v-model=\"filters.search\"\n        placeholder=\"Search user\"\n        class=\"border p-2 rounded\"\n      />\n      <button\n        @click=\"fetchStockOpnames\"\n        class=\"bg-blue-500 text-white px-4 py-2 rounded\"\n      >\n        Filter\n      </button>\n    </div>\n\n    <!-- TABLE -->\n    <table class=\"w-full border-collapse border border-gray-300\">\n      <thead class=\"bg-gray-200\">\n        <tr>\n          <th class=\"border px-2 py-1\">ID</th>\n          <th class=\"border px-2 py-1\">User</th>\n          <th class=\"border px-2 py-1\">Date</th>\n          <th class=\"border px-2 py-1\">Note</th>\n          <th class=\"border px-2 py-1\">Items</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr\n          v-for=\"opname in stockOpnames\"\n          :key=\"opname.ID\"\n          class=\"hover:bg-gray-100\"\n        >\n          <td class=\"border px-2 py-1\">{{ opname.ID }}</td>\n          <td class=\"border px-2 py-1\">{{ opname.User?.Name || \"-\" }}</td>\n          <td class=\"border px-2 py-1\">{{ formatDate(opname.Date) }}</td>\n          <td class=\"border px-2 py-1\">{{ opname.Note }}</td>\n          <td class=\"border px-2 py-1\">\n            <ul>\n              <li v-for=\"item in opname.Items\" :key=\"item.ID\">\n                {{ item.Product?.Name || \"Unknown\" }}: {{ item.QtySystem }} â†’\n                {{ item.QtyPhysical }}\n              </li>\n            </ul>\n          </td>\n        </tr>\n        <tr v-if=\"stockOpnames.length === 0\">\n          <td class=\"border px-2 py-1 text-center\" colspan=\"5\">No data</td>\n        </tr>\n      </tbody>\n    </table>\n\n    <!-- PAGINATION -->\n    <div class=\"flex justify-between mt-4\">\n      <button\n        @click=\"prevPage\"\n        :disabled=\"page === 1\"\n        class=\"px-3 py-1 border rounded\"\n      >\n        Prev\n      </button>\n      <span>Page {{ page }} of {{ totalPages }}</span>\n      <button\n        @click=\"nextPage\"\n        :disabled=\"page >= totalPages\"\n        class=\"px-3 py-1 border rounded\"\n      >\n        Next\n      </button>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted } from \"vue\";\nimport axios from \"axios\";\n\n// STATE\nconst stockOpnames = ref([]);\nconst page = ref(1);\nconst size = ref(10);\nconst total = ref(0);\nconst filters = ref({ startDate: \"\", endDate: \"\", search: \"\" });\n\n// COMPUTED\nconst totalPages = computed(() => Math.ceil(total.value / size.value));\n\n// FUNCTION: fetch data dari backend\nasync function fetchStockOpnames() {\n  try {\n    const params = {\n      page: page.value,\n      size: size.value,\n      q: filters.value.search,\n      start_date: filters.value.startDate,\n      end_date: filters.value.endDate,\n    };\n    const res = await axios.get(\n      \"http://localhost:8081/api/v1/history/stock-opnames\",\n      { params }\n    );\n    stockOpnames.value = res.data.data;\n    total.value = res.data.total;\n  } catch (err) {\n    console.error(\"Gagal ambil data:\", err);\n    stockOpnames.value = []; // fallback kosong\n  }\n}\n\n// FUNCTION: pagination\nfunction nextPage() {\n  if (page.value < totalPages.value) {\n    page.value++;\n    fetchStockOpnames();\n  }\n}\nfunction prevPage() {\n  if (page.value > 1) {\n    page.value--;\n    fetchStockOpnames();\n  }\n}\n\n// FUNCTION: format tanggal\nfunction formatDate(dt) {\n  if (!dt) return \"-\";\n  const d = new Date(dt);\n  return d.toLocaleDateString();\n}\n\n// FETCH saat mounted\nonMounted(() => {\n  fetchStockOpnames();\n});\n</script>\n\n<style scoped>\ntable th,\ntable td {\n  text-align: left;\n}\n</style>\n"],"mappings":"AAoFA,SAASA,GAAG,EAAEC,QAAQ,EAAEC,SAAS,QAAQ,KAAK;AAC9C,OAAOC,KAAK,MAAM,OAAO;;AAEzB;;;;;;;;IACA,MAAMC,YAAY,GAAGJ,GAAG,CAAC,EAAE,CAAC;IAC5B,MAAMK,IAAI,GAAGL,GAAG,CAAC,CAAC,CAAC;IACnB,MAAMM,IAAI,GAAGN,GAAG,CAAC,EAAE,CAAC;IACpB,MAAMO,KAAK,GAAGP,GAAG,CAAC,CAAC,CAAC;IACpB,MAAMQ,OAAO,GAAGR,GAAG,CAAC;MAAES,SAAS,EAAE,EAAE;MAAEC,OAAO,EAAE,EAAE;MAAEC,MAAM,EAAE;IAAG,CAAC,CAAC;;IAE/D;IACA,MAAMC,UAAU,GAAGX,QAAQ,CAAC,MAAMY,IAAI,CAACC,IAAI,CAACP,KAAK,CAACQ,KAAK,GAAGT,IAAI,CAACS,KAAK,CAAC,CAAC;;IAEtE;IACA,eAAeC,iBAAiBA,CAAA,EAAG;MACjC,IAAI;QACF,MAAMC,MAAM,GAAG;UACbZ,IAAI,EAAEA,IAAI,CAACU,KAAK;UAChBT,IAAI,EAAEA,IAAI,CAACS,KAAK;UAChBG,CAAC,EAAEV,OAAO,CAACO,KAAK,CAACJ,MAAM;UACvBQ,UAAU,EAAEX,OAAO,CAACO,KAAK,CAACN,SAAS;UACnCW,QAAQ,EAAEZ,OAAO,CAACO,KAAK,CAACL;QAC1B,CAAC;QACD,MAAMW,GAAG,GAAG,MAAMlB,KAAK,CAACmB,GAAG,CACzB,oDAAoD,EACpD;UAAEL;QAAO,CACX,CAAC;QACDb,YAAY,CAACW,KAAK,GAAGM,GAAG,CAACE,IAAI,CAACA,IAAI;QAClChB,KAAK,CAACQ,KAAK,GAAGM,GAAG,CAACE,IAAI,CAAChB,KAAK;MAC9B,CAAC,CAAC,OAAOiB,GAAG,EAAE;QACZC,OAAO,CAACC,KAAK,CAAC,mBAAmB,EAAEF,GAAG,CAAC;QACvCpB,YAAY,CAACW,KAAK,GAAG,EAAE,CAAC,CAAC;MAC3B;IACF;;IAEA;IACA,SAASY,QAAQA,CAAA,EAAG;MAClB,IAAItB,IAAI,CAACU,KAAK,GAAGH,UAAU,CAACG,KAAK,EAAE;QACjCV,IAAI,CAACU,KAAK,EAAE;QACZC,iBAAiB,CAAC,CAAC;MACrB;IACF;IACA,SAASY,QAAQA,CAAA,EAAG;MAClB,IAAIvB,IAAI,CAACU,KAAK,GAAG,CAAC,EAAE;QAClBV,IAAI,CAACU,KAAK,EAAE;QACZC,iBAAiB,CAAC,CAAC;MACrB;IACF;;IAEA;IACA,SAASa,UAAUA,CAACC,EAAE,EAAE;MACtB,IAAI,CAACA,EAAE,EAAE,OAAO,GAAG;MACnB,MAAMC,CAAC,GAAG,IAAIC,IAAI,CAACF,EAAE,CAAC;MACtB,OAAOC,CAAC,CAACE,kBAAkB,CAAC,CAAC;IAC/B;;IAEA;IACA/B,SAAS,CAAC,MAAM;MACdc,iBAAiB,CAAC,CAAC;IACrB,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}