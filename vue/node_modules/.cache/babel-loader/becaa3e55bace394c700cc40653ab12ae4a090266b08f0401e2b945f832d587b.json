{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref } from \"vue\";\nimport router from \"@/router\"; // Asumsikan Anda menggunakan Vue Router\nimport apiClient from \"../services/api.js\"; // Import instance Axios yang sudah dibuat\n\n// State untuk formulir\n\nexport default {\n  __name: 'Login',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const email = ref(\"\");\n    const password = ref(\"\");\n\n    // State untuk UI dan Error Handling\n    const isLoading = ref(false);\n    const generalError = ref(\"\");\n    const errors = ref({\n      email: \"\",\n      password: \"\"\n    });\n\n    /**\r\n     * Validasi sisi klien sederhana\r\n     */\n    const validateForm = () => {\n      let isValid = true;\n      errors.value = {\n        email: \"\",\n        password: \"\"\n      };\n      if (!email.value) {\n        errors.value.email = \"Email wajib diisi.\";\n        isValid = false;\n      }\n      // Tidak perlu validasi email yang kompleks di sini, biarkan backend yang mengurus\n\n      if (!password.value) {\n        errors.value.password = \"Password wajib diisi.\";\n        isValid = false;\n      } else if (password.value.length < 6) {\n        errors.value.password = \"Password minimal 6 karakter.\";\n        isValid = false;\n      }\n      return isValid;\n    };\n\n    /**\r\n     * Menangani proses login\r\n     */\n    const handleLogin = async () => {\n      generalError.value = \"\"; // Reset error\n\n      if (!validateForm()) {\n        return;\n      }\n      isLoading.value = true;\n      try {\n        const response = await apiClient.post(\"/auth/login\", {\n          email: email.value,\n          password: password.value\n        });\n\n        // Asumsi: Backend mengembalikan { token: \"...\", name: \"...\", role: \"...\" }\n        const {\n          token,\n          name,\n          role\n        } = response.data;\n\n        // 1. Simpan token di Local Storage atau Vuex/Pinia (disarankan untuk manajemen state)\n        localStorage.setItem(\"userToken\", token);\n\n        // 2. Simpan detail user lainnya\n        localStorage.setItem(\"userName\", name);\n        localStorage.setItem(\"userRole\", role);\n\n        // 3. Konfigurasi Axios untuk menyertakan token di setiap request berikutnya\n        apiClient.defaults.headers.common[\"Authorization\"] = `Bearer ${token}`;\n\n        // 4. Redirect pengguna ke halaman dashboard berdasarkan role\n        if (role === \"OWNER\") {\n          router.push(\"/owner/dashboard\");\n        } else if (role === \"KASIR\") {\n          router.push(\"/kasir/dashboard\");\n        } else {\n          // Role lain atau default\n          router.push(\"/dashboard\");\n        }\n      } catch (error) {\n        // Tangani error dari API\n        if (error.response) {\n          // Error 400 (Bad Request) atau 401 (Unauthorized) dari backend Go Anda\n          // Pesan error dari backend akan ada di error.response.data.message atau serupa\n          const message = error.response.data.message || \"Email atau password salah. Silakan coba lagi.\";\n          generalError.value = message;\n        } else if (error.request) {\n          // Permintaan dikirim tetapi tidak ada respons (mis. server down)\n          generalError.value = \"Tidak dapat terhubung ke server. Silakan cek koneksi Anda.\";\n        } else {\n          // Kesalahan lain\n          generalError.value = \"Terjadi kesalahan tak terduga saat login.\";\n          console.error(error);\n        }\n      } finally {\n        isLoading.value = false;\n      }\n    };\n    const __returned__ = {\n      email,\n      password,\n      isLoading,\n      generalError,\n      errors,\n      validateForm,\n      handleLogin,\n      ref,\n      get router() {\n        return router;\n      },\n      get apiClient() {\n        return apiClient;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","router","apiClient","email","password","isLoading","generalError","errors","validateForm","isValid","value","length","handleLogin","response","post","token","name","role","data","localStorage","setItem","defaults","headers","common","push","error","message","request","console"],"sources":["C:/Users/Personal/Documents/PKL/aplikasi/aplikasi/src/views/Login.vue"],"sourcesContent":["<template>\r\n  <div class=\"login-container\">\r\n    <form @submit.prevent=\"handleLogin\" class=\"login-form\">\r\n      <h2>Sistem Penjualan - Login</h2>\r\n\r\n      <div class=\"form-group\">\r\n        <label for=\"email\">Email</label>\r\n        <input\r\n          type=\"email\"\r\n          id=\"email\"\r\n          v-model=\"email\"\r\n          required\r\n          :disabled=\"isLoading\"\r\n        />\r\n        <p v-if=\"errors.email\" class=\"error-message\">{{ errors.email }}</p>\r\n      </div>\r\n\r\n      <div class=\"form-group\">\r\n        <label for=\"password\">Password</label>\r\n        <input\r\n          type=\"password\"\r\n          id=\"password\"\r\n          v-model=\"password\"\r\n          required\r\n          minlength=\"6\"\r\n          :disabled=\"isLoading\"\r\n        />\r\n        <p v-if=\"errors.password\" class=\"error-message\">\r\n          {{ errors.password }}\r\n        </p>\r\n      </div>\r\n\r\n      <p v-if=\"generalError\" class=\"error-message general-error\">\r\n        {{ generalError }}\r\n      </p>\r\n\r\n      <button type=\"submit\" :disabled=\"isLoading\">\r\n        <span v-if=\"isLoading\">Loading...</span>\r\n        <span v-else>Login</span>\r\n      </button>\r\n    </form>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from \"vue\";\r\nimport router from \"@/router\"; // Asumsikan Anda menggunakan Vue Router\r\nimport apiClient from \"../services/api.js\"; // Import instance Axios yang sudah dibuat\r\n\r\n// State untuk formulir\r\nconst email = ref(\"\");\r\nconst password = ref(\"\");\r\n\r\n// State untuk UI dan Error Handling\r\nconst isLoading = ref(false);\r\nconst generalError = ref(\"\");\r\nconst errors = ref({\r\n  email: \"\",\r\n  password: \"\",\r\n});\r\n\r\n/**\r\n * Validasi sisi klien sederhana\r\n */\r\nconst validateForm = () => {\r\n  let isValid = true;\r\n  errors.value = { email: \"\", password: \"\" };\r\n\r\n  if (!email.value) {\r\n    errors.value.email = \"Email wajib diisi.\";\r\n    isValid = false;\r\n  }\r\n  // Tidak perlu validasi email yang kompleks di sini, biarkan backend yang mengurus\r\n\r\n  if (!password.value) {\r\n    errors.value.password = \"Password wajib diisi.\";\r\n    isValid = false;\r\n  } else if (password.value.length < 6) {\r\n    errors.value.password = \"Password minimal 6 karakter.\";\r\n    isValid = false;\r\n  }\r\n\r\n  return isValid;\r\n};\r\n\r\n/**\r\n * Menangani proses login\r\n */\r\nconst handleLogin = async () => {\r\n  generalError.value = \"\"; // Reset error\r\n\r\n  if (!validateForm()) {\r\n    return;\r\n  }\r\n\r\n  isLoading.value = true;\r\n\r\n  try {\r\n    const response = await apiClient.post(\"/auth/login\", {\r\n      email: email.value,\r\n      password: password.value,\r\n    });\r\n\r\n    // Asumsi: Backend mengembalikan { token: \"...\", name: \"...\", role: \"...\" }\r\n    const { token, name, role } = response.data;\r\n\r\n    // 1. Simpan token di Local Storage atau Vuex/Pinia (disarankan untuk manajemen state)\r\n    localStorage.setItem(\"userToken\", token);\r\n\r\n    // 2. Simpan detail user lainnya\r\n    localStorage.setItem(\"userName\", name);\r\n    localStorage.setItem(\"userRole\", role);\r\n\r\n    // 3. Konfigurasi Axios untuk menyertakan token di setiap request berikutnya\r\n    apiClient.defaults.headers.common[\"Authorization\"] = `Bearer ${token}`;\r\n\r\n    // 4. Redirect pengguna ke halaman dashboard berdasarkan role\r\n    if (role === \"OWNER\") {\r\n      router.push(\"/owner/dashboard\");\r\n    } else if (role === \"KASIR\") {\r\n      router.push(\"/kasir/dashboard\");\r\n    } else {\r\n      // Role lain atau default\r\n      router.push(\"/dashboard\");\r\n    }\r\n  } catch (error) {\r\n    // Tangani error dari API\r\n    if (error.response) {\r\n      // Error 400 (Bad Request) atau 401 (Unauthorized) dari backend Go Anda\r\n      // Pesan error dari backend akan ada di error.response.data.message atau serupa\r\n      const message =\r\n        error.response.data.message ||\r\n        \"Email atau password salah. Silakan coba lagi.\";\r\n      generalError.value = message;\r\n    } else if (error.request) {\r\n      // Permintaan dikirim tetapi tidak ada respons (mis. server down)\r\n      generalError.value =\r\n        \"Tidak dapat terhubung ke server. Silakan cek koneksi Anda.\";\r\n    } else {\r\n      // Kesalahan lain\r\n      generalError.value = \"Terjadi kesalahan tak terduga saat login.\";\r\n      console.error(error);\r\n    }\r\n  } finally {\r\n    isLoading.value = false;\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.login-container {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  min-height: 100vh;\r\n  background-color: #f4f7f6;\r\n}\r\n\r\n.login-form {\r\n  background: white;\r\n  padding: 40px;\r\n  border-radius: 8px;\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\r\n  width: 100%;\r\n  max-width: 400px;\r\n}\r\n\r\nh2 {\r\n  text-align: center;\r\n  margin-bottom: 30px;\r\n  color: #333;\r\n}\r\n\r\n.form-group {\r\n  margin-bottom: 20px;\r\n}\r\n\r\nlabel {\r\n  display: block;\r\n  margin-bottom: 5px;\r\n  font-weight: bold;\r\n  color: #555;\r\n}\r\n\r\ninput {\r\n  width: 100%;\r\n  padding: 10px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 4px;\r\n  box-sizing: border-box;\r\n}\r\n\r\ninput:focus {\r\n  border-color: #007bff;\r\n  outline: none;\r\n  box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);\r\n}\r\n\r\nbutton {\r\n  width: 100%;\r\n  padding: 12px;\r\n  background-color: #007bff;\r\n  color: white;\r\n  border: none;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  font-size: 16px;\r\n  transition: background-color 0.3s;\r\n}\r\n\r\nbutton:hover:not(:disabled) {\r\n  background-color: #0056b3;\r\n}\r\n\r\nbutton:disabled {\r\n  background-color: #a0c3e1;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.error-message {\r\n  color: #dc3545;\r\n  font-size: 0.875em;\r\n  margin-top: 5px;\r\n}\r\n\r\n.general-error {\r\n  text-align: center;\r\n  font-weight: bold;\r\n  margin-bottom: 15px;\r\n  padding: 10px;\r\n  border: 1px solid #f5c6cb;\r\n  background-color: #f8d7da;\r\n  border-radius: 4px;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}